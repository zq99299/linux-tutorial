<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linux 的开机流程分析 | Linux 系统教程（笔记）</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/linux-tutorial/favicon.ico">
    <link rel="manifest" href="/linux-tutorial/manifest.json">
    <meta name="description" content="linux 系统教程学习笔记">
    <link rel="preload" href="/linux-tutorial/assets/css/0.styles.7e75da3d.css" as="style"><link rel="preload" href="/linux-tutorial/assets/js/app.edeac043.js" as="script"><link rel="preload" href="/linux-tutorial/assets/js/2.b00e63ff.js" as="script"><link rel="preload" href="/linux-tutorial/assets/js/15.9161726f.js" as="script"><link rel="preload" href="/linux-tutorial/assets/js/16.b0a90d5f.js" as="script"><link rel="prefetch" href="/linux-tutorial/assets/js/10.0e6d3e5f.js"><link rel="prefetch" href="/linux-tutorial/assets/js/100.63519d65.js"><link rel="prefetch" href="/linux-tutorial/assets/js/101.99d7c284.js"><link rel="prefetch" href="/linux-tutorial/assets/js/102.c6733bca.js"><link rel="prefetch" href="/linux-tutorial/assets/js/103.918a4dba.js"><link rel="prefetch" href="/linux-tutorial/assets/js/104.529d4089.js"><link rel="prefetch" href="/linux-tutorial/assets/js/105.454d6310.js"><link rel="prefetch" href="/linux-tutorial/assets/js/106.3b8b7ac7.js"><link rel="prefetch" href="/linux-tutorial/assets/js/107.1dd2a942.js"><link rel="prefetch" href="/linux-tutorial/assets/js/108.74b8395c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/109.d522ea0d.js"><link rel="prefetch" href="/linux-tutorial/assets/js/11.b836800c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/110.2e3f1a87.js"><link rel="prefetch" href="/linux-tutorial/assets/js/111.fd8a0020.js"><link rel="prefetch" href="/linux-tutorial/assets/js/112.e2f4913c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/113.8de94cf4.js"><link rel="prefetch" href="/linux-tutorial/assets/js/114.2f9a6bc8.js"><link rel="prefetch" href="/linux-tutorial/assets/js/115.26cb32f2.js"><link rel="prefetch" href="/linux-tutorial/assets/js/116.c7a39b2c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/117.717379f2.js"><link rel="prefetch" href="/linux-tutorial/assets/js/118.cb6cc016.js"><link rel="prefetch" href="/linux-tutorial/assets/js/119.9512ae4e.js"><link rel="prefetch" href="/linux-tutorial/assets/js/12.9b34de96.js"><link rel="prefetch" href="/linux-tutorial/assets/js/120.23d99fc1.js"><link rel="prefetch" href="/linux-tutorial/assets/js/121.166bd675.js"><link rel="prefetch" href="/linux-tutorial/assets/js/122.4846826d.js"><link rel="prefetch" href="/linux-tutorial/assets/js/123.8a41da36.js"><link rel="prefetch" href="/linux-tutorial/assets/js/124.35e2afbb.js"><link rel="prefetch" href="/linux-tutorial/assets/js/125.5c0c3620.js"><link rel="prefetch" href="/linux-tutorial/assets/js/126.9400b1e3.js"><link rel="prefetch" href="/linux-tutorial/assets/js/127.4cf27b30.js"><link rel="prefetch" href="/linux-tutorial/assets/js/128.fff84bbc.js"><link rel="prefetch" href="/linux-tutorial/assets/js/129.17deb712.js"><link rel="prefetch" href="/linux-tutorial/assets/js/13.f4e56993.js"><link rel="prefetch" href="/linux-tutorial/assets/js/130.e10e4456.js"><link rel="prefetch" href="/linux-tutorial/assets/js/131.06f73086.js"><link rel="prefetch" href="/linux-tutorial/assets/js/132.f4d6a75c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/133.edffc570.js"><link rel="prefetch" href="/linux-tutorial/assets/js/134.7a870eed.js"><link rel="prefetch" href="/linux-tutorial/assets/js/135.f64a41b5.js"><link rel="prefetch" href="/linux-tutorial/assets/js/136.29678524.js"><link rel="prefetch" href="/linux-tutorial/assets/js/137.78f53e43.js"><link rel="prefetch" href="/linux-tutorial/assets/js/138.33e10199.js"><link rel="prefetch" href="/linux-tutorial/assets/js/139.ef27b6f1.js"><link rel="prefetch" href="/linux-tutorial/assets/js/14.4342bdf7.js"><link rel="prefetch" href="/linux-tutorial/assets/js/140.862a81a9.js"><link rel="prefetch" href="/linux-tutorial/assets/js/141.1a7fe5a4.js"><link rel="prefetch" href="/linux-tutorial/assets/js/142.60b9fbeb.js"><link rel="prefetch" href="/linux-tutorial/assets/js/143.9c9d9ee6.js"><link rel="prefetch" href="/linux-tutorial/assets/js/144.3566229e.js"><link rel="prefetch" href="/linux-tutorial/assets/js/145.c05907d3.js"><link rel="prefetch" href="/linux-tutorial/assets/js/146.7ec44c8a.js"><link rel="prefetch" href="/linux-tutorial/assets/js/147.6cf25c98.js"><link rel="prefetch" href="/linux-tutorial/assets/js/148.1041f769.js"><link rel="prefetch" href="/linux-tutorial/assets/js/149.a1a9fc37.js"><link rel="prefetch" href="/linux-tutorial/assets/js/150.e5c75119.js"><link rel="prefetch" href="/linux-tutorial/assets/js/151.b1b2591d.js"><link rel="prefetch" href="/linux-tutorial/assets/js/152.4c10c599.js"><link rel="prefetch" href="/linux-tutorial/assets/js/153.45245fb4.js"><link rel="prefetch" href="/linux-tutorial/assets/js/154.cf7c1c8b.js"><link rel="prefetch" href="/linux-tutorial/assets/js/155.562427b5.js"><link rel="prefetch" href="/linux-tutorial/assets/js/156.94589751.js"><link rel="prefetch" href="/linux-tutorial/assets/js/157.8d1f9503.js"><link rel="prefetch" href="/linux-tutorial/assets/js/158.d797bc39.js"><link rel="prefetch" href="/linux-tutorial/assets/js/159.677815f8.js"><link rel="prefetch" href="/linux-tutorial/assets/js/160.fe566e83.js"><link rel="prefetch" href="/linux-tutorial/assets/js/161.3cb9382a.js"><link rel="prefetch" href="/linux-tutorial/assets/js/162.7a754448.js"><link rel="prefetch" href="/linux-tutorial/assets/js/163.d55c6349.js"><link rel="prefetch" href="/linux-tutorial/assets/js/164.9ee339c2.js"><link rel="prefetch" href="/linux-tutorial/assets/js/165.30141050.js"><link rel="prefetch" href="/linux-tutorial/assets/js/166.7b877f0d.js"><link rel="prefetch" href="/linux-tutorial/assets/js/167.86392c2c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/168.2cae5c9c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/169.1e24d7be.js"><link rel="prefetch" href="/linux-tutorial/assets/js/17.04ccb392.js"><link rel="prefetch" href="/linux-tutorial/assets/js/170.d02b5a88.js"><link rel="prefetch" href="/linux-tutorial/assets/js/171.cf33f986.js"><link rel="prefetch" href="/linux-tutorial/assets/js/172.9e9a5927.js"><link rel="prefetch" href="/linux-tutorial/assets/js/173.65edcd81.js"><link rel="prefetch" href="/linux-tutorial/assets/js/174.90f45e3a.js"><link rel="prefetch" href="/linux-tutorial/assets/js/175.8256c1a7.js"><link rel="prefetch" href="/linux-tutorial/assets/js/176.b64d6d09.js"><link rel="prefetch" href="/linux-tutorial/assets/js/177.dcf9ae18.js"><link rel="prefetch" href="/linux-tutorial/assets/js/178.ae42ddc1.js"><link rel="prefetch" href="/linux-tutorial/assets/js/18.5d2dca25.js"><link rel="prefetch" href="/linux-tutorial/assets/js/19.171418f5.js"><link rel="prefetch" href="/linux-tutorial/assets/js/20.4c69b8ff.js"><link rel="prefetch" href="/linux-tutorial/assets/js/21.2465fa9d.js"><link rel="prefetch" href="/linux-tutorial/assets/js/22.ceb7095d.js"><link rel="prefetch" href="/linux-tutorial/assets/js/23.578aedc7.js"><link rel="prefetch" href="/linux-tutorial/assets/js/24.d9453f92.js"><link rel="prefetch" href="/linux-tutorial/assets/js/25.cade1e03.js"><link rel="prefetch" href="/linux-tutorial/assets/js/26.d4c42c11.js"><link rel="prefetch" href="/linux-tutorial/assets/js/27.e67320de.js"><link rel="prefetch" href="/linux-tutorial/assets/js/28.5d42931b.js"><link rel="prefetch" href="/linux-tutorial/assets/js/29.78c32762.js"><link rel="prefetch" href="/linux-tutorial/assets/js/3.63859d7c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/30.4495d9ce.js"><link rel="prefetch" href="/linux-tutorial/assets/js/31.95d35ed3.js"><link rel="prefetch" href="/linux-tutorial/assets/js/32.ca390432.js"><link rel="prefetch" href="/linux-tutorial/assets/js/33.13ca63e2.js"><link rel="prefetch" href="/linux-tutorial/assets/js/34.93972f88.js"><link rel="prefetch" href="/linux-tutorial/assets/js/35.3241aaed.js"><link rel="prefetch" href="/linux-tutorial/assets/js/36.209d75c8.js"><link rel="prefetch" href="/linux-tutorial/assets/js/37.25ecb5cb.js"><link rel="prefetch" href="/linux-tutorial/assets/js/38.bb269f94.js"><link rel="prefetch" href="/linux-tutorial/assets/js/39.7d6ee8db.js"><link rel="prefetch" href="/linux-tutorial/assets/js/4.fcbb0758.js"><link rel="prefetch" href="/linux-tutorial/assets/js/40.7925dcab.js"><link rel="prefetch" href="/linux-tutorial/assets/js/41.f59dae07.js"><link rel="prefetch" href="/linux-tutorial/assets/js/42.a20a814d.js"><link rel="prefetch" href="/linux-tutorial/assets/js/43.7c5cc457.js"><link rel="prefetch" href="/linux-tutorial/assets/js/44.0476bb9a.js"><link rel="prefetch" href="/linux-tutorial/assets/js/45.ec36d4fc.js"><link rel="prefetch" href="/linux-tutorial/assets/js/46.64d43700.js"><link rel="prefetch" href="/linux-tutorial/assets/js/47.06eae631.js"><link rel="prefetch" href="/linux-tutorial/assets/js/48.a36fbedb.js"><link rel="prefetch" href="/linux-tutorial/assets/js/49.1799d727.js"><link rel="prefetch" href="/linux-tutorial/assets/js/5.b715e31e.js"><link rel="prefetch" href="/linux-tutorial/assets/js/50.f12984d3.js"><link rel="prefetch" href="/linux-tutorial/assets/js/51.ce9040c5.js"><link rel="prefetch" href="/linux-tutorial/assets/js/52.99c18f1f.js"><link rel="prefetch" href="/linux-tutorial/assets/js/53.cc4d7b3d.js"><link rel="prefetch" href="/linux-tutorial/assets/js/54.e76ffc06.js"><link rel="prefetch" href="/linux-tutorial/assets/js/55.653237e5.js"><link rel="prefetch" href="/linux-tutorial/assets/js/56.44de98c2.js"><link rel="prefetch" href="/linux-tutorial/assets/js/57.a949f342.js"><link rel="prefetch" href="/linux-tutorial/assets/js/58.64f3994d.js"><link rel="prefetch" href="/linux-tutorial/assets/js/59.e131197c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/6.a9f87cb4.js"><link rel="prefetch" href="/linux-tutorial/assets/js/60.1232bd8b.js"><link rel="prefetch" href="/linux-tutorial/assets/js/61.aea85f2f.js"><link rel="prefetch" href="/linux-tutorial/assets/js/62.558fb7bb.js"><link rel="prefetch" href="/linux-tutorial/assets/js/63.86c2c4b7.js"><link rel="prefetch" href="/linux-tutorial/assets/js/64.d1204ad8.js"><link rel="prefetch" href="/linux-tutorial/assets/js/65.7d5f7b77.js"><link rel="prefetch" href="/linux-tutorial/assets/js/66.285ecfa2.js"><link rel="prefetch" href="/linux-tutorial/assets/js/67.be660d10.js"><link rel="prefetch" href="/linux-tutorial/assets/js/68.fbb1e7f4.js"><link rel="prefetch" href="/linux-tutorial/assets/js/69.e4406228.js"><link rel="prefetch" href="/linux-tutorial/assets/js/7.091e5e1d.js"><link rel="prefetch" href="/linux-tutorial/assets/js/70.1e57e6be.js"><link rel="prefetch" href="/linux-tutorial/assets/js/71.9e694c22.js"><link rel="prefetch" href="/linux-tutorial/assets/js/72.88556804.js"><link rel="prefetch" href="/linux-tutorial/assets/js/73.059936b7.js"><link rel="prefetch" href="/linux-tutorial/assets/js/74.afe01b54.js"><link rel="prefetch" href="/linux-tutorial/assets/js/75.43cb35df.js"><link rel="prefetch" href="/linux-tutorial/assets/js/76.c491ce07.js"><link rel="prefetch" href="/linux-tutorial/assets/js/77.13799166.js"><link rel="prefetch" href="/linux-tutorial/assets/js/78.5cc7a401.js"><link rel="prefetch" href="/linux-tutorial/assets/js/79.ffc2cb73.js"><link rel="prefetch" href="/linux-tutorial/assets/js/8.d908ccdf.js"><link rel="prefetch" href="/linux-tutorial/assets/js/80.8be0e40c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/81.1e0cf9b0.js"><link rel="prefetch" href="/linux-tutorial/assets/js/82.1cb485e6.js"><link rel="prefetch" href="/linux-tutorial/assets/js/83.445d01a2.js"><link rel="prefetch" href="/linux-tutorial/assets/js/84.41a9c9da.js"><link rel="prefetch" href="/linux-tutorial/assets/js/85.01bf6f53.js"><link rel="prefetch" href="/linux-tutorial/assets/js/86.94c14908.js"><link rel="prefetch" href="/linux-tutorial/assets/js/87.51a87e44.js"><link rel="prefetch" href="/linux-tutorial/assets/js/88.c922b177.js"><link rel="prefetch" href="/linux-tutorial/assets/js/89.649fcbb6.js"><link rel="prefetch" href="/linux-tutorial/assets/js/9.fe184c91.js"><link rel="prefetch" href="/linux-tutorial/assets/js/90.1c188fc9.js"><link rel="prefetch" href="/linux-tutorial/assets/js/91.99424142.js"><link rel="prefetch" href="/linux-tutorial/assets/js/92.a84b4a68.js"><link rel="prefetch" href="/linux-tutorial/assets/js/93.c22cfc24.js"><link rel="prefetch" href="/linux-tutorial/assets/js/94.cc81a8b3.js"><link rel="prefetch" href="/linux-tutorial/assets/js/95.7cc098d7.js"><link rel="prefetch" href="/linux-tutorial/assets/js/96.5cc3cc47.js"><link rel="prefetch" href="/linux-tutorial/assets/js/97.1d483421.js"><link rel="prefetch" href="/linux-tutorial/assets/js/98.87d8de27.js"><link rel="prefetch" href="/linux-tutorial/assets/js/99.47e7a1f5.js">
    <link rel="stylesheet" href="/linux-tutorial/assets/css/0.styles.7e75da3d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/linux-tutorial/" class="home-link router-link-active"><img src="/linux-tutorial/mlogo.svg" alt="Linux 系统教程（笔记）" class="logo"> <span class="site-name can-hide">Linux 系统教程（笔记）</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/linux-tutorial/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/linux-tutorial/tutorial-basis/" class="nav-link router-link-active">
  鸟哥私房菜-基础篇
</a></div><div class="nav-item"><a href="/linux-tutorial/discuss.html" class="nav-link">
  参与讨论
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记精选汇总" class="dropdown-title"><span class="title">笔记精选汇总</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/zq99299/repository-summary" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub 站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://book.mrcode.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  国内镜像站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/zq99299/linux-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/linux-tutorial/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/linux-tutorial/tutorial-basis/" class="nav-link router-link-active">
  鸟哥私房菜-基础篇
</a></div><div class="nav-item"><a href="/linux-tutorial/discuss.html" class="nav-link">
  参与讨论
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记精选汇总" class="dropdown-title"><span class="title">笔记精选汇总</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/zq99299/repository-summary" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub 站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://book.mrcode.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  国内镜像站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/zq99299/linux-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/linux-tutorial/tutorial-basis/" class="sidebar-link">Linux 基础篇（鸟哥私房菜）- 第四版</a></li><li><a href="/linux-tutorial/tutorial-basis/00/" class="sidebar-link">00. 计算机概论</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>01. Linux 是什么/如何学习</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>02. 主机规划与磁盘分区</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>03. 安装 CentOS 7.x</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>04. 首次登陆与线上求助</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>05. Linux 的文件权限与目录配置</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>06. Linux 文件与目录管理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>07. Linux 磁盘与文件系统管理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>08. 文件与文件系统的压缩、打包与备份</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>09. vim 程序编辑器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>10. 认识与学习 BASH</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>11. 正则表达式与文件格式化处理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>12. 学习 Shell Scripts</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>13. Linux 账号管理与 ACL 权限设置</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>14. 磁盘配额（Quota）与进阶文件系统管理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>15. 例行性工作排程（crontab）</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>16. 进程管理与 SELinux 初探</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>17. 认识系统服务（daemons）</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>18. 认识与分析登录文件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>19. 开机流程、模块管理与 Loader</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/linux-tutorial/tutorial-basis/19/" class="sidebar-link">开机流程、模块管理与 Loader</a></li><li><a href="/linux-tutorial/tutorial-basis/19/01.html" class="active sidebar-link">Linux 的开机流程分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#开机流程一览" class="sidebar-link">开机流程一览</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#bios、boot-loader-与-kernel-载入" class="sidebar-link">BIOS、boot loader 与 kernel 载入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#bios-开机自我测试与-mbr-gpt" class="sidebar-link">BIOS 开机自我测试与 MBR/GPT</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#boot-loader-功能" class="sidebar-link">Boot Loader 功能</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#加载核心检查硬件与-initramfs-功能" class="sidebar-link">加载核心检查硬件与 initramfs 功能</a></li></ul></li><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#第一个程序-systemd-及使用-defaul-target-进入开机程序分析" class="sidebar-link">第一个程序 systemd 及使用 defaul.target 进入开机程序分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#systemd-的处理流程" class="sidebar-link">systemd 的处理流程</a></li></ul></li><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#systemd-执行-sysinit-target-初始化系统、bashic-target-准备系统" class="sidebar-link">systemd 执行 sysinit.target 初始化系统、bashic.target 准备系统</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#systemd-启动-multi-user-target-下的服务" class="sidebar-link">systemd 启动 multi-user.target 下的服务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#相容-systemv-的-rc-local-service" class="sidebar-link">相容 systemV 的 rc-local.service</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#提供-tty-界面与登录的服务" class="sidebar-link">提供 tty 界面与登录的服务</a></li></ul></li><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#systemd-启动-graphical-target-下的服务" class="sidebar-link">systemd 启动 graphical.target 下的服务</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#开机过程会用到的主要配置文件" class="sidebar-link">开机过程会用到的主要配置文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux-tutorial/tutorial-basis/19/01.html#关于模块-etc-modprobe-d-conf-与-etc-modules-load-d-conf" class="sidebar-link">关于模块 /etc/modprobe.d/*.conf 与 /etc/modules-load.d/*.conf</a></li></ul></li></ul></li><li><a href="/linux-tutorial/tutorial-basis/19/02.html" class="sidebar-link">核心与核心模块</a></li><li><a href="/linux-tutorial/tutorial-basis/19/03.html" class="sidebar-link">Boot Loader：Grub2</a></li><li><a href="/linux-tutorial/tutorial-basis/19/04.html" class="sidebar-link">开机过程的问题解决</a></li><li><a href="/linux-tutorial/tutorial-basis/19/05.html" class="sidebar-link">重点回顾</a></li><li><a href="/linux-tutorial/tutorial-basis/19/06.html" class="sidebar-link">本章练习</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>20. 基础系统设置与备份策略</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>21. 软件安装：原始码与 Tarball</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>22. 软件安装 RPM、SRPM、YUM</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="linux-的开机流程分析"><a href="#linux-的开机流程分析" class="header-anchor">#</a> Linux 的开机流程分析</h1> <p>为什么要了解开机流程？下面又几个常见的场景：</p> <ul><li>如果想多重引导，怎么安全系统？</li> <li>如果你的 root 密码忘记了，如何救援？</li> <li>如果你的默认登录模式为图形界面，如果在开机时直接指定进入纯文本模式？</li> <li>如果因为 <code>/etc/fstab</code> 设置错误，导致无法顺利挂载根目录，如何修复 <code>/etc/fstab</code> 文件？</li></ul> <p>笔者当时其实就因为 fstab 文件配置错误，导致开机进入不了系统的问题，当时通过第 3 章中的知识点，还好救援回来了。可见是真的很重要</p> <h2 id="开机流程一览"><a href="#开机流程一览" class="header-anchor">#</a> 开机流程一览</h2> <p>开机管理程序（Boot Loader），由于各大 Linux distribution 的主流为 grub2，下面就以它为主讲解</p> <p>简单来说，系统开机的经过可以总结如下的流程：</p> <ol><li><p>加载 BISO 的硬件信息与进行自我测试，并根据设置获得第一个可开机的设备</p></li> <li><p>读取并执行第一个开机设备内 MBR 的 boot Loader（grub2、spfdisk 等程序）</p></li> <li><p>根据 boot loader 的设置加载 Kernel，Kernel 会开始检测硬件与加载驱动程序</p></li> <li><p>在硬件驱动成功后，Kernel 会调用 systemd 程序，并以 default.target 的流程开机：</p> <ul><li><p>systemd 执行 sysinit.target 初始系统以及 bashic.target 准备操作系统</p></li> <li><p>systemd 启动 multi-user.target 下的本机与服务器服务</p></li> <li><p>systemd 执行 multi-user.target 下的<code>/etc/rc.d/rc.local</code> 文件</p></li> <li><p>systemd 执行 multi-user.target 下的 <code>getty.target</code> 及登录服务</p></li> <li><p>systemd 执行 graphical 需要的服务</p></li></ul></li></ol> <p>大概流程如上，会发现 systemd 程序占比非常重，下面来谈谈各个程序的主要内容是什么</p> <h2 id="bios、boot-loader-与-kernel-载入"><a href="#bios、boot-loader-与-kernel-载入" class="header-anchor">#</a> BIOS、boot loader 与 kernel 载入</h2> <p>在第 2 章中简单的讲解过开机流程与 MBR 的功能，以及大容量磁盘需要使用 GPT 分区格式等。这里只把后续会用到的部分专有名词综合解释：</p> <ul><li>BIOS：无论传统 BIOS 还是 UEFI BIOS 统称 BIOS</li> <li>MBR：分区表有传统 MBR 和新式 GPT，GPT 也保留一块兼容 MBR 的区块，因此后续的说明在安装 boot loader 的部分，都简称 MBR，总之， MBR 就代表该磁盘最前面可安装 boot loader 的哪个区块</li></ul> <h3 id="bios-开机自我测试与-mbr-gpt"><a href="#bios-开机自我测试与-mbr-gpt" class="header-anchor">#</a> BIOS 开机自我测试与 MBR/GPT</h3> <p>BIOS：在第 0 章的计算机概论中谈过，在个人计算机架构下，要启动整部系统，需要让系统去加载 BIOS （Basic Output System），并通过 BIOS 程序与加载 CMOS 的信息，获取 CMOS 内的设置取得主机的各项硬件配置，例如 CPU 与接口设备的沟通频率、开机设备的搜索顺序、硬盘的大小、系统时间、各周边总线是否启动 Plug and Play （PnP 即插即用设备）等信息</p> <p>开机自我测试：BIOS 取得上述信息后，会进行开机自我测试（Power-on Self Test，简称 POST）。然后执行硬件检测初始化，并设置 PnP 装置，之后再定义出可开机的设备顺序，接下来会开始进行开机设备的数据读取</p> <p>MBR：系统软件大多放置在硬盘中，所以 BIOS 会指定开机的设备让我们可以读取磁盘中的操作系统核心文件，但是由于不同的操作系统的文件系统格式不同，因此需要一个开机管理程序来处理核心文件加载 （load）的问题，因此整个 **开机管理程序被称为 Boot Loader **，Boot Loader 程序安装在开机设备的第一个扇区（sector）内，整个扇区也称为 <strong>MBR（Master Boot Record）</strong> 主要启动记录区</p> <p>每个操作系统的 loader 都可能不同，BIOS 通过硬件的 INT 13 中断功能来读取 MBR 的，也就是说，只要 BIOS 能够检测到你的硬盘（不论该磁盘是 SATA 还是 SAS 接口），它就有办法通过 INT 13 这个信道来读取该磁盘的第一个扇区内的 MBR 软件</p> <p>注意：如果系统中有两块硬盘，那么查找的是第一启动设备中的 MBR</p> <h3 id="boot-loader-功能"><a href="#boot-loader-功能" class="header-anchor">#</a> Boot Loader 功能</h3> <p>Loader 最主要的功能是认识操作系统的文件格式并根据加载核心到主存储器去执行。由于不同操作系统的文件格式不一致，因此每种操作系统都有自己的 boot loader。</p> <p>那么多重操作系统：就是在不一部追上安装多中不同的操作系统</p> <ol><li>必须要使用自己的 loader 才能够加载属于自己的操作系统核心</li> <li>但是系统的 MBR 只有一个，那么怎么能让同一台主机上安装 windows 与 Linux 呢？</li></ol> <p>这个问题在第 7 章的磁盘文件系统中有介绍到过。每个文件系统（filesystem 或 partition）都会保留一块启动扇区（boot sector）提供操作系统安装 boot loader，通常操作系统默认会安装一份 loader 到它根目录所在的文件系统的 boot sector 上。</p> <p>如果在一台主机上安装 Windows 与 Linux 后，boot sector、boot loader 与 MBR 的相关系如下图所示</p> <p><img src="/linux-tutorial/assets/img/image-20200323222234528.5a627009.png" alt="image-20200323222234528"></p> <p>如上图所示，每个操作系统默认会安装一套 boot loader 到他自己的文件系统中（左下角的蓝色区域）：</p> <ul><li>Linux 系统：安装时，你可以选择 boot loader 安装到 MBR 上，也可以选择不安装。如果选择安装到 MBR 的话，理论上你再 MBR 与 boot sector 都会有一份 boot loader 程序。</li> <li>Windows：安装时，它默认主动的将 MBR  与 boot sector 都装上一份 boot loader</li></ul> <p>所以会发现安装多重操作系统时，你的 MBR 常常会被不同的操作系统的 boot loader 所覆盖。</p> <p>那么怎么解决多重操作系统的问题呢？在第 2 章中提到过，boot loader 的功能</p> <ul><li>提供选单：用户可以选择不同的开机项目，这也是多重引导的重要功能</li> <li>载入核心文件：直接执行可开机的程序区段来开始操作系统</li> <li>转交其他 loader：将开机管理功能转交给其他 loader 负责</li></ul> <p>由于具有选单功能，可以选择不同的核心来开机。由于具有控制权限转交功能，因此可以加载其他 boot sector 内的 loader。但是 Windows 的 loader 预设不具有控制转交的功能，因此你不能使用 Windows 的 loader 来加载 Linux 的 loader。这也是为什么会强调 <strong>先装 windows，再装 Linux</strong> 的缘故。</p> <p>上述三个功能图下图所示：</p> <p><img src="/linux-tutorial/assets/img/image-20200323223119255.d1428b3a.png" alt="image-20200323223119255"></p> <p>上图，MBR 使用 Linux 的 grub2 开机管理程序，并且设置了 3 个选单：</p> <ul><li>选单 1：MBR（grub2） -&gt; kernel file -&gt; booting</li> <li>选单 2：MBR（grub2） -&gt; boot sector（Windows loader） -&gt; Windows kernel -&gt; booting</li> <li>选单 3：MBR（grub2） -&gt; boot sector（grub2）-&gt; kernel file -&gt; booting</li></ul> <h3 id="加载核心检查硬件与-initramfs-功能"><a href="#加载核心检查硬件与-initramfs-功能" class="header-anchor">#</a> 加载核心检查硬件与 initramfs 功能</h3> <p>通过 boot loader 的管理而开始读取核心文件后，加下来，Linux 会将核心解压到主存储器中，并利用核心的功能，开始测试与驱动各个周边设备，包括存储设备、CPU、网卡、声卡等。</p> <p>**此时 Linux 核心会以自己的功能重新检查一次硬件，而不一定会使用 BIOS 检测到的硬件信息，也就是说，核心此时才开始接管 BIOS 后的工作 **。一般来说，核心文件会放到 <code>/boot</code> 中，并取名为 <code>/boot/vmlinuz</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># ls --format=single-column -F /boot</span>
config-3.10.0-1062.el7.x86_64																<span class="token comment"># 此版本核心被编译时选择的功能与模块配置文件</span>
efi/																												<span class="token comment"># 书上没有这个</span>
grub/																												<span class="token comment"># 旧版 grub1，不用管</span>
grub2/																											<span class="token comment"># 开机管理程序 grub2 的目录</span>
initramfs-0-rescue-f228ab37c368416c84c6b27971ba45a9.img			<span class="token comment"># 虚拟文件系统，用来救援的</span>
initramfs-3.10.0-1062.el7.x86_64.img												<span class="token comment"># 正常开机会用到的虚拟文件系统</span>
initramfs-3.10.0-1062.el7.x86_64kdump.img										<span class="token comment"># 核心出问题时会用到的虚拟文件系统；笔者这里没有看到这个文件</span>
System.map-3.10.0-1062.el7.x86_64														<span class="token comment"># 核心功能放到内存地址的对应表</span>
symvers-3.10.0-1062.el7.x86_64.gz														<span class="token comment"># 书上没有这个</span>
vmlinuz-0-rescue-f228ab37c368416c84c6b27971ba45a9*					<span class="token comment"># 救援用的核心文件</span>
vmlinuz-3.10.0-1062.el7.x86_64*															<span class="token comment"># 核心文件，最重要的</span>
testing.img																									<span class="token comment"># 书上没有这个</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>上面可知道 CentOS 7.x 的 Linux 核心为 3.10.0-1062.el7.x86_64 版本。为了硬件开发商与其他核心功能开发者的便利，因此 Linux 核心是可以通过动态加载核心模块的（可想象成驱动程序），这些核心模块放在 <code>/lib/modules/</code> 目录内。</p> <p><strong>由于模块放置到磁盘根目录内（记得 /lib  不可以与 /  分别放在不同的 partition）！，因此在开机的过程中核心必须要挂载根目录，这样才能读取核心模块提供价值驱动程序的功能</strong>。而且为了担心影响到磁盘内的文件系统，因此开机过程中根目录是只读方式来挂载的</p> <p>一般来说，非必要的功能且可以编译成模块的核心功能，目前的 Linux distribution 都会将它编译成模块。因此 USB、SATA、SCSI 等磁盘设备的驱动程序通常都是以模块的方式存在的。</p> <p>考虑一种情况：你的 Linux 是安装在 SATA 磁盘上面的，可以通过 BIOS 的 INT 13 获取 boot loader 与 kernel 文件来开机，然后 kernel 会开始接管系统并且检查硬件及长沙挂载根目录来获取额外的驱动程序</p> <p>问题是：<strong>核心根本不认识 SATA 磁盘</strong>，所以需要加载 SATA 磁盘的驱动程序，否则根本无法挂载根目录。但是 SATA 的驱动程序在 <code>/lib/modules</code> 内，你根本无法挂载根目录，就没法读取到 SATA 的驱动程序。</p> <p>在这种情况下，LInux 是无法顺利开机的，但是可以使用虚拟文件系统来处理这个问题</p> <p><strong>虚拟文件系统（Initial RAM Disk 或 Initial RAM Filesystem）</strong> 一般使用 <code>/boot/initrd</code> 或 <code>/boot/initramfs</code>，该文件特点是，它也可以通过 boot loader 来加载到内存中，然后该文件会被解压缩并且在内存中 <strong>仿真成一个根目录</strong>，且此仿真在内存中的文件系统能够提供一个可执行的程序，通过该程序来 <strong>加载开机过程中所最需要的核心模块</strong>，等载入完成后，会帮助核心重新调用 systemd 来开始后续的正常开机流程</p> <p>BIOS 与 boot loader 、核心加载流程示意图如下：</p> <p><img src="/linux-tutorial/assets/img/image-20200323225642529.4db5eb3a.png" alt="image-20200323225642529"></p> <p>如图所示：boot loader 可以加载 kernel 与 initramfs，在内存中让 initramfs 解压缩成为根目录，kernel 借此加载适当的驱动程序，最终释放虚拟文件系统，并挂载实际的根目录文件系统，就可以开始后续的正常开机流程了</p> <p>下面来了解下 CentOS 7.x 的 initramfs 文件内容</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 1. 直接看 initramfs 里的内容有哪些</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># lsinitrd /boot/initramfs-3.10.0-1062.el7.x86_64.img </span>
Image: /boot/initramfs-3.10.0-1062.el7.x86_64.img: 31M
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
这一部分数据笔者并没有看到有
Early CPIO image
kernel  kernel/x86
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
Version: dracut-033-564.el7

Arguments: -f

<span class="token comment"># 开始一堆模块的加载行为</span>
dracut modules:
<span class="token function">bash</span>
nss-softokn
<span class="token punctuation">..</span>.
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
drwxr-xr-x  <span class="token number">12</span> root     root            <span class="token number">0</span> Oct  <span class="token number">4</span> <span class="token number">18</span>:31 <span class="token builtin class-name">.</span>
crw-r--r--   <span class="token number">1</span> root     root       <span class="token number">5</span>,   <span class="token number">1</span> Oct  <span class="token number">4</span> <span class="token number">18</span>:31 dev/console
crw-r--r--   <span class="token number">1</span> root     root       <span class="token number">1</span>,  <span class="token number">11</span> Oct  <span class="token number">4</span> <span class="token number">18</span>:31 dev/kmsg
crw-r--r--   <span class="token number">1</span> root     root       <span class="token number">1</span>,   <span class="token number">3</span> Oct  <span class="token number">4</span> <span class="token number">18</span>:31 dev/null
lrwxrwxrwx   <span class="token number">1</span> root     root            <span class="token number">7</span> Oct  <span class="token number">4</span> <span class="token number">18</span>:31 bin -<span class="token operator">&gt;</span> usr/bin
<span class="token punctuation">..</span>.
-rwxr-xr-x   <span class="token number">1</span> root     root      <span class="token number">1624552</span> Oct  <span class="token number">4</span> <span class="token number">18</span>:31 usr/lib/systemd/systemd
<span class="token punctuation">..</span>.
-rw-r--r--   <span class="token number">1</span> root     root         <span class="token number">1377</span> Sep  <span class="token number">7</span>  <span class="token number">2017</span> usr/share/terminfo/v/vt220
drwxr-xr-x   <span class="token number">2</span> root     root            <span class="token number">0</span> Oct  <span class="token number">4</span> <span class="token number">18</span>:31 var
lrwxrwxrwx   <span class="token number">1</span> root     root           <span class="token number">11</span> Oct  <span class="token number">4</span> <span class="token number">18</span>:31 var/lock -<span class="token operator">&gt;</span> <span class="token punctuation">..</span>/run/lock
lrwxrwxrwx   <span class="token number">1</span> root     root            <span class="token number">6</span> Oct  <span class="token number">4</span> <span class="token number">18</span>:31 var/run -<span class="token operator">&gt;</span> <span class="token punctuation">..</span>/run
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
<span class="token comment"># 最后则会列出这个 initramfs 里所有的文件，也就是说，该文件大概存储两部分内容</span>
<span class="token comment"># 1. 最前面核心文件 # 笔者这个里面没有这些数据</span>
<span class="token comment"># 2. 被核心取用的全部附加的文件数据</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>下面解压下该 img 的文件，来看看里面的文件内容</p> <p>提示：笔者机器上与书上一部分对不上，所以暂时不确定是否能正常解压</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mkdir /tmp/initramfs</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># cd /tmp/initramfs</span>
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># ll /boot/</span>
total <span class="token number">135200</span>
<span class="token punctuation">..</span>.
-rw-------. <span class="token number">1</span> root root <span class="token number">31799826</span> Oct  <span class="token number">4</span> <span class="token number">18</span>:32 initramfs-3.10.0-1062.el7.x86_64.img
<span class="token punctuation">..</span>.
<span class="token comment"># 1. 跳过部分文件，这一步不跳过可以省略，直接复制原来的文件就可以</span>
<span class="token comment"># 我这里没有跳过文件，可以看到 31799826 和上面的文件大小是一样的</span>
<span class="token comment"># 书上是在下面的指令后面写了 skip 1; 跳过了一个 11264 的块，但是作者怎么知道这个大小是他需要跳过的文件大小呢？</span>
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># dd if=/boot/initramfs-3.10.0-1062.el7.x86_64.img of=initramfs.gz bs=11264       </span>
<span class="token number">2823</span>+1 records <span class="token keyword">in</span>
<span class="token number">2823</span>+1 records out
<span class="token number">31799826</span> bytes <span class="token punctuation">(</span><span class="token number">32</span> MB<span class="token punctuation">)</span> copied, <span class="token number">0.0366742</span> s, <span class="token number">867</span> MB/s
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># ll initramfs.gz; file initramfs.gz </span>
-rw-r--r--. <span class="token number">1</span> root root <span class="token number">31799826</span> Mar <span class="token number">24</span> <span class="token number">21</span>:54 initramfs.gz
initramfs.gz: <span class="token function">gzip</span> compressed data, from Unix, last modified: Fri Oct  <span class="token number">4</span> <span class="token number">18</span>:31:46 <span class="token number">2019</span>, max compression
<span class="token comment"># dd 语法还可以直接写一个压缩文件？还有这种神奇的用法？</span>
<span class="token comment"># 上面和下面都用到了 file，因此笔者猜想，上面使用 dd 纯粹是为了跳过某些文件罢了</span>
<span class="token comment"># 实际上 img 是一个 gizp 的压缩文件，可以从下面的结果看出来</span>
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># file /boot/initramfs-3.10.0-1062.el7.x86_64.img </span>
/boot/initramfs-3.10.0-1062.el7.x86_64.img: <span class="token function">gzip</span> compressed data, from Unix, last modified: Fri Oct  <span class="token number">4</span> <span class="token number">18</span>:31:46 <span class="token number">2019</span>, max compression
<span class="token comment"># 的确显示是 gzip 文件</span>

<span class="token comment"># 2. 从文件来看，是一个 gz 文件，解压该压缩文件，查看文件内容</span>
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># gzip -d initramfs.gz </span>
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># file initramfs </span>
initramfs: ASCII cpio archive <span class="token punctuation">(</span>SVR4 with no CRC<span class="token punctuation">)</span>

<span class="token comment"># 3. 解压之后，又产生了一个 cpio 的文件</span>
<span class="token comment"># 使用 cpio 来解压，并且不要绝对路径是最保险的</span>
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># cpio -i -H newc --no-absolute-filenames &lt; initramfs </span>
<span class="token number">128695</span> blocks
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># ll</span>
total <span class="token number">64356</span>
lrwxrwxrwx.  <span class="token number">1</span> root root        <span class="token number">7</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 bin -<span class="token operator">&gt;</span> usr/bin
drwxr-xr-x.  <span class="token number">2</span> root root       <span class="token number">45</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 dev
drwxr-xr-x. <span class="token number">12</span> root root     <span class="token number">4096</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 etc
lrwxrwxrwx.  <span class="token number">1</span> root root       <span class="token number">23</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 init -<span class="token operator">&gt;</span> usr/lib/systemd/systemd
-rw-r--r--.  <span class="token number">1</span> root root <span class="token number">65891840</span> Mar <span class="token number">24</span> <span class="token number">21</span>:54 initramfs
lrwxrwxrwx.  <span class="token number">1</span> root root        <span class="token number">7</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 lib -<span class="token operator">&gt;</span> usr/lib
lrwxrwxrwx.  <span class="token number">1</span> root root        <span class="token number">9</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 lib64 -<span class="token operator">&gt;</span> usr/lib64
drwxr-xr-x.  <span class="token number">2</span> root root        <span class="token number">6</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 proc
drwxr-xr-x.  <span class="token number">2</span> root root        <span class="token number">6</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 root
drwxr-xr-x.  <span class="token number">2</span> root root        <span class="token number">6</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 run
lrwxrwxrwx.  <span class="token number">1</span> root root        <span class="token number">8</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 sbin -<span class="token operator">&gt;</span> usr/sbin
-rwxr-xr-x.  <span class="token number">1</span> root root     <span class="token number">3117</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 <span class="token function">shutdown</span>
drwxr-xr-x.  <span class="token number">2</span> root root        <span class="token number">6</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 sys
drwxr-xr-x.  <span class="token number">2</span> root root        <span class="token number">6</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 sysroot
drwxr-xr-x.  <span class="token number">2</span> root root        <span class="token number">6</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 tmp
drwxr-xr-x.  <span class="token number">7</span> root root       <span class="token number">66</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 usr
drwxr-xr-x.  <span class="token number">2</span> root root       <span class="token number">29</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 var
<span class="token comment"># 可以看到上面几乎就像是一个小型的文件系统根目录，这样就能让 kernel 去挂载了</span>

<span class="token comment"># 4. 再来看下，小型文件系统中，systemd 是使用哪一个 target 来执行开机呢？</span>
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># ll usr/lib/systemd/system/default.target </span>
lrwxrwxrwx. <span class="token number">1</span> root root <span class="token number">13</span> Mar <span class="token number">24</span> <span class="token number">22</span>:05 usr/lib/systemd/system/default.target -<span class="token operator">&gt;</span> initrd.target

<span class="token comment"># 5. 最终，看看系统内默认的 initrd.target 相依的所有服务数据</span>
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># systemctl list-dependencies initrd.target </span>
initrd.target
* <span class="token operator">|</span>-dracut-cmdline.service
<span class="token punctuation">..</span><span class="token punctuation">..</span>
* <span class="token operator">|</span>-basic.target
* <span class="token operator">|</span> <span class="token operator">|</span>-microcode.service
* <span class="token operator">|</span> <span class="token operator">|</span>-rhel-dmesg.service
* <span class="token operator">|</span> <span class="token operator">|</span>-selinux-policy-migrate-local-changes@targeted.service
* <span class="token operator">|</span> <span class="token operator">|</span>-paths.target
* <span class="token operator">|</span> <span class="token operator">|</span>-slices.target
* <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>--.slice
* <span class="token operator">|</span> <span class="token operator">|</span> <span class="token variable"><span class="token variable">`</span>-system.slice
* <span class="token operator">|</span> <span class="token operator">|</span>-sockets.target
* <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>-avahi-daemon.socket
<span class="token punctuation">..</span>.
* <span class="token operator">|</span> <span class="token operator">|</span>-sysinit.target
* <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>-dev-hugepages.mount
<span class="token punctuation">..</span>.
* <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>-local-fs.target
* <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>--.mount
* <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>-boot.mount
* <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>-home.mount
* <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>-rhel-readonly.service
* <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token variable">`</span></span>-systemd-remount-fs.service
<span class="token punctuation">..</span>.
* <span class="token operator">|</span> <span class="token operator">|</span> <span class="token variable"><span class="token variable">`</span>-swap.target
* <span class="token operator">|</span> <span class="token operator">|</span>   <span class="token variable">`</span></span>-dev-mapper-centos<span class="token punctuation">\</span>x2dswap.swap
* <span class="token operator">|</span> <span class="token variable"><span class="token variable">`</span>-timers.target
* <span class="token operator">|</span>   <span class="token operator">|</span>-systemd-tmpfiles-clean.timer
* <span class="token operator">|</span>   <span class="token variable">`</span></span>-unbound-anchor.timer
* <span class="token operator">|</span>-initrd-fs.target
* `-initrd-root-fs.target

<span class="token comment"># 通过 systemd 的方式，一个一个的将所有的检查与服务价值系统中</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br></div></div><p>通过上面解开 initramfs 的结果，其实它就是一个小型的根目录，而且也是通过 systemd 来进行管理，同时观察 default.target 的链接到了 initrd.target ，就是通过它来开机，而 initrd.target 也是需要读入一堆如 basic.target、sysinit.target 等硬件检测、核心功能启用的流程，然后让系统顺利运行。最终又卸载了 initramfs 的小型文件系统，实际挂载系统的根目录</p> <p>同时可以看到 initramfs 里面很精简，仅是带入开机过程中会用到的核心模块。在 initramfs 里去找 modules 关键词，就可以发现主要的核心模块大概就是 SCSI、virtio、RAID 等与磁盘相关性较高的模块。现在由于大部分磁盘都使用 SATA ，并没有 IDE 的格式，没有 initramfs 的话，你的 Linux 几乎就不能顺利开机了，除非将 STAT 的模块直接编译到核心中去</p> <p>在核心加载完成后，主机就开始正确运行了，接下来就要开始执行系统的第一个程序 systemd</p> <h2 id="第一个程序-systemd-及使用-defaul-target-进入开机程序分析"><a href="#第一个程序-systemd-及使用-defaul-target-进入开机程序分析" class="header-anchor">#</a> 第一个程序 systemd 及使用 defaul.target 进入开机程序分析</h2> <p>在核心加载完成、进行完硬件检测与驱动程序加载后，此时你的主机硬件已经准备就绪了（ready），此时核心会调用第一个程序 systemd。</p> <p>systemd 最主要的功能就是准备软件执行的环境，包括系统的主机名、网络设置、语系处理、文件系统格式及其他服务的启动等。而所有的动作都活通过 systemd 的默认启动服务集合，也就是 <code>/etc/ststend/system/default.target</code> 来规划。</p> <h4 id="常见的操作环境-target-与兼容于-runlevel-的等级"><a href="#常见的操作环境-target-与兼容于-runlevel-的等级" class="header-anchor">#</a> 常见的操作环境 target 与兼容于 runlevel 的等级</h4> <p>可以作为预设的操作环境（default.target）的主要项目有：multi-user.target 以及 graphical.target 这两个。还包括一些比较特殊的操作环境，包括在第 17 章中的 rescue.target、emergency.target.target、shutdown.target 等，还有本章讲到的 initramfs 中的 initrd.target</p> <p>以前 systemV 使用的是一个称为 runlevel（执行等级）的概念来启动系统的，systemd 为了兼容于旧的 systemd 操作行为，下列方式可以找到与之对应的关系</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># ll -d /usr/lib/systemd/system/runlevel*.target | cut -c 28-</span>
Oct  <span class="token number">4</span> <span class="token number">18</span>:22 /usr/lib/systemd/system/runlevel0.target -<span class="token operator">&gt;</span> poweroff.target
Oct  <span class="token number">4</span> <span class="token number">18</span>:22 /usr/lib/systemd/system/runlevel1.target -<span class="token operator">&gt;</span> rescue.target
Oct  <span class="token number">4</span> <span class="token number">18</span>:22 /usr/lib/systemd/system/runlevel2.target -<span class="token operator">&gt;</span> multi-user.target
Oct  <span class="token number">4</span> <span class="token number">18</span>:22 /usr/lib/systemd/system/runlevel3.target -<span class="token operator">&gt;</span> multi-user.target
Oct  <span class="token number">4</span> <span class="token number">18</span>:22 /usr/lib/systemd/system/runlevel4.target -<span class="token operator">&gt;</span> multi-user.target
Oct  <span class="token number">4</span> <span class="token number">18</span>:22 /usr/lib/systemd/system/runlevel5.target -<span class="token operator">&gt;</span> graphical.target
Oct  <span class="token number">4</span> <span class="token number">18</span>:22 /usr/lib/systemd/system/runlevel6.target -<span class="token operator">&gt;</span> reboot.target

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="systemd-的处理流程"><a href="#systemd-的处理流程" class="header-anchor">#</a> systemd 的处理流程</h3> <p>当我们取得了 <code>/etc/systemd/system/default.target</code> 这个默认的操作界面设置后，操作系统会链接到 <code>/usr/lib.systemd/system/</code> 目录下取得 multi-usr.target 或 graphical.target 中的一个，假设使用的是 graphical.target ，接下来，systemd 会找以下两个地方的配置</p> <ul><li><code>/etc/systemd/system/graphical.target.wants/</code>：使用者设置加载的 unit</li> <li><code>/usr/lib/systemd/system/graphical.target.wants/</code>：系统默认加载的 unit</li></ul> <p>然后再由<code>/usr/lib/systemd/system/graphical.target</code> 配置文件内容发现如下资料</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># cat /usr/lib/systemd/system/graphical.target </span>
<span class="token comment">#  This file is part of systemd.</span>
<span class="token comment">#</span>
<span class="token comment">#  systemd is free software; you can redistribute it and/or modify it</span>
<span class="token comment">#  under the terms of the GNU Lesser General Public License as published by</span>
<span class="token comment">#  the Free Software Foundation; either version 2.1 of the License, or</span>
<span class="token comment">#  (at your option) any later version.</span>

<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Graphical Interface
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>man:systemd.special<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token assign-left variable">Requires</span><span class="token operator">=</span>multi-user.target				<span class="token comment"># 需要先运行该环境在运行自己</span>
<span class="token assign-left variable">Wants</span><span class="token operator">=</span>display-manager.service			<span class="token comment"># 运行完自己之后，还需要运行该服务</span>
<span class="token assign-left variable">Conflicts</span><span class="token operator">=</span>rescue.service rescue.target
<span class="token assign-left variable">After</span><span class="token operator">=</span>multi-user.target rescue.service rescue.target display-manager.service
<span class="token assign-left variable">AllowIsolate</span><span class="token operator">=</span>yes

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>那么通过同样的方式，找到 multi-user.target</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># cat /usr/lib/systemd/system/multi-user.target</span>
<span class="token comment">#  This file is part of systemd.</span>
<span class="token comment">#</span>
<span class="token comment">#  systemd is free software; you can redistribute it and/or modify it</span>
<span class="token comment">#  under the terms of the GNU Lesser General Public License as published by</span>
<span class="token comment">#  the Free Software Foundation; either version 2.1 of the License, or</span>
<span class="token comment">#  (at your option) any later version.</span>

<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Multi-User System
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>man:systemd.special<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token assign-left variable">Requires</span><span class="token operator">=</span>basic.target				<span class="token comment"># 必须要先启动该环境</span>
<span class="token assign-left variable">Conflicts</span><span class="token operator">=</span>rescue.service rescue.target
<span class="token assign-left variable">After</span><span class="token operator">=</span>basic.target rescue.service rescue.target
<span class="token assign-left variable">AllowIsolate</span><span class="token operator">=</span>yes

<span class="token comment"># 看看系统默认要加载的 unit 有哪些</span>
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># ls /usr/lib/systemd/system/multi-user.target.wants/</span>
dbus.service  plymouth-quit-wait.service  systemd-ask-password-wall.path  systemd-update-utmp-runlevel.service
getty.target  plymouth-quit.service       systemd-logind.service          systemd-user-sessions.service

<span class="token comment"># 使用者自定义要加载的 unit 有哪些</span>
<span class="token punctuation">[</span>root@study initramfs<span class="token punctuation">]</span><span class="token comment"># ls /etc/systemd/system/multi-user.target.wants/    </span>
ModemManager.service    avahi-daemon.service                   ksmtuned.service        rngd.service
NetworkManager.service  crond.service                          libstoragemgmt.service  rpcbind.service
abrt-ccpp.service       cups.path                              libvirtd.service        rsyslog.service
abrt-oops.service       cups.service                           mcelog.service          smartd.service
abrt-vmcore.service     firewalld.service                      mdmonitor.service       sshd.service
abrt-xorg.service       initial-setup-reconfiguration.service  nfs-client.target       sysstat.service
abrtd.service           irqbalance.service                     postfix.service         tuned.service
atd.service             kdump.service                          remote-fs.target        vdo.service
auditd.service          ksm.service                            rhel-configure.service  vmtoolsd.service

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>笔者在这里已经懵逼了，有点难了</p> <p>通过以上分析知道：multi-user.target 要在 basic.target 运行完毕后才能够加载上述的许多 unit。然后再去 bashic.target 中找数据等，最终这些数据可以通过 <code>systemctl list-dependencies graphical.target</code> 指令列出来所有相关性的服务</p> <p>这个就是 sytemd 调用所需要的服务流程</p> <p>简约分析下 <code>systemctl list-dependencies graphical.target</code> 所输出的相依属性服务，基本上 CentOS 7.x 的 systemd 开机流程大约是这样：</p> <ol><li><code>local-fs.target + swap.target</code>：主要在挂载本机 <code>/etc/fstab</code> 里所规范的文件系统与相关的内存交换空间</li> <li>sysinit.target：主要在检测硬件、加载所需要的核心模块等</li> <li>bashic.target：加载主要的外围用硬件驱动程序与防火墙相关服务</li> <li>multi-user.target：下面的其他一般系统或网络服务的加载</li> <li>图形界面相关服务，如 gdm.service 等其他服务的加载</li></ol> <p>除了第一步是通过 <code>/etc/fastab</code> 来进行挂载的行为之外，其他的 target 做了什么呢？下面来简单说说</p> <h2 id="systemd-执行-sysinit-target-初始化系统、bashic-target-准备系统"><a href="#systemd-执行-sysinit-target-初始化系统、bashic-target-准备系统" class="header-anchor">#</a> systemd 执行 sysinit.target 初始化系统、bashic.target 准备系统</h2> <p>如果使用 <code>systemctl list-dependencies sysinit.target</code> 会看到很多相依的服务，想要知道这些服务是干什么的，需要一个一个区看脚本设置内容，基本上，可以将这些服务归类为几个大项：</p> <ul><li>特殊文件系统装置的挂载：包括 <code>dev-hugepages.mount dev-mqueue.mount</code> 等挂载服务，主要在挂载与巨量内存分页与消息队列的功能。挂载成功后，会在 <code>/dev</code> 下建立  <code>/dev/hugepages</code> 、<code>/dev.mqueue</code> 等目录</li> <li>特殊文件系统的启用：包括磁盘阵列、网络驱动器（iscsi）、LVM 文件系、文件系统对照服务（multipath），等，也会在这里被检测到</li> <li>开机过程的信息传递与动画执行：使用 plymouthd 服务搭配 plymouth 指令来传递动画与信息</li> <li>日志文件的使用：systemd-journald 服务的启用</li> <li>加载额外额核心模块：通过 <code>/etc/modules-load.d/*.conf</code> 文件的设置，让核心额外加载管理员所需要的核心模块</li> <li>加载额外的核心参数设置：包括 <code>/etc/sysctl.conf</code> 以及 <code>/etc/sysctl.d/*.conf</code> 内部设置</li> <li>启动系统的随机数生成器：随机数生成器可以帮助系统进行一些密码加密的功能</li> <li>设置终端机（console）字形</li> <li>启动动态设备管理器：udevd，用在动态对应实际设备存取与装置文件名对应的一个服务，相当重要</li></ul> <p>无论使用哪种操作环境来使用系统，该 sysinit.target 几乎都是必要的工作，从上面看，基本的核心功能、文件系统、文件系统设备的驱动等，都在此刻处理完成的</p> <p>之后就是 basic.target 项目。该阶段主要启动的服务大概有：</p> <ul><li>加载 alsa 音效驱动程序</li> <li>加载 firewalld 防火墙：CentOS 7.x 使用 firewalld 代替 iptables 的防火墙设置，不过底层还是私用的 iptables 架构</li> <li>加载 CPU 的微指令功能</li> <li>启动与设置 SELinux 的安全本文：如果 disable 的状态改成 enable，也是在该阶段处理</li> <li>将目前的开机过程所产生的开机信息写到 <code>/var/log/dmesg</code> 中</li> <li>由 <code>/etc/sysconfig/modules/*.modules</code> 以及 <code>/etc/rc.modules</code> 加载管理员指定的模块</li> <li>加载 systemd 支持的 timer 功能</li></ul> <p>该阶段之后，系统已经开源顺利的运行，就差一堆需要的登录服务、网络服务、本机认证服务等 service 类别，下个阶段就进入到服务启动的阶段了</p> <h2 id="systemd-启动-multi-user-target-下的服务"><a href="#systemd-启动-multi-user-target-下的服务" class="header-anchor">#</a> systemd 启动 multi-user.target 下的服务</h2> <p>这些服务的启动大多是挂载 multi-user.target 操作环境下，可以到 <code>/etc/systemd/system/multi-user.target.wants/</code> 中看看默认要启动的服务。</p> <p>一般来说服务的启动脚本设置都是放在如下的目录内：</p> <ul><li><code>/usr/lib/systemd/system</code>：系统默认的服务启动脚本设置</li> <li><code>/etc/systemd/system</code>：管理员自己开发与设置的脚本设置</li></ul> <p>而用户针对主机的本地服务于服务器网络服务的各项 unit 若要 enable ，将他 放到 <code>/etc/systemd/system/multi-user.target.wants/</code> 目录下做个链接，就可以在开机的时候去启用它。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 将 vsftpd.service 先 disable 再 enable 看看输出的信息</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># systemctl disable vsftpd.service</span>
<span class="token function">rm</span> <span class="token string">'/etc/systemd/system/multi-user.target.wants/vsftpd.service'</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># systemctl enable vsftpd.service</span>
<span class="token function">ln</span> -s <span class="token string">'/usr/lib/systemd/system/vsftpd.service'</span> <span class="token string">'/etc/systemd/system/multi-user.target.wants/vsftpd.service'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="相容-systemv-的-rc-local-service"><a href="#相容-systemv-的-rc-local-service" class="header-anchor">#</a> 相容 systemV 的 rc-local.service</h3> <p>过去，要让系统开机后执行某些程序，可以将指令或脚本的绝对路径写入到 <code>/etc/rc.d/rc.local</code> 文件中</p> <p>systemd 环境下，写一个 systemd 的启动脚本配置文件到 <code>/etc/systemd/system</code> 下，然后使用 systemctl enable 的方式来启动它</p> <p>rc-local.service 服务就兼容了老的方式。该服务不需要启动，它会判断 <code>/etc/rc.d/rc.local</code> 是否具有可执行的权限来判断要不要启动这个服务。可以如下检查</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 1. 查看 rc.local 的权限，再检查 multi-user.target 有没有该服务</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># ll /etc/rc.d/rc.local </span>
-rw-r--r--. <span class="token number">1</span> root root <span class="token number">473</span> Aug  <span class="token number">8</span>  <span class="token number">2019</span> /etc/rc.d/rc.local

<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># systemctl status rc-local.service </span>
* rc-local.service - /etc/rc.d/rc.local Compatibility
   Loaded: loaded <span class="token punctuation">(</span>/usr/lib/systemd/system/rc-local.service<span class="token punctuation">;</span> static<span class="token punctuation">;</span> vendor preset: disabled<span class="token punctuation">)</span>
   Active: inactive <span class="token punctuation">(</span>dead<span class="token punctuation">)</span>

<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># systemctl list-dependencies multi-user.target | grep rc-local</span>

<span class="token comment"># 可以看到，有这个服务，但是 rc.local 没有可执行权限，因此该服务不会被执行</span>

<span class="token comment"># 2. 加入可执行后，再看下 rc-local 是否可被启用 </span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># chmod a+x /etc/rc.d/rc.local ;  ll /etc/rc.d/rc.local </span>
-rwxr-xr-x. <span class="token number">1</span> root root <span class="token number">473</span> Aug  <span class="token number">8</span>  <span class="token number">2019</span> /etc/rc.d/rc.local
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># systemctl list-dependencies multi-user.target | grep rc-local</span>
* <span class="token operator">|</span>-rc-local.service

<span class="token comment"># 可以看到，该服务确实被记录到启动的环境下了</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="提供-tty-界面与登录的服务"><a href="#提供-tty-界面与登录的服务" class="header-anchor">#</a> 提供 tty 界面与登录的服务</h3> <p>在 multi-user.target 下有个 getty.target 的操作界面项目。能不能提供适当的登录服务也是该 target 下的内容，包括 systemd-logind.service、systemd-usr-sessions.service 等服务</p> <p>这里可能会出现一个现象，在启动系统时，看到屏幕出现 tty1 可以登录，但是当输入正确的用户名和密码却无法登录，等待十几秒才可以，这是因为以上服务同时启动的，所以有可能 tty 先启动好，logind 还未启动好造成的</p> <h2 id="systemd-启动-graphical-target-下的服务"><a href="#systemd-启动-graphical-target-下的服务" class="header-anchor">#</a> systemd 启动 graphical.target 下的服务</h2> <p>如果 default.target 是 multi-user.target 的话，这个步骤就不会执行。</p> <p>systemd 开始加载用户管理服务于图形界面管理员（window display manager，DM），启动图形界面让用户可以以图形界面登录系统，可以查看有哪些服务</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># systemctl list-dependencies graphical.target </span>
graphical.target
* <span class="token operator">|</span>-accounts-daemon.service
* <span class="token operator">|</span>-gdm.service
* <span class="token operator">|</span>-initial-setup-reconfiguration.service
* <span class="token operator">|</span>-network.service
* <span class="token operator">|</span>-rtkit-daemon.service
* <span class="token operator">|</span>-systemd-readahead-collect.service
* <span class="token operator">|</span>-systemd-readahead-replay.service
* <span class="token operator">|</span>-systemd-update-utmp-runlevel.service
* <span class="token operator">|</span>-udisks2.service
* `-multi-user.target
*   <span class="token operator">|</span>-abrt-ccpp.service
<span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>也有很多服务，其中 gdm.service 去查看他的内容，会发现执行的是 <code>/usr/sbin/gdm</code> 这个是让用户可以利用图形界面登录最重要的服务，未来再来详细讲解 gdm</p> <h2 id="开机过程会用到的主要配置文件"><a href="#开机过程会用到的主要配置文件" class="header-anchor">#</a> 开机过程会用到的主要配置文件</h2> <p>systemd 有自己的配置文件处理方式，不过为了兼容 systemV，还有部分服务脚本设置会读取 <code>/etc/sysconfig/</code> 下的环境配置文件。下面来看看几个比较重要的配置文件</p> <h3 id="关于模块-etc-modprobe-d-conf-与-etc-modules-load-d-conf"><a href="#关于模块-etc-modprobe-d-conf-与-etc-modules-load-d-conf" class="header-anchor">#</a> 关于模块 <code>/etc/modprobe.d/*.conf 与 /etc/modules-load.d/*.conf</code></h3> <p>在 sysinit.target 系统初始化中谈到加载用户自定义模块的地方，有两个地方可以处理模块加载的问题：</p> <ul><li><code>/etc/modules-load.d/*.conf</code>：单纯要核心加载模块的位置</li> <li><code>/etc/modprobe.d/*.conf</code>：可以加上模块参数的位置</li></ul> <p>Systemd 基本上帮我们开机会用到的驱动程序全部加载了，一般不需要更改这部分，如果有特殊需求要处理的话，就需要再这里进行了。</p> <p>举例：在第 17 章中谈到 vsftpd 服务，端口号粳稻到 555 上去了，我们可能需要修改防火墙设置，其中一个针对 FTP 很重要的防火墙模块为 nf_conntrack_ftp ，因此，可以将这个模块写入到系统开机流程中。例如</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># vim /etc/modules-load.d/mrcode.conf</span>
nf_conntrack_ftp

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>一个模块（驱动程序）写一行，上述的模块基本上是针对默认 FTP 端口的，即 21 ，如果需要调整到port 555 ，需要额外带参数，模块外加参数的设置方式需要写到另外一个地方</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># vim /etc/modprobe.d/mrcode.conf</span>
options nf_conntrack_ftp <span class="token assign-left variable">ports</span><span class="token operator">=</span><span class="token number">555</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># lsmod | grep nf_conntrack_ftp</span>
<span class="token comment"># 因为还没有加载该模块，所以没有任何信息</span>

<span class="token comment"># 重启模块服务后，就发现被加载了</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># systemctl restart systemd-modules-load.service  </span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># lsmod | grep nf_conntrack_ftp</span>
nf_conntrack_ftp       <span class="token number">18478</span>  <span class="token number">0</span> 
nf_conntrack          <span class="token number">139224</span>  <span class="token number">8</span> nf_nat,nf_nat_ipv4,nf_nat_ipv6,xt_conntrack,nf_nat_masquerade_ipv4,nf_conntrack_ftp,nf_conntrack_ipv4,nf_conntrack_ipv6

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>通过如上方式，可以在开机时将你需要的驱动程序或则是调整这些模块的外加参数</p> <p>###<code>/etc/sysconfig/*</code></p> <p>下面讲解几个比较常见且重要的环境配置文件</p> <ul><li><p>authconfig</p> <p>主要规范使用者的身份认证机制，包括是否使用本机的 <code>/etc/passwd</code>、<code>/etc/shadow</code> 等，以及 <code>/etc/shadow</code> 密码记录使用何种加密算法，还有是否使用外部密码服务器提供的账户验证（NIS、LDAP）等。系统默认使用 SHA512 加密算法，并且不使用外部的身份验证机制；</p> <p>另外不建议手动修改该文件，应该使用 <code>authconfig-tui</code> 来修改</p></li> <li><p>cpupower</p> <p>如果有启动 cpupower.service 服务时，就会读取该文件。主要是 Linux 核心如何操作 CPU 的原则。一般来说，启动 cpupower.service 后，系统会让 CPU 以最大效能的方式来运行，否则预设就是用多少算多少的模式来处理</p></li> <li><p>firewalld、iptables-config、ebtables-config</p> <p>与防火墙服务的启动外带参数有关</p></li> <li><p>network-scripts</p> <p>至于 network-scripts 文件，则主要用来设置网卡</p></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zq99299/linux-tutorial/edit/master/docs/tutorial-basis/19/01.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: :</span> <span class="time">a few seconds ago</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/linux-tutorial/tutorial-basis/19/" class="prev router-link-active">
        开机流程、模块管理与 Loader
      </a></span> <span class="next"><a href="/linux-tutorial/tutorial-basis/19/02.html">
        核心与核心模块
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/linux-tutorial/assets/js/app.edeac043.js" defer></script><script src="/linux-tutorial/assets/js/2.b00e63ff.js" defer></script><script src="/linux-tutorial/assets/js/15.9161726f.js" defer></script><script src="/linux-tutorial/assets/js/16.b0a90d5f.js" defer></script>
  </body>
</html>
