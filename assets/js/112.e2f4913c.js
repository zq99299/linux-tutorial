(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{617:function(s,t,a){"use strict";a.r(t);var n=a(16),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"使用者身份切换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用者身份切换"}},[s._v("#")]),s._v(" 使用者身份切换")]),s._v(" "),a("p",[s._v("身份变化可能有以下几个原因：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("使用一般账户：系统平时操作的好习惯")]),s._v(" "),a("p",[s._v("为了安全，一般都会建议尽量以一般身份使用者来操作 Linux 的日常工作。等到需要设置系统环境时，才切换成 root 来管理系统，相对比较安全，避免误操作一些严重的指令，例如 "),a("code",[s._v("rm -rf /")])])]),s._v(" "),a("li",[a("p",[s._v("用较低权限启动系统服务")]),s._v(" "),a("p",[s._v("比如：apache 软件，创建一个 apache 用户来启动它，就算该软件被攻破了，至少不至于损坏整个系统；")])]),s._v(" "),a("li",[a("p",[s._v("软件本身的限制")]),s._v(" "),a("p",[s._v("在远古时代的 telnet 程序中，默认是不允许使用 root 身份登录的，若发现是 UID=0 的登录直接拒绝登录；此外 ssh 也可以设置拒绝 root 登录的")])])]),s._v(" "),a("p",[s._v("由于上述考虑，没有系统设定等的特殊需求下，都是使用的一般账户登录，如果有则可以变换身份，主要有两种方式：")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("su")]),s._v("：以 "),a("code",[s._v("su -")]),s._v(" 指令直接将身份变成 root")]),s._v(" "),a("p",[s._v("该指令需要 root 密码，输入验证成功后才可以切换成 root 身份")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("sudo")]),s._v("：以 "),a("code",[s._v("sudo 指令")]),s._v(" 执行指令串")]),s._v(" "),a("p",[s._v("由于 sudo 需要实现设置，且 sudo 需要输入用户自己的密码，因此多人共同管理同一部主机时， sudo 要比 su 好，至少 root 密码不会流传出去")])])]),s._v(" "),a("h2",{attrs:{id:"su"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#su"}},[s._v("#")]),s._v(" su")]),s._v(" "),a("p",[s._v("最简单的身份切换指令，可以进行任何身份的切换")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-lm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-c 指令"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("选项与参数：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("-")]),s._v("：单纯使用 "),a("code",[s._v("su -")]),s._v(" 表示使用 login-shell 的变量文件读取方式来登录系统，若使用者名称没有加上去，则代表切换为 root 身份")]),s._v(" "),a("li",[a("code",[s._v("-l")]),s._v("：与 "),a("code",[s._v("-")]),s._v(" 类似，单后面需要加要切换的使用者账户，也是 login-shell 的方式")]),s._v(" "),a("li",[a("code",[s._v("m")]),s._v("：与 "),a("code",[s._v("-p")]),s._v(" 是一样的，表示：使用目前的环境设置，而不读取新使用者的配置文件")]),s._v(" "),a("li",[a("code",[s._v("-c")]),s._v("：仅进行一次指令，所以 "),a("code",[s._v("-c")]),s._v(" 后面可以加上指令")])]),s._v(" "),a("p",[s._v("前面讲解过 "),a("RouterLink",{attrs:{to:"/tutorial-basis/13/10/04.html#login-与-non-login-shell"}},[s._v(" login-shell ")]),s._v("  是啥，这里有没有加上 "),a("code",[s._v("-")]),s._v(" 的指令涉及到了 login-shell 与 non-login shell 的变量读取方式，下面以例子说明")],1),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 1： 假设现在身份是 mrcode , 想要使用 non-login shell 的方式变成 root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v("\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意提示字符是 mrcode 身份")]),s._v("\nPassword: \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study mrcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# id\t")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# id 识别的确是 root 身份")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("context")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看环境变量中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study mrcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# env | grep 'mrcode'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOSTNAME")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("study.centos.mrcode\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mrcode\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当前用户还是 mrcode")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/lib64/qt-3.3/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/home/mrcode/.local/bin:/home/mrcode/bin\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个影响最大，只找了 /home/mrcode")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MAIL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/spool/mail/mrcode\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 信箱也是")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PWD")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/mrcode\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 也并非是 root 的家的目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LOGNAME")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mrcode\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("XDG_DATA_DIRS")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/mrcode/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 虽然 UID 已经具有 root 的身份，但是还有一堆变量是原本 mrcode 的身份，所以还是有很多数据无法直接利用")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 离开当前的 su 环境")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study mrcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("所以单纯的使用 su 切换成 root 方式，。读取的变量设定方式为 non-login shell 的方式，这种方式很多原本的变量不会被改变，尤其是很重要的 PATH 变量，由于没有改变为 root 环境，因此很多 root 管惯用的指令就只能使用绝对路径来执行。所以执行切换身份时，务必使用以下范例")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 2：使用 login shell 的方式切换为 root 的身份并观察变量")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" -\nPassword: \t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入 root 密码登录")]),s._v("\nLast login: Tue Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":47:26 CST "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" on pts/1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# env | grep root")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MAIL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/spool/mail/root\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PWD")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOME")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LOGNAME")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("XDG_DATA_DIRS")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("XAUTHORITY")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root/.xauthL0s7Pj\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到环境变量都变成 root 的了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# env | grep mrcode")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOSTNAME")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("study.centos.mrcode\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("同样可以使用 exit 指令离开 root 身份，如果只是想使用 root 执行一次命令，就恢复原本的身份可以使用 "),a("code",[s._v("-c")]),s._v(" 选项")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 3：mrcode 要执行  hread -n 3 /etc/shadow 一次，已知 root 密码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("head")]),s._v(" -n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("  /etc/shadow\nhead: cannot "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/etc/shadow'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" reading: Permission denied\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" - -c "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"head -n 3 /etc/shadow"')]),s._v("\nPassword: \t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入 root 密码")]),s._v("\nroot:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$6")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$eC75oi")]),s._v(".rU.wJPhgN"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$C")]),s._v(".C.qFXTvmJ64qFnez88TdcsHuuQAqtAYrukgBYBspgSZbCgzvJuv4OVJ9gaEfA2/.T7e68AZW7RoZt6ubeHD0::0:99999:7:::\nbin:*:17834:0:99999:7:::\ndaemon:*:17834:0:99999:7:::\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ \t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意看这里的身份还是 mrcode")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("那么怎么切换为其他账户呢？")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 4：原本是 mrcode 使用者，想要变换身份为 mrcode1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" -l mrcode1\nPassword: \t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入 mrcode1 的密码")]),s._v("\nLast login: Mon Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":35:35 CST "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".4.170 on pts/2\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode1@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" -\t\t\t\n密码：\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入 root 的密码，切换到 root")]),s._v("\n上一次登录：二 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":58:09 CST 2020pts/1 上\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# id sshd\t\t\t# 查看这个账户，发现有该账户")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("74")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("74")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 组"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("74")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sshd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# su -l sshd\t\t\t")]),s._v("\nThis account is currently not available.  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提示无法切换到 sshd")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# finger sshd\t\t# 查看他的信息如下")]),s._v("\nLogin: sshd           \t\t\tName: Privilege-separated SSH\nDirectory: /var/empty/sshd          \tShell: /sbin/nologin\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里的 nologin 问题")]),s._v("\nLast login 二 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" on pts/1\nNo mail.\nNo Plan.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n登出\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 离开第 2 次的 su")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode1@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n登出\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 离开第 1 次的 su")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里又回到了最初的 mrcode  身份")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h3",{attrs:{id:"小结用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结用法"}},[s._v("#")]),s._v(" 小结用法")]),s._v(" "),a("ul",[a("li",[s._v("若要完整的切换到新使用者的环境，比如要使用 "),a("code",[s._v("su - username 或 su -l username")]),s._v("，才会连同 PATH、USER、MAIL 等变量都转成新用户的环境")]),s._v(" "),a("li",[s._v("如果仅想要执行一次 root 的指令，可以利用 "),a("code",[s._v('su -c "指令串"')]),s._v(" 的方式来处理")]),s._v(" "),a("li",[s._v("使用 root 切换称为任何使用者时，并不需要输入新用户的密码")])]),s._v(" "),a("h2",{attrs:{id:"sudo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sudo"}},[s._v("#")]),s._v(" sudo")]),s._v(" "),a("p",[s._v("相对于 su 需要了解切换用户的密码（常常是 root 的密码），而 sudo 的执行仅需要自己的密码，还可以设置不需要密码就可以执行 sudo；由于 sudo 可以让你以其他用户的身份执行指令，（通常是利用 root 身份执行命令），所以并非所有人都能够执行 sudo，而是需要规范到 "),a("code",[s._v("/etc/sudoers")]),s._v("内的用户才能够执行 sudo 指令")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("一般用户能够具有 sudo 的使用权，是经过管理员审核通过后，也就是受信任的账户，否则一般用户默认是不能操作 sudo 的")])]),s._v(" "),a("h3",{attrs:{id:"sudo-的指令用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sudo-的指令用法"}},[s._v("#")]),s._v(" sudo 的指令用法")]),s._v(" "),a("p",[s._v("由于系统默认仅有 root 可以执行 sudo，因此下面的范例先使用 root 来执行。等谈到 visudo 时，再已一般使用者来讨论其他 sudo 的用法")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("最初情况下是只有 root 能执行 sudo 的，但是在安装 CentOs 时，创建了一个用户，这个用户也具有 sudo 的权限")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-u 新使用者账户"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n选项与参数：\n\t-b：将后续的指令放到背景中让系统自动执行，而不与目前的 shell 产生影响\n\t-u：后面可以接要切换的使用者账户，若没此项，则表示切换到 root 身份\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 1：想要以 sshd 的身份在 /tmp 下创建一个名为 myssh 的文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sudo -u sshd touch /tmp/mysshd")]),s._v("\n您在 /var/spool/mail/root 中有新邮件\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /tmp/mysshd ")]),s._v("\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" sshd sshd "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":04 /tmp/mysshd\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到是由 ssh 创建的")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 2：以 mrcode1 的身份创建 ~Vbird1/www 并在其中创建 index.html 文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sudo -u mrcode1 sh -c \"mkdir ~mrcode1/www; cd ~mrcode1/www; echo 'This is index.html'  > index.html\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -a ~mrcode1/www/")]),s._v("\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\ndrwxr-xr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mrcode1 mrcode1  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":15 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\ndrwx------. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" mrcode1 mrcode1 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("201")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":15 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mrcode1 mrcode1  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":15 index.html\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 注意上面 那个 sh -c ""  这一串不是 sudo 的参数，是指令；sh --help 可以看到 sh -c "指令串"，是利用 sh 执行命令')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("范例 2 使用 sh -c 来执行多重指令。")]),s._v(" "),a("p",[s._v("为什么 sudo 预设仅有 root 能使用？是因为 sudo 的执行流程如下：")]),s._v(" "),a("ol",[a("li",[s._v("当用户执行 sudo 时，系统与 "),a("code",[s._v("/etc/sudoers")]),s._v(" 文件中搜索该使用者是否有执行 sudo 的权限")]),s._v(" "),a("li",[s._v("若使用者具有可执行 sudo 的权限后，便让使用者「输入用户自己的密码」来确认")]),s._v(" "),a("li",[s._v("若密码输入成功，变开始进行 sudo 后续接的指令（root 执行 sudo 时不需要密码）")]),s._v(" "),a("li",[s._v("若要切换的身份与执行者身份相同，也不需要输入密码")])]),s._v(" "),a("p",[s._v("所以是否能使用 sudo ，必须要看 "),a("code",[s._v("/etc/sudoers")]),s._v(" 中是否有配置，这种文件都有自己的规范，所以提供了一个 visudo 指令来帮助管理该文件")]),s._v(" "),a("h3",{attrs:{id:"visudo-与-etc-sudoers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#visudo-与-etc-sudoers"}},[s._v("#")]),s._v(" visudo 与 "),a("code",[s._v("/etc/sudoers")])]),s._v(" "),a("p",[s._v("使用 visudo 来修改，在结束离开时，会校验 "),a("code",[s._v("/etc/sudoers")]),s._v(" 的语法，来避免修改错误的语法导致 sudo 无法使用")]),s._v(" "),a("p",[s._v("一般来说，visduo 的设置方式有几种简单的方法，下面介绍几个简单的例子来说明")]),s._v(" "),a("h3",{attrs:{id:"单一用户使用-sudo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单一用户使用-sudo"}},[s._v("#")]),s._v(" 单一用户使用 sudo")]),s._v(" "),a("p",[s._v("单一用户可进行 root 所有指令，与 sudoers 文件语法：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 让 mrcode1 账户可以使用 root 的任何指令，基本上有两种方式：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 直接修改 /etc/sudoers")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# visudo ")]),s._v("\n:set nu\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示行号")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" root    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" mrcode1 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在 100 行后，添加 mrcode1 的数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后保存离开")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("其实 visudo 利用 vi 将文件打开修改。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("使用者账户\t登陆者的来源主机名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("（可切换的身份）\t可下达的指令\nroot    \t"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       \t\t\t\tALL\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("各字段含义如下：")]),s._v(" "),a("ol",[a("li",[s._v("使用者账户：系统中那个账户可以使用 sudo 指令")]),s._v(" "),a("li",[s._v("登陆者的来源主机名：就是信任哪一台网络主机可以联机，这个值可以指定客户端计算机。默认的 ALL 是允许任何一台网络主机")]),s._v(" "),a("li",[s._v("可切换的身份：这个账户可以切换成什么身份来下达后续的指令。默认 root 可以切换成任何人")]),s._v(" "),a("li",[s._v("可下达的指令：可用该身份下达什么指令？"),a("strong",[s._v("这个指令请务必使用绝对路径")]),s._v("，预设 root 可以切换任何身份且下达任何指令")])]),s._v(" "),a("p",[s._v("All 是特殊的关键词，代表任何身份、主机、指令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进行测试")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode1@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" /etc/shadow\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里是 mrcode1 登录的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提示权限不足")]),s._v("\ntail: cannot "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/etc/shadow'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" reading: Permission denied\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 sudo 来执行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode1@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" /etc/shadow\n\nWe trust you have received the usual lecture from the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" System\nAdministrator. It usually boils down to these three things:\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1) Respect the privacy of others.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2) Think before you type.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3) With great power comes great responsibility.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面只是提示，大概意思是能力越大责任越大，慎重之类的意思")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" mrcode1: \t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后输入 mrcode1 自己的密码，就可以执行了")]),s._v("\npro3:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$6")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$oku6c8Az")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GUOVL1SkmFnSnVHvUCKnToNv8l7094dQ17")]),s._v("/GOw/R5mdxqiE0THtkFaO4GpzFMxJy30rZbpWgQcNSpMqHN8KWT/:18316:0:99999:7:::\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[s._v("利用 wheel 群组以及免密码的功能处理 visudo")]),s._v(" "),a("h3",{attrs:{id:"wheel-群组使用-sudo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wheel-群组使用-sudo"}},[s._v("#")]),s._v(" wheel 群组使用 sudo")]),s._v(" "),a("p",[s._v("之前曾建立过 pro1、pro2、pro3  让这 3 个用户也可以使用 sudo，但是通过群组的方式来支持")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 使用 visudo 设置 whell 群组")]),s._v("\nvisudo\n\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("99")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Allow root to run any commands anywhere")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" root    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" mrcode1 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("102")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("103")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Allows members of the 'sys' group to run networking, software,")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("104")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## service management apps and more.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("105")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# %sys ALL = NETWORKING, SOFTWARE, SERVICES, STORAGE, DELEGATING, PROCESSES, LOCATE, DRIVERS")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("106")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Allows people in group wheel to run all commands")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),s._v(" %wheel  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在最左边增加 % 表示是一个群组，注意在编辑的时候，当时笔者吧 $wheel 这一行写在 上面 root 后面，报错就报错说有语法错误，不知道是否也有识别，需要写到这个 Allows people in group wheel to run all commands 这一行下面呢？")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意： whell 这个配置默认已经配置过了，并且该组也已经存在了。应该是系统初始化就有的")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 将 pro1 添加进 wheel 群组")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# usermod -a -G wheel pro1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 切换到 pro1 、pro2 并执行 sudo 命令查看")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# su -l pro1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("pro1@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" /etc/shadow\n\nWe trust you have received the usual lecture from the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" System\nAdministrator. It usually boils down to these three things:\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1) Respect the privacy of others.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2) Think before you type.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3) With great power comes great responsibility.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" pro1: \npro3:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$6")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$oku6c8Az")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GUOVL1SkmFnSnVHvUCKnToNv8l7094dQ17")]),s._v("/GOw/R5mdxqiE0THtkFaO4GpzFMxJy30rZbpWgQcNSpMqHN8KWT/:18316:0:99999:7:::\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换到 pro2 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# su -l pro2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("pro2@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("pro2@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" /etc/shadow\n\nWe trust you have received the usual lecture from the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" System\nAdministrator. It usually boils down to these three things:\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1) Respect the privacy of others.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2) Think before you type.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3) With great power comes great responsibility.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" pro2: \npro2 is not "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the sudoers file.  This incident will be reported.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提示 pro2 不在 sudoers 文件中")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br")])]),a("p",[s._v("那么这里对群组进行了支持，pro2 和 pro3 也要支持 sudo 的话，直接使用 usermod 将他们添加到 wheel 组中即可")]),s._v(" "),a("p",[s._v("前面说安装系统创建的用户，直接设置为了管理员的话，也是可以使用 sudo 指令的，这个操作就是将那个账户添加到了 wheel 组了")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" mrcode \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mrcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mrcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mrcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(",100"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" pro1\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1505")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pro1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1508")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pro1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1508")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pro1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(",10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("wheel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(",1507"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("projecta"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/shadow\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" mrcode: \nmrcode is not "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the sudoers file.  This incident will be reported.\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 我们这里看到，这里的账户并没有加入 wheel 这个组，实际执行 sudo 的话，也会提示不支持；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这就说明当时我并没有选择添加为管理员")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("从 Centos 7 开始， "),a("code",[s._v("%wheel")]),s._v(" 这行默认存在，并且也有这个组")]),s._v(" "),a("h3",{attrs:{id:"免密使用-sudo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#免密使用-sudo"}},[s._v("#")]),s._v(" 免密使用 sudo")]),s._v(" "),a("p",[s._v("既然管理员都信任这些用户了，是否可以提供：不需要密码就可以使用 sudo 呢？")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# visudo ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Allows people in group wheel to run all commands")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# %wheel        ALL=(ALL)       ALL")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Same thing without a password")]),s._v("\n%wheel  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       NOPASSWD: ALL\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("找到上述地方，在第三个字段，将 NOPASSWD 哪一行放开，把上面原始的注释掉。也就是在可下达的指令前使用 "),a("code",[s._v("NOPASSWD:")]),s._v(" 来标识不需要密码")]),s._v(" "),a("h3",{attrs:{id:"有限制的指令操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#有限制的指令操作"}},[s._v("#")]),s._v(" 有限制的指令操作")]),s._v(" "),a("p",[s._v("上面的配置可以让使用者利用 root 身份进行任何事情，如果要配置只能够允许进行一部分事情的话，比如 myuser1 只能帮 root 修改其他用户的密码，可以如下做")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# visudo ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Allow root to run any commands anywhere")]),s._v("\nroot    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL\nmrcode1 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL\nmyuser1 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       /usr/bin/passwd\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用绝对路径，来给定使用的指令")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再使用 myuser1 来测试是否成功")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myuser1@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/shadow\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" myuser1: \nSorry, user myuser1 is not allowed to execute "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/bin/cat /etc/shadow'")]),s._v(" as root on study.centos.mrcode.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到不支持 /bin/cat 指令")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再使用 sudo passwd ，发现可以执行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myuser1@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" myuser3\nChanging password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user myuser3.\nNew password: \nBAD PASSWORD: The password is shorter than "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" characters\nRetype new password: \npasswd: all authentication tokens updated successfully.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面修改了 myuser3 的密码")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里不加参数，发现可以直接修改 root 的密码，这样就不行了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myuser1@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v("\nChanging password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user root.\nNew password: \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 还可以限制指令的参数")]),s._v("\nmyuser1 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("/usr/bin/passwd, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("/usr/bin/passwd root, /usr/bin/passwd "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("A-Za-z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("*\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不可执行的指令添加上了感叹号 !")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面直接执行 passwd 和 passwd root 都不允许，后面一个用正则规定了参数，必须使用字母开头的参数")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试，就会提示不被允许执行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myuser1@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v("\nSorry, user myuser1 is not allowed to execute "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/bin/passwd'")]),s._v(" as root on study.centos.mrcode.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("h3",{attrs:{id:"通过别名建立-visudo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过别名建立-visudo"}},[s._v("#")]),s._v(" 通过别名建立 visudo")]),s._v(" "),a("p",[s._v("比如我有 15 个用户加入刚刚的管理员，那么是否都需要将上述限制命令的代码复制 15 行配置到 visudo 中呢？")]),s._v(" "),a("p",[s._v("可以通过 visudo 的别名功能，可以是：指令别名、账户别名、主机别名等。这里仅介绍账户别名")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 假设 pro1、pro2、pro3 与 myuser1、myuser2 要加入上述的密码管理员的 sudo 列表中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 那么可以创建一个账户别名为 ADMPW，然后配置该账户别名")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## User Aliases")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## These aren't often necessary, as you can use regular groups")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## (ie, from files, LDAP, NIS, etc) in this file - just use %groupname")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## rather than USERALIAS")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# User_Alias ADMINS = jsmith, mikem")]),s._v("\nUser_Alias ADMPW "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pro1, pro2, pro3, myuser1, myuser2\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Command Aliases")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## These are groups of related commands...")]),s._v("\nCmnd_Alias ADMPWCOM "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("/usr/bin/passwd, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("/usr/bin/passwd root, /usr/bin/passwd "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("A-Za-z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("*\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Allow root to run any commands anywhere")]),s._v("\nroot    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL\nmrcode1 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL\nmyuser1 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("/usr/bin/passwd, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("/usr/bin/passwd root, /usr/bin/passwd "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("A-Za-z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("*\nADMPW   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ADMPWCOM\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面定义了 User_Alias 用户别名 和 Cmnd_Alias 命令别名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 并在之前配置用户的地方使用上了这两个别名")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("别名建议使用大写；后续对用户的维护直接修改别名中的即可")]),s._v(" "),a("h3",{attrs:{id:"sudo-的时间间隔问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sudo-的时间间隔问题"}},[s._v("#")]),s._v(" sudo 的时间间隔问题")]),s._v(" "),a("p",[s._v("如果使用同一个账户在极短时间内重复操作 sudo 来运行指令的话，在第二次执行 sudo 时，并不需要输入自己的密码！也可以正常运行")]),s._v(" "),a("p",[s._v("这是因为有一个机制，sudo 两次操作间隔超过 5 分钟，那么就需要重新输入一次密码。这个机制也是为了安全，比如你输入密码执行过一次 sudo，这个时候去厕所了，超过了 5 分钟还没有回来，防止别人动你的电脑执行 sudo")]),s._v(" "),a("h3",{attrs:{id:"sudo-搭配-su-的使用方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sudo-搭配-su-的使用方式"}},[s._v("#")]),s._v(" sudo 搭配 su 的使用方式")]),s._v(" "),a("p",[s._v("有时候需要大量执行很多 root 的工作，一直使用 sudo 就很麻烦，可以通过下面的方式结合 su，并且还使用用户自己的密码来变成 root")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("visudo\nUser_Alias ADMINS "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pro1, pro2, pro3, myuser1\nADMINS  "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("      /bin/su -\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个 ADMINS 的用户别名，再限制该用户只能切换到 root，并且只能执行 su -")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意使用是：用 sudo 命令来执行 su")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("pro2@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" -\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" pro2: \nLast login: Tue Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":09:19 CST "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" on pts/1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# \t\t# 看这里的提示，变成了 root")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("这个方式是这样的：")]),s._v(" "),a("ol",[a("li",[s._v("限制了可切换为 root，那么这些用户只能切换到 root")]),s._v(" "),a("li",[s._v("并且这些用户只能通过 sudo 执行 "),a("code",[s._v("su -")]),s._v(" 的操作")]),s._v(" "),a("li",[s._v("sudo 需要输入用户自己的密码，通过之后相当于是 root 身份了，用 root 身份执行 su -  切换到 root 身份，就不需要 root 密码了（root 使用 su 不需要密码）")])]),s._v(" "),a("p",[s._v("通过中方式也能授权管理员账户。")])])}),[],!1,null,null,null);t.default=e.exports}}]);