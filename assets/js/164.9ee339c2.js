(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{683:function(s,a,t){"use strict";t.r(a);var n=t(16),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"tarball-的管理与建议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tarball-的管理与建议"}},[s._v("#")]),s._v(" Tarball 的管理与建议")]),s._v(" "),t("p",[s._v("那么接下来我们要知道如何使用具有源码的 Tarball 来建立一个属于自己的软件")]),s._v(" "),t("p",[s._v("Tarball 的安装是可以跨平台的，只是需要的编译程序可能并不相同，例如 Linux 上用 gcc，而 windows 上也有相关的 c 编译程序。")]),s._v(" "),t("p",[s._v("如果万一没有编译成功，可以通过修改小部分的程序代码（通常是因为很小部分的不同）就可以跨平台的移植了")]),s._v(" "),t("h2",{attrs:{id:"使用源码管理软件所需要的基础软件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用源码管理软件所需要的基础软件"}},[s._v("#")]),s._v(" 使用源码管理软件所需要的基础软件")]),s._v(" "),t("p",[s._v("从源码制作一个 binary program 需要很多软件的支持，包括以下基础的软件：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("gcc 或 cc 等 c 语言编译程序（compiler）")]),s._v(" "),t("p",[s._v("编译程序也有很多，其中以 GNU 的 gcc 是首选的自由软件编译程序，在 Linux 平台上面发展的软件的源码，原本就是以 gcc 为底来设计的")])]),s._v(" "),t("li",[t("p",[s._v("需要 Kernel 提供的 Library 以及相关的 Include 文件")]),s._v(" "),t("p",[s._v("从前面的源码编译过程，我们知道函数库 library 的重要性，和 include 文件的存在。")]),s._v(" "),t("p",[s._v("很多软件在发展的时候都是直接取用系统核心提供的函数库与 include 文件，尤其是在驱动程序方面的模块，例如网卡、声卡、USB 等驱动程序在安装的时候，常常需要核心提供相关的信息。")]),s._v(" "),t("p",[s._v("在 Red Hat 系统中（包含 Fedora、CentOS 等系列），这个核心相关的功能通常都是被包含在 kernel-source 或 kernel-header 这些软件名称中，所以记得安装这些软件")])])]),s._v(" "),t("p",[s._v("一般来说 Tarball 的安装比较简单，只要顺着开发商提供的 README 与 INSTALL 文件的说明步骤来安装，基本上是很容易的，但是在论坛上还会发现很多人问提示 「没有 gcc 程序」、「无法使用 make」等问题，这些基本上都是以上基础软件没有安装的原因")]),s._v(" "),t("p",[s._v("目前的 Linux distribution 大多已经偏向与桌面计算机的使用（非服务器），所以默认不会安装这些偏向开发的软件，如果你希望未来可以安装一些以 Tarball 方式的软件时，请自行挑选想要安装的软件名称。例如在 CentOS 或死 Red Hat 中，需要选中 Development Tools 以及 Kernel Source Development 等相关字眼的软件群")]),s._v(" "),t("p",[s._v("如果你在安装 Linux 时，没有选择这些软件随机安装，也就是没有 make、gcc 等这些东西，那么可以使用 RPM （下章节讲解）的方式来安装软件，所以只要拿出当初安装 Linux 时的原本光盘，然后以 RPM 来一个一个安装到你的 Linux 主机里面，尤其是现在有 yum ，在线安装更方便了")]),s._v(" "),t("p",[s._v("在 CentOS 中，如果你已经联网的话，那么可以使用下一章会介绍到的 yum，通过 yum 的软件群组安装工功能，可以如下做：")]),s._v(" "),t("ul",[t("li",[s._v("安装 gcc 等软件开放工具："),t("code",[s._v('yum groupinstall "Development Tools"')])]),s._v(" "),t("li",[s._v("若待安装的软件需要图形接口支持，一般还需要："),t("code",[s._v('yum groupinstall "X Software Development"')])]),s._v(" "),t("li",[s._v("若安装的软件较旧，可能需要："),t("code",[s._v('yum groupinstall "Legacy Software Development"')])])]),s._v(" "),t("p",[s._v("详细信息请参考后续章节")]),s._v(" "),t("h2",{attrs:{id:"tarball-安装的基本步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tarball-安装的基本步骤"}},[s._v("#")]),s._v(" Tarball 安装的基本步骤")]),s._v(" "),t("p",[s._v("步骤如下：")]),s._v(" "),t("ol",[t("li",[s._v("取得源码文件：将 tarball 文件在 "),t("code",[s._v("/usr/local/src")]),s._v(" 目录下解压")]),s._v(" "),t("li",[s._v("取得步骤流程：进入新建立的目录下，查阅 INSTALL 或 README 等相关文件内容（很重要）")]),s._v(" "),t("li",[s._v("相依属性软件安装：根据 INSTALL/README 的内容查看并安装好一些相依的软件（非必要）")]),s._v(" "),t("li",[s._v("建立 makefile：用自动检测程序（configure 或 config）检测作业环境，并建立 Makefile 文件")]),s._v(" "),t("li",[s._v("编译：以 make 程序并使用该目录下的 Makefile 作为参考配置文件，进行 make 编译或其他的动作")]),s._v(" "),t("li",[s._v("安装：以 make 程序，并以 Makefile 作为参数配置文件，根据 install 这个目标（target）的指定来安装到正确的路径")])]),s._v(" "),t("p",[s._v("下面简约介绍下大部分的 tarball 软件安装的指令下达方式：")]),s._v(" "),t("ol",[t("li",[t("p",[t("code",[s._v("./configure")])]),s._v(" "),t("p",[s._v("程序开发者提供的一个 scripts 检查程序，并生成 Makefile 文件")])]),s._v(" "),t("li",[t("p",[s._v("make clean")]),s._v(" "),t("p",[s._v("会读取 Makefile 中关于 clean 的工作，该步骤不一定会有，但是希望之星下，因为他可以删除目标文件。至少能保证后续编译出来的 *.o 文件使我们自己机器编译出来的")])]),s._v(" "),t("li",[t("p",[s._v("make")]),s._v(" "),t("p",[s._v("会根据 Makefile 中预设的工作进行编译行为，主要工作是进行 gcc 来将源码编译为可以被执行的 object files。但是这些 object files 通常还需要一些函数库之类的 link 后，才能产生一个完整的执行文件。使用 make 就是将源码便以为可被执行的文件，该执行文件会放到目前所在的目录下，尚未被安装到预定安装的目录中")])]),s._v(" "),t("li",[t("p",[s._v("make install")]),s._v(" "),t("p",[s._v("通常这就是最后的安装步骤了，make 会根据 Makefile 文件里关于 install 的项目，将上一个步骤所编译完成的数据安装到预定的目录中，就安装完成了")])])]),s._v(" "),t("p",[s._v("以上步骤，只要前一个步骤没有成功，那么后续步骤就无法执行成功的。")]),s._v(" "),t("p",[s._v("如果安装成功，并且是安装在独立的一个目录中，例如 "),t("code",[s._v("/usr/local/packages")]),s._v(" 目录中，那么你必须手动的将整个软件的 man page 给它写入到 "),t("code",[s._v("/etc/man_db.conf")])]),s._v(" "),t("h2",{attrs:{id:"一般-tarball-软件安装的建议事项（如何移除？升级？）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一般-tarball-软件安装的建议事项（如何移除？升级？）"}},[s._v("#")]),s._v(" 一般 Tarball 软件安装的建议事项（如何移除？升级？）")]),s._v(" "),t("p",[s._v("为什么前一个章节，Tarball 要在 "),t("code",[s._v("/usr/local/src")]),s._v(" 下解压呢？基本上，在预设的情况下，原本的 Linux distribution 释出安装的软件大多是在 "),t("code",[s._v("/usr")]),s._v(" 中，而用户自行安装的软件则建议放置 "),t("code",[s._v("/usr/local")]),s._v(" 中。这是考虑到管理用户所安装软件的便利性")]),s._v(" "),t("p",[s._v("几乎所有的软件都提供联机帮助服务，就是 info 与 man 功能。在默认情况下，man 会搜索 "),t("code",[s._v("/usr/local/man")]),s._v(" 中的说明文件，因此如果将软件安装在 "),t("code",[s._v("/usr/local")]),s._v(" 下，那么安装完成后，该软件的说明文件就可以被找到了（笔者疑问：可没有说说明文件说明时候被安装到指定目录的？）")]),s._v(" "),t("p",[s._v("所以，通常建议将自己安装的软件放在 "),t("code",[s._v("/usr/local/")]),s._v(" 下，至于源码（Tarball）则建议放到 "),t("code",[s._v("/usr/local/src")]),s._v(" 下")]),s._v(" "),t("p",[s._v("再来看看 Linux distribution 默认的安装软件的路径会用到哪些？这里以 apache 软件来说明：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("/etc/httpd")]),s._v("：配置文件")]),s._v(" "),t("li",[t("code",[s._v("/usr/lib")]),s._v("：函数库")]),s._v(" "),t("li",[t("code",[s._v("/usr/bin")]),s._v("：执行文件")]),s._v(" "),t("li",[t("code",[s._v("/usr/share/man")]),s._v("：联机帮助文件")])]),s._v(" "),t("p",[s._v("会发现软件的内容大致上是放在 etc、lib、bin、man 目录中的。那么通过 tarbal 来安装时，如果是放在预设的 "),t("code",[s._v("/usr/local")]),s._v(" 中，由于 "),t("code",[s._v("/usr/local")]),s._v(" 原本默认这几个目录，所以你的数据就会被放在：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("/usr/local/etc")])]),s._v(" "),t("li",[t("code",[s._v("/usr/local/bin")])]),s._v(" "),t("li",[t("code",[s._v("/usr/local/lib")])]),s._v(" "),t("li",[t("code",[s._v("/usr/local/man")])])]),s._v(" "),t("p",[s._v("如果你每个软件都选择在这个默认的路径下安装的话，那么所有的软件文件都将放在这 4 个目录中，那么未来再想要升级或移除的时候，就会比较难以追查文件的来源，而如果在安装的时候选择的是单独目录，例如我将 apache 安装在 "),t("code",[s._v("/usr/local/apache")]),s._v(" 中，那么你的文件目录就会变成")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("/usr/local/apache/etc")])]),s._v(" "),t("li",[t("code",[s._v("/usr/local/apache/bin")])]),s._v(" "),t("li",[t("code",[s._v("/usr/local/apache/lib")])]),s._v(" "),t("li",[t("code",[s._v("/usr/local/apache/man")])])]),s._v(" "),t("p",[s._v("这样一来，移除软件就简单多了，只要将该目录移除就可以了。")]),s._v(" "),t("p",[s._v("当然，实际安装的时候，还需要看该软件的 Makefile 里 install 信息才能知道它的安装情况。因为例如 sendmail 的安装就很麻烦")]),s._v(" "),t("p",[s._v("此种方式虽然有利于软件的移除，但是在执行指令的时候，该指令是否在 PATH 环境变量所记录的路径有关。以上面的 Apache 软件安装为例，"),t("code",[s._v("/usr/local/apache/bin")]),s._v(" 肯定不在 PATH 里面的，所以执行 apache 的指令，要么使用绝对路径，要么加入到 PATH 中，另外还需要将 "),t("code",[s._v("/usr/local/apache/man")]),s._v(" 也加入到 man page 搜索的路径中")]),s._v(" "),t("p",[s._v("另外，Tarball 在升级的时候也挺困扰，以 apache 来说明，WWW 服务器为了考虑互动性，所以通常会将 "),t("code",[s._v("PHP+MySql+Apache")]),s._v(" 一起安装，那么每个软件在安装的时候都有一定的顺序与程序，因为他们之间具有相关性，所以安装时必须要三者同时考虑到他们的函数库与相关的编译参数")]),s._v(" "),t("p",[s._v("假设今天只要升级 PHP呢？有时候因为只涉及动态函数库的升级，那么只要升级 PHP 即可，其他的部分或许影响不大。但是今天如果 PHP 需要重新编译的模块比较多，那么可能会连带的，连 Apahce 这个程序也需要重新编译过才行。所以使用 tarball 确实有它的优点，但是在这方面也确实麻烦")]),s._v(" "),t("p",[s._v("由于 Tarball 在升级与安装上面具有这些特色，即 Tarball 在反安装上面具有比较高的难度（如果你没有好好规划的话），所以为了方便 Tarball 的管理，通常作者会这样建议使用者：")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("最好将 tarball 的源码数据解压到 "),t("code",[s._v("/usr/local/src")]),s._v(" 中")])]),s._v(" "),t("li",[t("p",[s._v("安装时，最好安装到 "),t("code",[s._v("/usr/local")]),s._v(" 这个默认路径下")])]),s._v(" "),t("li",[t("p",[s._v("考虑未来的反安装步骤，最好可以将每个软件单独的安装在 "),t("code",[s._v("/usr/local")]),s._v(" 下")])]),s._v(" "),t("li",[t("p",[s._v("为安装到单独目录的软件的 man page 加入 man path 搜索")]),s._v(" "),t("p",[s._v("如果你安装的软件在 "),t("code",[s._v("/usr/local/software/")]),s._v(" 那么 man page 搜索设置中，可能需要在 "),t("code",[s._v("/etc/man_db.conf")]),s._v(" 内的 40~50 行左右处，写入如下的一行")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("MANPATH_MAP /usr/local/software/bin /usr/local/software/man\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这样才可以使用 man 来查询该软件的在下文件")])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),t("p",[s._v("时至今日，不太需要有 tarball 的安装了。 CentOS/Fedora 有个 RPM 补遗计划，就是俗称的 EPEL 计划，相关说明请参考 "),t("a",{attrs:{href:"https://fedoraproject.org/wiki/EPEL",target:"_blank",rel:"noopener noreferrer"}},[s._v("EPEL"),t("OutboundLink")],1),s._v(" ，一般学界用到的软件都在里面，除非你要用的软件是专属收费软件，或则是比较冷门的软件，否则都有好心的网友帮我妈打包好了")])]),s._v(" "),t("h2",{attrs:{id:"一个简单的范例，利用-ntp-来示范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一个简单的范例，利用-ntp-来示范"}},[s._v("#")]),s._v(" 一个简单的范例，利用 ntp 来示范")]),s._v(" "),t("p",[s._v("这里用时间服务器 ntp（network time protocol）软件来测试安装。下载网址请在此 "),t("a",{attrs:{href:"http://www.ntp.org/downloads.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("网页中找到下载包链接"),t("OutboundLink")],1),s._v(" ，本次使用 "),t("code",[s._v("http://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ntp-4.2/ntp-4.2.8p14.tar.gz")]),s._v(" 这个版本。")]),s._v(" "),t("p",[s._v("假设我对这个软件的要求如下：")]),s._v(" "),t("ul",[t("li",[s._v("假设 "),t("code",[s._v("ntp4.*.*.tar.gz")]),s._v(" 文件放到 "),t("code",[s._v("/root")]),s._v(" 目录下")]),s._v(" "),t("li",[s._v("源码解压在 "),t("code",[s._v("/usr/local/src")]),s._v(" 下")]),s._v(" "),t("li",[s._v("安装到 "),t("code",[s._v("/usr/local/ntp")]),s._v(" 目录中")])]),s._v(" "),t("p",[s._v("​")]),s._v(" "),t("p",[s._v("解压文件，并阅读 README/INSTALL 文件")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /usr/local/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study local"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar -zxv -f /root/ntp-4.2.8p14.tar.gz")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study local"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd ntp-4.2.8p14/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ntp-4.2.8p14"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi INSTALL")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看安装说明，使用 set nu 显示行号")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 然后阅读 28 ~ 54 行的安装步骤，大约就是如下的内容")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" The simplest way to compile this package is:\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' to the directory containing the package'")]),s._v("s "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" code and "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("./configure"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' to configure the package for your system.  If you'")]),s._v("re\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("      using "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("csh' on an old version of System V, you might need to "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" ./configure"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' instead to prevent "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("csh' from trying to execute\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("configure'")]),s._v(" itself.\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("35")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("36")]),s._v("      Running "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("configure' takes a while.  While running, it prints some\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("37")]),s._v("      messages telling "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" features it is checking for.\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("38")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". Type "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' to compile the package.\n   40 \n   41   3. Optionally, type "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" check' to run any self-tests that come with\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("42")]),s._v("      the package.\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("43")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(". Type "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("make install'")]),s._v(" to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" the programs and any data files and\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v("      documentation.\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("46")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(". You can remove the program binaries and object files from the\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" code directory by typing "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" clean'.  To also remove the\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("49")]),s._v("      files that "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("configure"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' created (so you can compile the package for\n   50      a different kind of computer), type "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" distclean'.  There is\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("51")]),s._v("      also a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("make maintainer-clean'")]),s._v(" target, but that is intended mainly\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("52")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the package's developers.  If you use it, you may have to get\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v("      all sorts of other programs "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" order to regenerate files that came\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("54")]),s._v("      with the distribution.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br")])]),t("p",[s._v("检查 configure 支持的参数，并实际建立 makefile 规则文件")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ntp-4.2.8p14"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./configure --help | more")]),s._v("\n`configure' configures ntp "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.2")]),s._v(".8p14 to adapt to many kinds of systems.\n\nUsage: ./configure "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTION"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("VAR"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("VALUE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\nTo assign environment variables "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e.g., CC, CFLAGS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", specify them as\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VAR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("VALUE.  See below "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" descriptions of some of the useful variables.\n有很多参数，下面列出来比较重要的选项\n--prefix"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("PREFIX         "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" architecture-independent files "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" PREFIX\n                          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("/usr/local"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n--enable-all-clocks     + include all suitable non-PARSE clocks:\n--enable-parse-clocks   - include all suitable PARSE clocks:\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ntp-4.2.8p14"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./configure --prefix=/usr/local/ntp --enable-all-clocks --enable-parse-clocks")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nchecking "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" gcc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("gcc\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 找到了 gcc 编译程序")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nconfigure: creating ./config.status\nconfig.status: creating libevent.pc\nconfig.status: creating libevent_openssl.pc\nconfig.status: creating libevent_pthreads.pc\nconfig.status: creating Makefile\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建了一个 Makefile")]),s._v("\nconfig.status: creating config.h\nconfig.status: creating evconfig-private.h\nconfig.status: evconfig-private.h is unchanged\nconfig.status: executing depfiles commands\nconfig.status: executing libtool commands\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("p",[s._v("一般来说 configure 设置参数比较重要的就是 "),t("code",[s._v("--prefix=PREFIX")]),s._v("了，后面指定了该软件未来要安装到的目录")]),s._v(" "),t("p",[s._v("最后开始编译与安装")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ntp-4.2.8p14"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make clean; make")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ntp-4.2.8p14"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make check")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\nTestsuite summary "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" ntp "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.2")]),s._v(".8p14\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TOTAL: 1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# PASS:  1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# SKIP:  0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# XFAIL: 0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# FAIL:  0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# XPASS: 0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ERROR: 0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过 check 后，会列出一个清单结果，这里是表示都成功了")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ntp-4.2.8p14"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make install")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装成功后，就可以看到 ntp 目录下安装好的文件了")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ntp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /usr/local/ntp")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ntp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("189")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 03:49 bin\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 03:49 libexec\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 03:49 sbin\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" root root  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 03:49 share\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("h2",{attrs:{id:"利用-patch-更新源码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#利用-patch-更新源码"}},[s._v("#")]),s._v(" 利用 patch 更新源码")]),s._v(" "),t("p",[s._v("所谓更新源码，通常是某一段代码有问题，因此通常只是更新部分文件的小部分内容。")]),s._v(" "),t("p",[s._v("好处则是：没有变动的文件的目标文件（object file）不需要重新编译，变动过的文件可以利用 make 来自动 update，如此一来，原先的设置（makefile 文件里面的规则）将不需要重新改写或检测，可以节省很多的宝贵时间")]),s._v(" "),t("p",[s._v("可以用 diff 指令将两个文件的差异性列出来，再以相关的指令来将旧版的文件更新，这是可以的，通常很多软件开发商在更新了源码之后，几乎都会放出所谓的 patch file，也就是直接将源码 update 的一个方式，使用 patch 指令来完成。")]),s._v(" "),t("p",[s._v("关于 diff 与 patch 的基本用法在第 11 章已经讲过了。下面通过一个简单的例子来讲解；之前章节的计算函数的例子，相关文件如下")]),s._v(" "),t("h3",{attrs:{id:"main-0-1-版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#main-0-1-版本"}},[s._v("#")]),s._v(" main-0.1 版本")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study main-0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\n-rw-r--r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("184")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 04:01 cos_value.c\n-rw-r--r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 04:01 haha.c\n-rw-r--r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("291")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 04:01 main.c\n-rw-r--r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("142")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 04:02 Makefile\n-rw-r--r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("186")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 04:02 sin_value.c\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("注意：以下文件，可能是由于复制过程中的编码问题，会导致部分与 patch 中的文件内容不一致，从而导致 patch 过程失败，请直接下载以下链接中的包，并解压到 "),t("code",[s._v("/root/")]),s._v(" 下")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("wget http://linux.vbird.org/linux_basic/0520source/main-0.1.tgz")])]),s._v(" "),t("li",[t("p",[s._v("wget http://linux.vbird.org/linux_basic/0520source/main_0.1_to_0.2.patch")]),s._v(" "),t("p",[s._v("下载后，修改文件名为 "),t("code",[s._v("main-0.1-to-0.2.patch")])])])]),s._v(" "),t("p",[t("code",[s._v("main.c")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#include <stdio.h>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#define pi 3.14159")]),s._v("\nchar name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nfloat angle"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nint main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("void"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('version 0.1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('Please input your name: "')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\tscanf  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%s"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('Please enter the degree angle (ex> 90): "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\tscanf  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%f"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("angle "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\thaha"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\tsin_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" angle "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\tcos_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" angle "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[t("code",[s._v("haha.c")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#include <stdio.h>")]),s._v("\nint haha"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("char name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('Hi, Dear %s, nice to meet you."')]),s._v(", name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[t("code",[s._v("sin_value.c")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#include <stdio.h>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#include <math.h>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#define pi 3.14159")]),s._v("\nfloat angle"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nvoid sin_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("void"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        float value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" angle / "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("180")]),s._v(". * pi "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("The sin(%f) is: %5.2f"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(",angle, value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[t("code",[s._v("cos_value.c")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#include <stdio.h>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#include <math.h>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#define pi 3.14159")]),s._v("\nfloat angle"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nvoid cos_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("void"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tfloat value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\tvalue "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cos "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" angle / "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("180")]),s._v(". * pi "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The Cos is: %5.2f'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(",value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[t("code",[s._v("Makefile")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This make file is a test rule file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # Version 0.1 2009/06/06")]),s._v("\nLIBS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" -lm\nOBJS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" main.o haha.o sin_value.o cos_value.o\nmain: "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${OBJS}")]),s._v("\n        gcc -o main "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${OBJS}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${LIBS}")]),s._v("\nclean:\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f main "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${OBJS}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("记得调整上面使用 tab 的语法部分")]),s._v(" "),t("h3",{attrs:{id:"由-0-1-升级到-0-2-的-patch-file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#由-0-1-升级到-0-2-的-patch-file"}},[s._v("#")]),s._v(" 由 0.1 升级到 0.2 的 patch file")]),s._v(" "),t("p",[t("code",[s._v("main-0.1-to-0.2.patch")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v(" -Naur main-0.1/cos_value.c main-0.2/cos_value.c\n--- main-0.1/cos_value.c\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2015")]),s._v("-09-04 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":46:59.200444001 +0800\n+++ main-0.2/cos_value.c\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2015")]),s._v("-09-04 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":47:10.215444000 +0800\n@@ -7,5 +7,5 @@\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n \tfloat value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \tvalue "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cos "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" angle / "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("180")]),s._v(". * pi "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n-\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The Cos is: %5.2f'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(",value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The cos(%f) is: %5.2f'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(",angle, value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v(" -Naur main-0.1/main.c main-0.2/main.c\n--- main-0.1/main.c\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2009")]),s._v("-06-12 00:39:38.000000000 +0800\n+++ main-0.2/main.c\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2009")]),s._v("-06-12 00:45:38.000000000 +0800\n@@ -5,7 +5,7 @@\n \n int main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("void"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n-\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('version 0.1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('version 0.2"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('Please input your name: "')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \tscanf  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%s"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('Please enter the degree angle (ex> 90): "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v(" -Naur main-0.1/Makefile main-0.2/Makefile\n--- main-0.1/Makefile\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2009")]),s._v("-06-12 00:34:53.000000000 +0800\n+++ main-0.2/Makefile\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2009")]),s._v("-06-12 00:42:39.000000000 +0800\n@@ -1,8 +1,12 @@\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This make file is a test rule file")]),s._v("\n-"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Version 0.1 2009/06/06")]),s._v("\n+"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Version 0.2 2009/06/11")]),s._v("\n LIBS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" -lm\n OBJS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" main.o haha.o sin_value.o cos_value.o\n main: "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${OBJS}")]),s._v("\n \tgcc -o main "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${OBJS}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${LIBS}")]),s._v("\n clean:\n \t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f main "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${OBJS}")]),s._v("\n+install:\n+\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -a main /usr/local/bin\n+uninstall:\n+\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f /usr/local/bin/main\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v(" -Naur main-0.1/sin_value.c main-0.2/sin_value.c\n--- main-0.1/sin_value.c\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2015")]),s._v("-09-04 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":46:52.286444001 +0800\n+++ main-0.2/sin_value.c\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2015")]),s._v("-09-04 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":47:17.665444020 +0800\n@@ -7,5 +7,5 @@\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n \tfloat value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \tvalue "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" angle / "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("180")]),s._v(". * pi "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n-\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("The Sin is: %5.2f"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(",value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("printf")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v("The sin(%f) is: %5.2f"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(",angle, value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br")])]),t("p",[s._v("把这目录和文件放到 root 目录下")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("drwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root   root         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 04:11 main-0.1\n-rw-r--r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root   root       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1538")]),s._v(" Apr  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" 04:11 main-0.1-to-0.2.patch\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("在 0.1 版本中，有 main 与 clean 两个目标功能。而 0.2 版本则增加了 install 与 uninstall 的规则与设置。下面来进行升级")]),s._v(" "),t("h3",{attrs:{id:"测试旧版程序的功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试旧版程序的功能"}},[s._v("#")]),s._v(" 测试旧版程序的功能")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study main-0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make clean main   ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f main main.o haha.o sin_value.o cos_value.o\ncc    -c -o main.o main.c\ncc    -c -o haha.o haha.c\ncc    -c -o sin_value.o sin_value.c\ncc    -c -o cos_value.o cos_value.c\ngcc -o main main.o haha.o sin_value.o cos_value.o -lm\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study main-0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./main ")]),s._v("\n\nversion "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("\n\nPlease input your name: mrcode\n\nPlease enter the degree angle "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ex"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v("\n\n\nHi, Dear mrcode, "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nice")]),s._v(" to meet you.\nThe Sin is:  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.71")]),s._v("\nThe Cos is:  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.71")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("p",[s._v("与之前的结果类似，但是如果你下达 make install 时，系统会告知没有 install 的 target，如何更新到 0.2 版本呢？")]),s._v(" "),t("h3",{attrs:{id:"查阅-patch-file-内容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查阅-patch-file-内容"}},[s._v("#")]),s._v(" 查阅 patch file 内容")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim main-0.1-to-0.2.patch ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v(" -Naur main-0.1/cos_value.c main-0.2/cos_value.c\n--- main-0.1/cos_value.c\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2015")]),s._v("-09-04 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":46:59.200444001 +0800\n+++ main-0.2/cos_value.c\t"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2015")]),s._v("-09-04 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":47:10.215444000 +0800\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("code",[s._v("diff -Naur main-0.1/cos_value.c main-0.2/cos_value.c")])]),s._v(" "),t("p",[s._v("表示使用 diff 去比较时，比较的两个文件路径，该路径非常重要，因为 patch 的基本语法如下")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("patch -p 数字 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" patch_file\n\n-p： 与 patch_file 里列出的文件名有关的信息。假如 patch_file 里面累出的文件名有关的信息，假如第一行是写的 "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("*** /home/guest/example/expatch.old"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\n那么当下达 patch -p0 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" patch_file 时，更新的文件是 /home/guest/example/expatch.old,\n如果下达  patch -p1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" patch_file 时，更的文件是 home/guest/example/expatch.old\n如果下达  patch -p4 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" patch_file 时，更新的是 expatch.old\n也就是说 -pxx xx 表示是拿掉几个斜线的意思\n\n那么上面比较的文件是在 main-0.1/xxx 与 main-0.2/xxx 所以，如果你是在 main-0.1 下，并且想要处理更新时，就需要拿掉一个目录，因为并没有 main-0.2 的存在，我们是在当前的目录进行更新的，因此需要使用 -p1 才对\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h3",{attrs:{id:"更新源码，并重新编译程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新源码，并重新编译程序"}},[s._v("#")]),s._v(" 更新源码，并重新编译程序")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study main-0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# patch -p1 < ../main-0.1-to-0.2.patch ")]),s._v("\npatching "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" cos_value.c\npatching "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" main.c\npatching "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" Makefile\npatching "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" sin_value.c\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 请注意，目前所在的目录在 main-0.1 ，注意与 patch 文件的相对路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 虽然有 5 个文件，但是只有 4 个文件有修改过，上面显示有修改过的文件")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study main-0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make clean main")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f main main.o haha.o sin_value.o cos_value.o\ncc    -c -o main.o main.c\ncc    -c -o haha.o haha.c\ncc    -c -o sin_value.o sin_value.c\ncc    -c -o cos_value.o cos_value.c\ngcc -o main main.o haha.o sin_value.o cos_value.o -lm\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study main-0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./main ")]),s._v("\n\nversion "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),s._v("\n\nPlease input your name: mrcode\n\nPlease enter the degree angle "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ex"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v("\n\n\nHi, Dear mrcode, "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nice")]),s._v(" to meet you.\nThe sin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45.000000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" is:  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.71")]),s._v("\nThe cos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45.000000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" is:  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.71")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study main-0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make install")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -a main /usr/local/bin\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到，把执行程序复制到了 bin 下，所以就可以不加绝对路径运行了")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study main-0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# main")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study main-0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make uninstall")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f /usr/local/bin/main\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br")])]),t("p",[s._v("这个就是利用了 diff 和 patch 指令来完成的源码更新，然后重新编译安装的效果和流程。")]),s._v(" "),t("p",[s._v("如果你 patch 错误呢？可以通过 "),t("code",[s._v("patch -R < ../main-0.1-to-0.2.patch")]),s._v(" 将已经更新过的还原。（笔者在复制笔记上的文件到虚拟机文件的时候，不知道哪里有问题，导致前 4 个文件可以 patch 成功，但是第 4 个文件显示失败，这种情况下，就可以通过这样的指令还原回去）")]),s._v(" "),t("p",[s._v("一个问题：如果有一个很旧版本的软件，该软件已经更新到最新版本，例如核心，我可以使用 patch file 来更新吗？")]),s._v(" "),t("p",[s._v("答：首先要确认有释放出 patch file 才行，以 kernel 2.2.xx 与 2.4.xx 来说，基本上的架构已经不同了，所以两者无法以 patch file 来更新的。不过 2.4.xx 与 2.4.yy 就可以。不过，因为 kernel 每次推出的 patch 文件都是针对前一个版本而已，假设你的内核是 kernel 2.4.20 要升级大 2.5.26，那么中间有 5 个文件，需要按顺序更新才可以。但是如果有朋友帮你对比过 2.4.20 与 2.4.26，那么你直接使用该 patch file 来直接一次更新也可以")])])}),[],!1,null,null,null);a.default=e.exports}}]);