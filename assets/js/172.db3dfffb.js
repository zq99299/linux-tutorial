(window.webpackJsonp=window.webpackJsonp||[]).push([[172],{689:function(s,t,n){"use strict";n.r(t);var a=n(16),r=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"srpm-的使用：rpmbuild"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#srpm-的使用：rpmbuild"}},[s._v("#")]),s._v(" SRPM 的使用：rpmbuild")]),s._v(" "),n("p",[s._v("注意：默认为安装该软件，可通过 "),n("code",[s._v("yum install rpm-build")]),s._v(" 安装")]),s._v(" "),n("p",[s._v("假如你有一个 SRPM 的文件，如何安装？如何修改 SPRM 里面的源码？如何重新编译？")]),s._v(" "),n("h2",{attrs:{id:"利用默认值安装-srpm-文件-rebuild-recompile"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#利用默认值安装-srpm-文件-rebuild-recompile"}},[s._v("#")]),s._v(" 利用默认值安装 SRPM 文件 ("),n("code",[s._v("--rebuild/--recompile")]),s._v(")")]),s._v(" "),n("p",[s._v("假如你有一个 SRPM 文件，不想修改里面的源码文件，可以直接编译安装")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("rpmbuild --rebuild xx.src.rpm\nrpmbuild --recompile xx.src.rpm\n\n主要选项有：\n\t--rebuild：仅执行「编译」与「打包」动作\n\t--recompile：执行「编译」「打包」「安装」动作\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("以上两个选项都没有修改过 SRPM 内的设置，仅通过再次编译来产生 RPM 可安装软件文件。一般来说，如果编译顺利的话，那么编译过程所产生的中间暂存盘会被自动删除，如果发生任何错误，则中间文件会被保留在系统上，以供我们除错使用")]),s._v(" "),n("p",[s._v("这里用 ntp 软件的 SRPM 来练习。在  "),n("a",{attrs:{href:"http://vault.centos.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("vault.centos.org"),n("OutboundLink")],1),s._v(" 中选择你正确的 CentOS 版本，然后在 updates 软件看中选择 ntp 软件 SRPM，我这里选择了 http://vault.centos.org/7.0.1406/updates/Source/SPackages/ntp-4.2.6p5-19.el7.centos.src.rpm 的软件下载")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载软件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://vault.centos.org/7.0.1406/updates/Source/SPackages/ntp-4.2.6p5-19.el7.centos.src.rpm\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 尝试直接编译")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpmbuild --rebuild /root/ntp-4.2.6p5-19.el7.centos.src.rpm ")]),s._v("\nwarning: user mockbuild does not exist - using root\nwarning: group mockbuild does not exist - using root\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nerror: Failed build dependencies:\n        libcap-devel is needed by ntp-4.2.6p5-19.el7.x86_64\n        openssl-devel is needed by ntp-4.2.6p5-19.el7.x86_64\n        libedit-devel is needed by ntp-4.2.6p5-19.el7.x86_64\n        pps-tools-devel is needed by ntp-4.2.6p5-19.el7.x86_64\n        autogen is needed by ntp-4.2.6p5-19.el7.x86_64\n        autogen-libopts-devel is needed by ntp-4.2.6p5-19.el7.x86_64\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 会告诉你有相依赖的软件未安装，")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install libcap-devel openssl-devel libedit-devel pps-tools-devel autogen autogen-libopts-devel")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再次尝试编译")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpmbuild --rebuild /root/ntp-4.2.6p5-19.el7.centos.src.rpm ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 会经过一段漫长的时间进行编译")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nChecking "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" unpackaged file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": /usr/lib/rpm/check-files /root/rpmbuild/BUILDROOT/ntp-4.2.6p5-19.el7.centos.x86_64\nWrote: /root/rpmbuild/RPMS/x86_64/ntp-4.2.6p5-19.el7.x86_64.rpm\nWrote: /root/rpmbuild/RPMS/noarch/ntp-perl-4.2.6p5-19.el7.noarch.rpm\nWrote: /root/rpmbuild/RPMS/x86_64/ntpdate-4.2.6p5-19.el7.x86_64.rpm\nWrote: /root/rpmbuild/RPMS/x86_64/sntp-4.2.6p5-19.el7.x86_64.rpm\nWrote: /root/rpmbuild/RPMS/noarch/ntp-doc-4.2.6p5-19.el7.noarch.rpm\nWrote: /root/rpmbuild/RPMS/x86_64/ntp-debuginfo-4.2.6p5-19.el7.x86_64.rpm\nExecuting"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("%clean"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": /bin/sh -e /var/tmp/rpm-tmp.8JAsU0\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("umask")]),s._v(" 022\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/rpmbuild/BUILD\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ntp-4.2.6p5\n+ /usr/bin/rm -rf /root/rpmbuild/BUILDROOT/ntp-4.2.6p5-19.el7.centos.x86_64\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nExecuting"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("--clean"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": /bin/sh -e /var/tmp/rpm-tmp.Zz7sN6\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("umask")]),s._v(" 022\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/rpmbuild/BUILD\n+ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf ntp-4.2.6p5\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到上面输出了很多执行脚本和日志，包括输出到的目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译好的软件就会放置到")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study rpmbuild"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /root/rpmbuild/RPMS/x86_64/")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2420")]),s._v("\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("552196")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":27 ntp-4.2.6p5-19.el7.x86_64.rpm\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1757652")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":27 ntp-debuginfo-4.2.6p5-19.el7.x86_64.rpm\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("83060")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":27 ntpdate-4.2.6p5-19.el7.x86_64.rpm\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("75392")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":27 sntp-4.2.6p5-19.el7.x86_64.rpm\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br")])]),n("p",[s._v("这种方式，一般来说，因为该编译可能会根据你的系统硬件而优化，所以可能效果会好一点点，但是，人类可能感受不到这种优化带来的效果，所以一般不建议使用 SRPM 安装。那么当你找不到你这个 distribution 版本的软件时间，去别的 distribution 下载 SRPM 来安装，这样也算个方向。")]),s._v(" "),n("p",[s._v("一般来说，如果你有需要用到 SRPM 的文件，大部分的原因就是，你需要重新修改里面的某些设置，比如加入某些特殊的功能等。此时就需要将 SRPM 拆开，编辑里面的配置文件，再重新编译。下面来练习这种方式")]),s._v(" "),n("h2",{attrs:{id:"srpm-使用的路径与需要的软件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#srpm-使用的路径与需要的软件"}},[s._v("#")]),s._v(" SRPM 使用的路径与需要的软件")]),s._v(" "),n("p",[s._v("SRPM 含有 source code，那么其中必定有配置文件，所以需要知道 SRPM 在进行编译的时候会用到哪些目录？由于每个用户应该都有能力安装自己的软件，因此 SRPM 安装、设置、编译、最终结果所使用的目录与操作者家目录有关系。比如，你使用 root 的身份来进行 SRPM 的操作，那么应该会用到下列的目录")]),s._v(" "),n("ul",[n("li",[n("p",[n("code",[s._v("/root/rpmbuild/SPECS/")]),s._v("：该软件的配置文件，例如软件的信息参数、设置项目等")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("/root/rpmbuild/SOURCES/")]),s._v("：软件的原始文件（"),n("code",[s._v("*.tar.gz 的文件")]),s._v("） 以及 config 配置文件")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("/root/rpmbuild/BUILD")]),s._v("/：在编译过程中，有些暂存的数据都会放置在该目录中")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("/root/rpmbuild/RPMS/")]),s._v("：经过编译之后，并且顺利编译成功之后，将打包完成的文件放在该目录中，包含了 x86_64，noarch... 等的次要目录")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("/root/rpmbuild/SRPMS/")]),s._v("：与 RPMS 目录相似，放置的是 SRPM 封装的文件")])])]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),n("p",[s._v("以前只有 root 身份才能使用编译行为，同时源码都会放到 "),n("code",[s._v("/usr/src/redhat/")]),s._v("，如今放置在 "),n("code",[s._v("/~username/rpmbuild/")]),s._v(" 目录下")])]),s._v(" "),n("p",[s._v("如果在编译过程中发生不明错误，会再 "),n("code",[s._v("/tmp")]),s._v(" 下产生一个相对应的错误文件，可以根据该错误文件进行除错工作。如果编译成功，那么刚刚解压在上述几个目录中的文件都会被清理掉，只剩下"),n("code",[s._v("/root/rpmbuild/SRPMS/")]),s._v(" 中编译好的文件了")]),s._v(" "),n("p",[s._v("由于 SRPM 需要重新编译，所以我们需要 "),n("RouterLink",{attrs:{to:"/tutorial-basis/21/04.html"}},[s._v("第 21 章中源码所需基础软件")]),s._v(" ，不要忘记安装")],1),s._v(" "),n("p",[s._v("实践练习：将上个练习下载的 ntp 的 SRPM 软件直接安装到系统中（不要先编译），然后查阅下所有用到的目录有哪些")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 这里使用 root 身份进行安装")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpm -ivh ntp-4.2.6p5-19.el7.centos.src.rpm ")]),s._v("\nUpdating / installing"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":ntp-4.2.6p5-19.el7.centos        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("################################# [100%]")]),s._v("\nwarning: user mockbuild does not exist - using root\nwarning: group mockbuild does not exist - using root\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里的操作，之后，就直接被安装了，可以找到如下的说明，但是和上面的对不上")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 所以笔者这里有点疑惑，到底安装没有？")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SPECS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpm -qa | grep ntp")]),s._v("\nntpdate-4.2.6p5-29.el7.centos.x86_64\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 查询 /root/rpmbuild 目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -l /root/rpmbuild/")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\ndrwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":27 BUILD\ndrwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":27 BUILDROOT\ndrwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root root   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":27 RPMS\ndrwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":32 SOURCES\ndrwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":32 SPECS    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 它最重要")]),s._v("\ndrwxr-xr-x. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root root    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":24 SRPMS\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -l /root/rpmbuild/{SOURCES,SPECS}")]),s._v("\n/root/rpmbuild/SOURCES:\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4324")]),s._v("\n-rw-rw-r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("559")]),s._v(" Dec "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v(" ntp-4.2.4p7-getprecision.patch\n-rw-rw-r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("661")]),s._v(" Dec "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v(" ntp-4.2.6p1-cmsgalign.patch\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n/root/rpmbuild/SPECS:\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),s._v("\n-rw-rw-r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("41210")]),s._v(" Dec "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v(" ntp.spec\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 该文件是重点")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("h3",{attrs:{id:"配置文件的主要内容-spec"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置文件的主要内容-spec"}},[s._v("#")]),s._v(" 配置文件的主要内容 "),n("code",[s._v("*.spec")])]),s._v(" "),n("p",[s._v("前一个小节的练习，我们知道在 "),n("code",[s._v("/root.rembuild/SOURCES")]),s._v(" 会放置原始文件 （tarball）以及相关的补丁文件（patch file），我们也知道编译需要的步骤大致是 "),n("code",[s._v("./configure,make,make check,make install")]),s._v(" 等，那这些动作就写在 SPECS 目录中的")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /root/rpmbuild/SPECS/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 这个部分在介绍整个软件的基本相关信息，版本，释出次数等")]),s._v("\n\nSummary: The NTP daemon and utilities\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建议说明这个软件的功能")]),s._v("\nName: ntp\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 软件名称")]),s._v("\nVersion: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.2")]),s._v(".6p5\t\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 软件版本")]),s._v("\nRelease: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("?dist"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 软件的释出次数")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# primary license (COPYRIGHT) : MIT\t\t\t# 下面又很多 # 批注说明")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\nLicense: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MIT and BSD and BSD with advertising"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" and GPLv2\nGroup: System Environment/Daemons\nSource0: http://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ntp-4.2/ntp-%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(".tar.gz\nSource1: ntp.conf\t\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 写 SourceN 的就是源码文件")]),s._v("\nSource2: ntp.keys\t\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 源码与多个")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ntpbz #802\t\t\t\t\t\t\t\t\t\t\t\t\t\t# 下面是不定文件，就是 PatchN")]),s._v("\nPatch1: ntp-4.2.6p1-sleep.patch\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# add support for dropping root to ntpdate")]),s._v("\nPatch2: ntp-4.2.6p4-droproot.patch\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 这部分则是设置相依属性需求的地方")]),s._v("\n\nURL: http://www.ntp.org\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下面说明这个软件的相依性")]),s._v("\nRequires"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("post"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": systemd-units\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 还有编译过程需要哪些软件等")]),s._v("\nRequires"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("preun"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": systemd-units\nRequires"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("postun"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": systemd-units\nRequires: ntpdate "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" %"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("-%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("release"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nBuildRequires: libcap-devel openssl-devel libedit-devel perl-HTML-Parser\nBuildRequires: pps-tools-devel autogen autogen-libopts-devel systemd-units\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n%package -n ntpdate\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 该软件包还包含很多次软件")]),s._v("\nSummary: Utility to "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" the "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" and "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" via NTP\nGroup: Applications/System\nRequires"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pre"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": shadow-utils\nRequires"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("post"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": systemd-units\nRequires"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("preun"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": systemd-units\nRequires"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("postun"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": systemd-units\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 编译前的预处理，以及编译过程中所需要进行的指令，都写在这里")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 尤其是 %build 下的数据，几乎就是 makefile 里面的信息")]),s._v("\n\n%prep\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这部分大部分在处理补丁")]),s._v("\n%setup -q -a "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n\n%patch1 -p1 -b .sleep\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这些 patch 与前面的 PatchN 有关")]),s._v("\n%patch2 -p1 -b .droproot\n%patch3 -p1 -b .bcast\n%patch4 -p1 -b .cmsgalign\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n\n%build\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 其实就是 ./configure、make 等动作")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s|"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CFLAGS")]),s._v(" -Wstrict-overflow|"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CFLAGS")]),s._v("|'")]),s._v(" configure sntp/configure\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CFLAGS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$RPM_OPT_FLAGS")]),s._v(' -fPIE -fno-strict-aliasing -fno-strict-overflow"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LDFLAGS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-pie -Wl,-z,relro,-z,now"')]),s._v("\n%configure "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\t\t\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./configure 的意思")]),s._v("\n        --sysconfdir"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_sysconfdir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/ntp/crypto "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        --with-openssl-libdir"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_libdir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        --without-ntpsnmpd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        --enable-all-clocks --enable-parse-clocks "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        --enable-ntp-signd"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_localstatedir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/run/ntp_signd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        --disable-local-libopts\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#define KEYFILE \"%{_sysconfdir}/ntp/keys\"'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ntpdate/ntpdate.h\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#define NTP_VAR \"%{_localstatedir}/log/ntpstats/\"'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" config.h\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" %"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("?_smp_mflags"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make 的意思")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n%install\t\t\t\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装过程中所进行的各项动作了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DESTDIR")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$RPM_BUILD_ROOT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bindir")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_sbindir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$RPM_BUILD_ROOT")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_mandir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/man"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5,8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/sntp\\.1/sntp\\.8/'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$RPM_BUILD_ROOT")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_mandir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/man1/sntp.1\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$RPM_BUILD_ROOT")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_mandir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/man"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/sntp.1,8/sntp.8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$RPM_BUILD_ROOT")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_mandir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/man1\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4. 这里列出，这个软件释出的文件有哪些的意思")]),s._v("\n\n%files\t\t\t\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这软件所属的文件有哪些")]),s._v("\n%dir %"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("ntpdocdir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("ntpdocdir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/COPYRIGHT\n%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("ntpdocdir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/ChangeLog\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5. 列出这个软件的更改历史记录文件")]),s._v("\n\n%changelog\n* Fri Dec "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v(" CentOS Sources "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("bugs@centos.org"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.2")]),s._v(".6p5-19.el7.centos\n- rebrand vendorzone\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br")])]),n("p",[s._v("要注意到的是 ntp.sepc 这个文件，这是主要的将 SRPM 编译成 RPM 的配置文件，它的基本规则可以这样看：")]),s._v(" "),n("ol",[n("li",[s._v("整个文件的开头有 Summary 为开始，这部分的设置都是最基础的说明内容")]),s._v(" "),n("li",[s._v("然后每个不同的段落之间，都以 "),n("code",[s._v("%")]),s._v(" 来做开头，例如 "),n("code",[s._v("%prep")]),s._v(" 与 "),n("code",[s._v("%install")]),s._v(" 等")])]),s._v(" "),n("h3",{attrs:{id:"系统整体信息方面"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#系统整体信息方面"}},[s._v("#")]),s._v(" 系统整体信息方面")]),s._v(" "),n("p",[s._v("刚刚在 ntp.sepc 中看到的就有以下的重要信息：")]),s._v(" "),n("ul",[n("li",[s._v("Summary：软件的主要说明，例如上表中说明了本软件是针对 NTP 的软件功能与工具等")]),s._v(" "),n("li",[s._v("Name：软件的名称（最终会是 RPM 文件的名称构成之一）")]),s._v(" "),n("li",[s._v("Version：软件的版本（也是 RPM 文件名构成之一）")]),s._v(" "),n("li",[s._v("Release：该版本打包的次数说明（也是 RPM 文件名构成之一）。由于我们想要修改下东西，所以将这里的 "),n("code",[s._v("19%{?dist}")]),s._v(" 修改为 "),n("code",[s._v("20.mrcode")])]),s._v(" "),n("li",[s._v("License：软件的授权模式，看起来涵盖了所有知名的 Open source 授权")]),s._v(" "),n("li",[s._v("Group：该软件在安装的时候，主要放置到哪一个软件群组中（yum grouplist 的特点）")]),s._v(" "),n("li",[s._v("URL：源码的主要官网")]),s._v(" "),n("li",[s._v("SourceN：软件的来源，如果是网络上下载的软件，通常这里一定会有这个信息来告诉大家这个原始文件的来源，此外，如果有多个软件来源，则会以 Source0、Source1... 开处理源码")]),s._v(" "),n("li",[s._v("PatchN：作为不定的 patch file，也是可以有多个")]),s._v(" "),n("li",[s._v("BuildRoot：作为编译时，该使用哪个目录来暂存中间文件（如果编译过程的目标文件、链接文件等）")])]),s._v(" "),n("p",[s._v("上述信息为必须存在的项目，下面的则为可使用的额外设置")]),s._v(" "),n("ul",[n("li",[s._v("Requires：如果这个软件还需要其他的软件支持，就必须配置，则当你制作成 RPM 后，系统就会自动去检查，这就是相依属性的主要来源")]),s._v(" "),n("li",[s._v("BuildRequires：编译过程中所需要的软件。Requires 指的是"),n("strong",[s._v("安装时需要检查")]),s._v("，因为与实际运行有关，而 BuildRequires 则是 "),n("strong",[s._v("编译时")]),s._v(" 所需要的软件，只有在 SRPM 编译为 RPM 时才会检查的项目")])]),s._v(" "),n("p",[s._v("根据上面的设置，最终的文件名会是 "),n("code",[s._v("{Name}-{Version}-{Release}.{Arch}.rpm")]),s._v(" 的样式，以我们上面的设置来说，文件名应该会是 "),n("code",[s._v("ntp-4.2.6p5-20.mrcode.x86_64.rpm")])]),s._v(" "),n("ul",[n("li",[n("p",[n("code",[s._v("%description")])]),s._v(" "),n("p",[s._v("将你的软件做一个简短的说明，这个也是必须的，在使用 "),n("code",[s._v("rpm -qi 软件名称")]),s._v(" 出现的一些基础说明就包括这里的设置信息")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("%prep")])]),s._v(" "),n("p",[s._v("pre 这个关键词本就有「在...之前」的含义，因此该项目指「尚未进行设置或安装之前，你要编译完成的 RPM 帮你实现做的事情」，就是 prepare 的简写，它的主要事项有：")]),s._v(" "),n("ol",[n("li",[s._v("进行软件的补丁（patch）等相关工作")]),s._v(" "),n("li",[s._v("寻找软件所需要的目录是否已经存在？确认用的")]),s._v(" "),n("li",[s._v("事先建立你的软件所需要的目录，或则事先进行的任务")]),s._v(" "),n("li",[s._v("如果待安装的 Linux 系统内已经有安装的时候可能会被覆盖掉的文件时，那么久必须进行备份的工作")])]),s._v(" "),n("p",[s._v("在本例中，你会发现程序会使用 patch 去进行补丁的动作，所以程序的源码才会更新到最新")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("%build")])]),s._v(" "),n("p",[s._v("该段落在配置 make 编译称为可执行的程序。会发现在此部分的程序代码，就是 "),n("code",[s._v("./configure,make")]),s._v(" 等项目。一般来说，如果你会使用 SRPM 来进行重新编译的行为，"),n("strong",[s._v("通常就是要重新 "),n("code",[s._v("./configure")]),s._v(" 并给予新的参数设置，于是这部分就可能会修改")])])]),s._v(" "),n("li",[n("p",[n("code",[s._v("%install")])]),s._v(" "),n("p",[s._v("编译完成后，就要安装了，也就是类似 Tarball 里面的 make install")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("%files")])]),s._v(" "),n("p",[s._v("这个软件安装的文件都需要写到这里来，也包括目录，以备查验用。此外也可以指定每个文件的类型，包括帮助文件（"),n("code",[s._v("%doc 后面接的文件")]),s._v("） 与配置文件 "),n("code",[s._v("%config 后面接的文件")])])]),s._v(" "),n("li",[n("p",[n("code",[s._v("%changelog")])]),s._v(" "),n("p",[s._v("主要记录该软件曾经的更新记录，星号 "),n("code",[s._v("*")]),s._v(" 后面应该要以时间、修改者、email 与软件版本来作为说明，减号 "),n("code",[s._v("-")]),s._v(" 后面则是你详细的说明，在这部分我们就新增了两行，内容如下")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("%changelog\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# * 2020-04-11 mrcode <mrcode@mail.mrcode.cn> - 4.2.6p5-20.mrcode")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 刚开始我如上写的，并没有按他们的规范写，在编译时间就报如下错误了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SPECS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpmbuild -ba ntp.spec ")]),s._v("\nerror: bad "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" %changelog: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-04-11 mrcode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mrcode@mail.mrcode.cn"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.2")]),s._v(".6p5-20.mrcode\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 所以正确的写入如下")]),s._v("\n* Sat Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" Mrcode mrcode"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mrcode@mail.mrcode.cn"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.2")]),s._v(".6p5-20.mrcode\n- only rbuild this SRPM to RPM\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])])])]),s._v(" "),n("p",[s._v("修改到这里也差不多了，你也应该需要了解这个 ntp.spec 文件有多重要，当我们使用 rpm -q 查询一堆信息时，其实都是这里写入的。下面来了解如果将 SRPM 编译出来")]),s._v(" "),n("h2",{attrs:{id:"srpm-的编译指令（-ba、-bb）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#srpm-的编译指令（-ba、-bb）"}},[s._v("#")]),s._v(" SRPM 的编译指令（"),n("code",[s._v("-ba、-bb")]),s._v("）")]),s._v(" "),n("p",[s._v("要将在 "),n("code",[s._v("/root/rpmbuild")]),s._v(" 下的数据编译或则是单纯的打包为 RPM 或 SRPM 时，就需要 rpmbuild 指令与相关选项了，这里介绍两个常用选项")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("rpmbuild -ba ntp.spec  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仅编译并同时产生 RPM 与 SRPM 文件")]),s._v("\nrpmbuild -bb ntp.spec  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仅编译成 RPM 文件")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("这个时候，系统会这样做：")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("先进入到 BUILD 目录，即 "),n("code",[s._v("/root/rpmbuild/BUILD")])])]),s._v(" "),n("li",[n("p",[s._v("根据 "),n("code",[s._v("*.spec")]),s._v(" 文件内的 Name 与 Version 定义出工作目录名称。")]),s._v(" "),n("p",[s._v("以上面的例子为例，那么系统就会在 BUILD 目录中先删除 ntp-4.2.6p5 的目录，在重新建立一个 ntp-4.2.6p5 的目录，并进入该目录")])]),s._v(" "),n("li",[n("p",[s._v("在新建的目录里面，针对 SOURCES 目录下的来源文件，也就是 "),n("code",[s._v("*.spec")]),s._v(" 里面的 Source 设置的哪个文件，以 tar 进行解压缩")]),s._v(" "),n("p",[s._v("以我们这个例子来说，则会在 "),n("code",[s._v("/root/rpmbuild.BUILD/ntp-4.2.6p5")]),s._v(" 中，将 "),n("code",[s._v("/root/rpmbuild/SOURCES/ntp-*")]),s._v(" 等多个源码文件进行解压缩")])]),s._v(" "),n("li",[n("p",[s._v("在开始 "),n("code",[s._v("%build 和 %install")]),s._v(" 的设置与编译")])]),s._v(" "),n("li",[n("p",[s._v("最后将完成打包的文件放置到该放置的地方去，如果你的系统是 x86_64 的话，那么最后编译成功的 rpm 文件则会被放置在 ``/root/rpmbuild/RPMS/x86_64` 里面")])])]),s._v(" "),n("p",[s._v("大概过程如上，最后的结果数据会放置在 RPMS 目录下，我们这个案例中，要同时打包 RPM 与 SRPM，则可以如下操作")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SPECS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /root/rpmbuild/SPECS/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SPECS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpmbuild -ba ntp.spec ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\nWrote: /root/rpmbuild/SRPMS/ntp-4.2.6p5-20.mrcode.src.rpm\nWrote: /root/rpmbuild/RPMS/x86_64/ntp-4.2.6p5-20.mrcode.x86_64.rpm\nWrote: /root/rpmbuild/RPMS/noarch/ntp-perl-4.2.6p5-20.mrcode.noarch.rpm\nWrote: /root/rpmbuild/RPMS/x86_64/ntpdate-4.2.6p5-20.mrcode.x86_64.rpm\nWrote: /root/rpmbuild/RPMS/x86_64/sntp-4.2.6p5-20.mrcode.x86_64.rpm\nWrote: /root/rpmbuild/RPMS/noarch/ntp-doc-4.2.6p5-20.mrcode.noarch.rpm\nWrote: /root/rpmbuild/RPMS/x86_64/ntp-debuginfo-4.2.6p5-20.mrcode.x86_64.rpm\nExecuting"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("%clean"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": /bin/sh -e /var/tmp/rpm-tmp.D7ojeA\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("umask")]),s._v(" 022\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/rpmbuild/BUILD\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ntp-4.2.6p5\n+ /usr/bin/rm -rf /root/rpmbuild/BUILDROOT/ntp-4.2.6p5-20.mrcode.x86_64\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SPECS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# find /root/rpmbuild/ -name 'ntp*rpm'")]),s._v("\n/root/rpmbuild/RPMS/x86_64/ntp-4.2.6p5-19.el7.x86_64.rpm\n/root/rpmbuild/RPMS/x86_64/ntpdate-4.2.6p5-19.el7.x86_64.rpm\n/root/rpmbuild/RPMS/x86_64/ntp-debuginfo-4.2.6p5-19.el7.x86_64.rpm\n/root/rpmbuild/RPMS/x86_64/ntp-4.2.6p5-20.x86_64.rpm\n/root/rpmbuild/RPMS/x86_64/ntpdate-4.2.6p5-20.x86_64.rpm\n/root/rpmbuild/RPMS/x86_64/ntp-debuginfo-4.2.6p5-20.x86_64.rpm\n/root/rpmbuild/RPMS/x86_64/ntp-4.2.6p5-20.mrcode.x86_64.rpm\n/root/rpmbuild/RPMS/x86_64/ntpdate-4.2.6p5-20.mrcode.x86_64.rpm\n/root/rpmbuild/RPMS/x86_64/ntp-debuginfo-4.2.6p5-20.mrcode.x86_64.rpm\n/root/rpmbuild/RPMS/noarch/ntp-perl-4.2.6p5-19.el7.noarch.rpm\n/root/rpmbuild/RPMS/noarch/ntp-doc-4.2.6p5-19.el7.noarch.rpm\n/root/rpmbuild/RPMS/noarch/ntp-perl-4.2.6p5-20.noarch.rpm\n/root/rpmbuild/RPMS/noarch/ntp-doc-4.2.6p5-20.noarch.rpm\n/root/rpmbuild/RPMS/noarch/ntp-perl-4.2.6p5-20.mrcode.noarch.rpm\n/root/rpmbuild/RPMS/noarch/ntp-doc-4.2.6p5-20.mrcode.noarch.rpm\n/root/rpmbuild/SRPMS/ntp-4.2.6p5-20.src.rpm\n/root/rpmbuild/SRPMS/ntp-4.2.6p5-20.mrcode.src.rpm\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 就看到一件出现了我们的 20.mrcode 版本的软件了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 有些文件软件是与硬件等级无关的，所以出现了 ntp-perl-4.2.6p5-20.mrcode.noarch.rpm 的 noarch 软件")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br")])]),n("h2",{attrs:{id:"制作一个我们自己的-srpm-软件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#制作一个我们自己的-srpm-软件"}},[s._v("#")]),s._v(" 制作一个我们自己的 SRPM 软件")]),s._v(" "),n("p",[s._v("在之前的小节中，我们 "),n("RouterLink",{attrs:{to:"/tutorial-basis/21/04.html"}},[s._v("编写了软件 main-0.1")]),s._v("，把它制作成 main-0.1-1.x86_64.rpm")],1),s._v(" "),n("h3",{attrs:{id:"制作源码文件-tarball-产生"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#制作源码文件-tarball-产生"}},[s._v("#")]),s._v(" 制作源码文件 tarball 产生")]),s._v(" "),n("p",[s._v("我们提供了 main-0.1 版本的软件，并提供了一个 main-0.2 的补丁文件，那么需要这样做：")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("main-0.1.tar.gz")]),s._v(" 放在 "),n("code",[s._v("/root/rpmbuild/SOURCES/")])]),s._v(" "),n("li",[n("code",[s._v("main-0.1-to-0.2.patch")]),s._v(" 放在 "),n("code",[s._v("/root/rpmbuild/SOURCES/")])]),s._v(" "),n("li",[n("code",[s._v("main.spec")]),s._v(" 放在 "),n("code",[s._v("/root/rpmbuild/SPECS/")])])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 先来处理源码部分。假设你的 /root/rpmbuild/SOURCES/ 目录以及存在了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意，如果 patch 部分报错，建议直接在之前章节中的下载链接下载")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /root/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study main-0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar -zcf main-0.1.tgz main-0.1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 记得需要将目录打包")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar -ztv -f main-0.1.tgz ")]),s._v("\ndrwxr-xr-x root/root         "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-04-12 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":28 main-0.1/\n-r-------- root/root      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4482")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-04-12 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":06 main-0.1/cos_value.c\n-r-------- root/root       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("101")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2009")]),s._v("-06-09 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":23 main-0.1/haha.c\n-r-------- root/root       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("318")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-04-12 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":58 main-0.1/main.c\n-r-------- root/root       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("188")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-04-12 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":58 main-0.1/Makefile\n-r-------- root/root       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("186")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-04-12 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":58 main-0.1/sin_value.c\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp main-0.1.tgz /root/rpmbuild/SOURCES/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp main-0.1-to-0.2.patch /root/rpmbuild/SOURCES/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /root/rpmbuild/SOURCES/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SOURCES"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll main-*")]),s._v("\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9273")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("月  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":07 main-0.1.tgz\n-r--------. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1538")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("月  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":07 main-0.1-to-0.2.patch\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("h3",{attrs:{id:"建立-spec-的配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#建立-spec-的配置文件"}},[s._v("#")]),s._v(" 建立 "),n("code",[s._v("*.spec")]),s._v(" 的配置文件")]),s._v(" "),n("p",[s._v("这个文件的建立是所有 RPM 制作里面最重要的，需要认真编写。为了方便我们的制作，在 CentOS7 下，vim *.spec 的时候，如果该文件不存在，则会直接给我们一个模板")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SOURCES"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /root/rpmbuild/SPECS/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下面的内容就是给我们的模板信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SPECS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim main.spec")]),s._v("\nName:\nVersion:\nRelease:        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("?dist"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nSummary:\n\nGroup:\nLicense:\nURL:\nSource0:\n\nBuildRequires:\nRequires:\n\n%description\n\n\n%prep\n%setup -q\n\n\n%build\n%configure\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" %"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("?_smp_mflags"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n%install\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DESTDIR")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("buildroot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n%files\n%doc\n\n\n\n%changelog\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下面开始编写信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SPECS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim main.spec")]),s._v("\nName: main\nVersion: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("\nRelease:        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("?dist"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nSummary: Shows sin and cos value.\n\nGroup: Scientific Support\nLicense: GPLv2\nURL: http:/mrcode.cn/\nSource0: main-0.1.tgz\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件名一定要正确")]),s._v("\nPatch0: main-0.1-to-0.2.patch\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# BuildRequires:\t\t没有用到的一定要删掉，否则可能还是会识别到，并报错")]),s._v("\n\n%description\nThis package will "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("let")]),s._v(" you input your name and calculate sin cos value\n\n%prep\n%setup -q\n%patch0 -p1\t\t\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要用来作为 patch 的动作")]),s._v("\n\n\n%build\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" clean main\t\t\t\t\t\t\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译，不要安装")]),s._v("\n\n%install\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p %"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("buildroot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/usr/local/bin\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -m "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("755")]),s._v(" main %"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("buildroot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/usr/local/bin\t\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 顺利的安装行为")]),s._v("\n\n%files\n/usr/local/bin/main\n\n%changelog\n* Sat Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" Mrcode mrcode"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mrcode@mail.mrcode.cn"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.2")]),s._v(".6p5-20.mrcode\n- build the program\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br")])]),n("h3",{attrs:{id:"编译成为-rpm-与-srpm"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#编译成为-rpm-与-srpm"}},[s._v("#")]),s._v(" 编译成为 RPM 与 SRPM")]),s._v(" "),n("p",[s._v("前面的 spec 文件建立后，后续的动作就简单了")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /root/rpmbuild/SPECS/")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面的 spec 文件太重要了，我是搞了 2 个小时，差不多才搞好")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 有写错命令的，有没有删除空配置项目的")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SPECS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpmbuild -ba main.spec ")]),s._v("\n执行"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("%prep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": /bin/sh -e /var/tmp/rpm-tmp.pZIZNq\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("umask")]),s._v(" 022\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/rpmbuild/BUILD\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/rpmbuild/BUILD\n+ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf main-0.1\n+ /usr/bin/gzip -dc /root/rpmbuild/SOURCES/main-0.1.tgz\n+ /usr/bin/tar -xf -\n+ "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("STATUS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n+ "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'['")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" -ne "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("']'")]),s._v("\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" main-0.1\n+ /usr/bin/chmod -Rf a+rX,u+w,g-w,o-w "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Patch #0 (main-0.1-to-0.2.patch):'")]),s._v("\nPatch "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#0 (main-0.1-to-0.2.patch):")]),s._v("\n+ /usr/bin/patch -p1 --fuzz"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n+ /usr/bin/cat /root/rpmbuild/SOURCES/main-0.1-to-0.2.patch\npatching "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" cos_value.c\npatching "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" main.c\npatching "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" Makefile\npatching "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" sin_value.c\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n执行"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("%build"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": /bin/sh -e /var/tmp/rpm-tmp.TXvVHo\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("umask")]),s._v(" 022\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/rpmbuild/BUILD\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" main-0.1\n+ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" clean main\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f main main.o haha.o sin_value.o cos_value.o\ncc    -c -o main.o main.c\ncc    -c -o haha.o haha.c\ncc    -c -o sin_value.o sin_value.c\ncc    -c -o cos_value.o cos_value.c\ngcc -o main main.o haha.o sin_value.o cos_value.o -lm\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n执行"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("%install"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": /bin/sh -e /var/tmp/rpm-tmp.S8b0Xm\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("umask")]),s._v(" 022\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/rpmbuild/BUILD\n+ "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'['")]),s._v(" /root/rpmbuild/BUILDROOT/main-0.1-1.el7.x86_64 "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'!='")]),s._v(" / "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("']'")]),s._v("\n+ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /root/rpmbuild/BUILDROOT/main-0.1-1.el7.x86_64\n++ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dirname")]),s._v(" /root/rpmbuild/BUILDROOT/main-0.1-1.el7.x86_64\n+ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /root/rpmbuild/BUILDROOT\n+ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /root/rpmbuild/BUILDROOT/main-0.1-1.el7.x86_64\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" main-0.1\n+ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /root/rpmbuild/BUILDROOT/main-0.1-1.el7.x86_64/usr/local/bin\n+ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -m "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("755")]),s._v(" main /root/rpmbuild/BUILDROOT/main-0.1-1.el7.x86_64/usr/local/bin\n+ /usr/lib/rpm/find-debuginfo.sh --strict-build-id -m --run-dwz --dwz-low-mem-die-limit "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000000")]),s._v(" --dwz-max-die-limit "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("110000000")]),s._v(" /root/rpmbuild/BUILD/main-0.1\nextracting debug info from /root/rpmbuild/BUILDROOT/main-0.1-1.el7.x86_64/usr/local/bin/main\ndwz: Too few files "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" multifile optimization\n/usr/lib/rpm/sepdebugcrcfix: Updated "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" CRC32s, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" CRC32s did match.\n+ /usr/lib/rpm/check-buildroot\n+ /usr/lib/rpm/redhat/brp-compress\n+ /usr/lib/rpm/redhat/brp-strip-static-archive /usr/bin/strip\n+ /usr/lib/rpm/brp-python-bytecompile /usr/bin/python "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n+ /usr/lib/rpm/redhat/brp-python-hardlink\n+ /usr/lib/rpm/redhat/brp-java-repack-jars\n处理文件：main-0.1-1.el7.x86_64\nProvides: main "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("-1.el7 main"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x86-64"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("-1.el7\nRequires"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rpmlib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": rpmlib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CompressedFileNames"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.0")]),s._v(".4-1 rpmlib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FileDigests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.6")]),s._v(".0-1 rpmlib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PayloadFilesHavePrefix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.0")]),s._v("-1\nRequires: libc.so.6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("64bit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" libc.so.6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GLIBC_2.2.5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("64bit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" libc.so.6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GLIBC_2.7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("64bit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" libm.so.6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("64bit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" libm.so.6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GLIBC_2.2.5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("64bit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" rtld"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GNU_HASH"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n处理文件：main-debuginfo-0.1-1.el7.x86_64\nProvides: main-debuginfo "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("-1.el7 main-debuginfo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x86-64"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("-1.el7\nRequires"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rpmlib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": rpmlib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FileDigests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.6")]),s._v(".0-1 rpmlib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PayloadFilesHavePrefix"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.0")]),s._v("-1 rpmlib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CompressedFileNames"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.0")]),s._v(".4-1\n检查未打包文件：/usr/lib/rpm/check-files /root/rpmbuild/BUILDROOT/main-0.1-1.el7.x86_64\n写道:/root/rpmbuild/SRPMS/main-0.1-1.el7.src.rpm\n写道:/root/rpmbuild/RPMS/x86_64/main-0.1-1.el7.x86_64.rpm\n写道:/root/rpmbuild/RPMS/x86_64/main-debuginfo-0.1-1.el7.x86_64.rpm\n执行"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("%clean"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": /bin/sh -e /var/tmp/rpm-tmp.oIpzDR\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("umask")]),s._v(" 022\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root/rpmbuild/BUILD\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" main-0.1\n+ /usr/bin/rm -rf /root/rpmbuild/BUILDROOT/main-0.1-1.el7.x86_64\n+ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SPECS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这就编译好了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SPECS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /root/rpmbuild/RPMS/x86_64/main-*")]),s._v("\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5428")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("月  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":25 /root/rpmbuild/RPMS/x86_64/main-0.1-1.el7.x86_64.rpm\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4460")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("月  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":25 /root/rpmbuild/RPMS/x86_64/main-debuginfo-0.1-1.el7.x86_64.rpm\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study SPECS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /root/rpmbuild/SRPMS/main-*")]),s._v("\n-rw-r--r--. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3724")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("月  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":25 /root/rpmbuild/SRPMS/main-0.1-1.el7.src.rpm\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br")])]),n("h3",{attrs:{id:"安装、测试、实际查询"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装、测试、实际查询"}},[s._v("#")]),s._v(" 安装、测试、实际查询")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install /root/rpmbuild/RPMS/x86_64/main-0.1-1.el7.x86_64.rpm ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpm -ql main ")]),s._v("\n/usr/local/bin/main\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpm -qi main ")]),s._v("\nName        "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" main\nVersion     "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("\nRelease     "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".el7\nArchitecture: x86_64\nInstall Date: Sun Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":30:24 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("\nGroup       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Scientific Support\nSize        "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7200")]),s._v("\nLicense     "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" GPLv2\nSignature   "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("none"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nSource RPM  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" main-0.1-1.el7.src.rpm\nBuild Date  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Sun Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":25:11 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("\nBuild Host  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" study.centos.mrcode\nRelocations "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("not relocatable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nURL         "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" http:/mrcode.cn/\nSummary     "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Shows sin and cos value.\nDescription "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\nThis package will "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("let")]),s._v(" you input your name and calculate sin cos value\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这就从打包、制作、出来一个自己的软件了")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])])])}),[],!1,null,null,null);t.default=r.exports}}]);