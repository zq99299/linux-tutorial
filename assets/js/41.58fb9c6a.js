(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{499:function(t,s,a){t.exports=a.p+"assets/img/image-20200320172449541.01cb77de.png"},657:function(t,s,a){"use strict";a.r(s);var n=a(16),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"rsyslog-service-记录登录文件的服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rsyslog-service-记录登录文件的服务"}},[t._v("#")]),t._v(" rsyslog.service 记录登录文件的服务")]),t._v(" "),n("p",[t._v("Linux 的日志文件主要是由 rsyslog.service 在负责，检查该服务是否有启动")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study system"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ps aux | grep rsyslog")]),t._v("\nroot      "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1376")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("216420")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7316")]),t._v(" ?        Ssl  Mar17   "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(":11 /usr/sbin/rsyslogd -n\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study system"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl status rsyslog.service ")]),t._v("\n* rsyslog.service - System Logging Service\n   Loaded: loaded "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("/usr/lib/systemd/system/rsyslog.service"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" enabled"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" vendor preset: enabled"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   Active: active "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("running"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" since Tue "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("-03-17 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":49:56 CST"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" days ago\n     Docs: man:rsyslogd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n           http://www.rsyslog.com/doc/\n Main PID: "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1376")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rsyslogd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Tasks: "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n   CGroup: /system.slice/rsyslog.service\n           `-1376 /usr/sbin/rsyslogd -n\n\nMar "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":49:55 study.centos.mrcode systemd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": Starting System Logging Service"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nMar "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":49:56 study.centos.mrcode rsyslogd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1376")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("origin "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("software")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rsyslogd"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("swVersion")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8.24.0-38.el7"')]),t._v(" x-pid"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1376"')]),t._v(" x-info"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.rsyslog.com"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" start\nMar "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(":49:56 study.centos.mrcode systemd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": Started System Logging Service.\nMar "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(":07:02 study.centos.mrcode rsyslogd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1376")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("origin "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("software")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rsyslogd"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("swVersion")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8.24.0-38.el7"')]),t._v(" x-pid"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1376"')]),t._v(" x-info"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.rsyslog.com"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" rsyslogd was HUPed\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 确实在运行，并且是开机启动")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br")])]),n("h2",{attrs:{id:"配置文件-etc-rsyslog-conf"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置文件-etc-rsyslog-conf"}},[t._v("#")]),t._v(" 配置文件 "),n("code",[t._v("/etc/rsyslog.conf")])]),t._v(" "),n("p",[t._v("rsyslogd 的配置文件是 "),n("code",[t._v("/etc/rsyslog.conf")]),t._v("，可以针对各种服务与信息记录在某些文件的配置，该文件规范了")]),t._v(" "),n("ol",[n("li",[t._v("什么服务")]),t._v(" "),n("li",[t._v("什么等级")]),t._v(" "),n("li",[t._v("需要被记录在哪里（设备或文件）")])]),t._v(" "),n("p",[t._v("语法如下")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("服务名称"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("."),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("信息等级\t 信息记录的文件名或设备或主机\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 下面以 mail 服务产生的 info 等级为例")]),t._v("\nmail.info\t\t\t  /var/log/maillog_info\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这一行含义：mail 服务产生的大于等于 info 等级的信息，都记录到后面的指定文件中")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("h3",{attrs:{id:"服务名称"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务名称"}},[t._v("#")]),t._v(" 服务名称")]),t._v(" "),n("p",[t._v("rsyslogd 主要还是通过 Linux 核心提供的 syslog 相关规范来设置数据的分类，Linux 的 syslog 本身有规范一些服务信息，可以通过这些服务来存储系统的信息。主要认识的服务类型有如下：（可使用 "),n("code",[t._v("man 3 syslog")]),t._v(" 或查询 syslog.h 文件来了解）")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[t._v("相对序号")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("服务类别")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("说明")])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("kern（kernel）")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("核心产生的信息，大部分是硬件侦测以及核心功能的启用")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("user")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("在用户层级所产生的信息。例如后续会介绍到使用 logger 指令来记日志文件的功能")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("mail")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("只要与邮件收发有关的信息记录都属于这个")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("daemon")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("主要是系统的服务所产生的信息，例如 systemd")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("auth")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("主要与认证授权有关的机制，例如 login、ssh、su 等需要账户密码的")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("5")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("syslog")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("syslog 相关协议产生的信息，其实就是 rsyslogd 程序本身产生的信息")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("6")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("lpr")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("打印相关信息")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("7")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("news")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("与新闻组服务器有关")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("8")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("uucp")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("Unix to Unix Copy Protocol ，早期用于 unix 系统间的程序数据交换")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("9")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("cron")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("定时任务 cron/at 等产生信息记录的地方")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("10")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("authpriv")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("与 auth 类似，但记录较多账户私人的信息，包括 pam 等模块的运行")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("11")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("ftp")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("与 FTP 通信协议有关信息的输出")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("16~23")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("local0~local7")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("保留给本机用户使用的一些日志文件信息，较常与终端机互动")])])])]),t._v(" "),n("p",[t._v("上述列出的都是 Linux 核心的 syslog 函数自行制定的服务名称，软件开发商可以通过调用上述服务名称来记录他们的软件日志信息。")]),t._v(" "),n("p",[t._v("比如：sendmail 与 postfix 和 dovecot 都是与邮件有关的软件，这些软件在设计日志文件记录时，都会主动调用 syslog 内的 mail 服务名名称（LOG_MAIL）。所以上述三个服务的信息在 syslog 看来就是 mail 类型的服务了，这个概念如下图所示")]),t._v(" "),n("p",[n("img",{attrs:{src:a(499),alt:"image-20200320172449541"}})]),t._v(" "),n("p",[t._v("另外每种服务所产生的数据量差异很大，比如 mail 的信息就很大，为了让不同的信息放置到不同的文件中，可以使用 "),n("code",[t._v("/etc/rsyslog.conf")]),t._v(" 来规范他们分类存放")]),t._v(" "),n("h3",{attrs:{id:"信息等级"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#信息等级"}},[t._v("#")]),t._v(" 信息等级")]),t._v(" "),n("p",[t._v("Linux 核心的 syslog 将信息分为 7 个主要等级")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[t._v("等级数值")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("等级名称")]),t._v(" "),n("th",[t._v("说明")])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("7")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("debug")]),t._v(" "),n("td",[t._v("用来除错时产生的信息数据")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("6")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("info")]),t._v(" "),n("td",[t._v("一些基本的信息说明")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("5")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("notice")]),t._v(" "),n("td",[t._v("虽说是正常信息，但比 info 还需要被注意到的一些信息")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("warning（warn）")]),t._v(" "),n("td",[t._v("警告信息，可能有问题，但是还不至于影响到某个 daemon 运行的信息。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("err（error）")]),t._v(" "),n("td",[t._v("一些重大的错误信息。例如配置文件某些设置导致无法启动服务的信息说明")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("crit")]),t._v(" "),n("td",[t._v("比 error 还严重的错误信息，是 critical 临界点的缩写，很严重的错误信息")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("alert")]),t._v(" "),n("td",[t._v("警告警告，已经很有问题的等级，比 crit 还严重")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("emerg（panic）")]),t._v(" "),n("td",[t._v("疼痛等级，系统几乎要宕机的状态！大概只有硬件出问题，导致整个核心无法顺利运行的情况了吧")])])])]),t._v(" "),n("p",[t._v("除了 0~6 之外，debug 与 none（不需记录等级？）是两个特殊的，当需要调试错误或则忽略掉某些服务的信息时，就可以使用他们")]),t._v(" "),n("p",[t._v("在信息等级前有一些特殊符号 "),n("code",[t._v("[.=!]")]),t._v(" 他们的含义如下：")]),t._v(" "),n("ul",[n("li",[n("p",[n("code",[t._v(".")]),t._v("：代表：比后面还要严重的等级（含该等级）都被记录下来")])]),t._v(" "),n("li",[n("p",[n("code",[t._v(".=")]),t._v("：代表所需要的等级等于后面的等级，才记录")])]),t._v(" "),n("li",[n("p",[n("code",[t._v(".!")]),t._v("：不等于，除了该等级之外的都记录")])])]),t._v(" "),n("h3",{attrs:{id:"信息记录的文件名或设备或主机"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#信息记录的文件名或设备或主机"}},[t._v("#")]),t._v(" 信息记录的文件名或设备或主机")]),t._v(" "),n("p",[t._v("表示该信息要存放在哪里的配置。通常是记录在文件，下面是一些常见的放置：")]),t._v(" "),n("ul",[n("li",[t._v("文件的绝对路径：通常放在 "),n("code",[t._v("/var/log/")]),t._v(" 下")]),t._v(" "),n("li",[t._v("打印机或其他：例如 "),n("code",[t._v("/dev/lp0")])]),t._v(" "),n("li",[t._v("使用者名称：显示给用户")]),t._v(" "),n("li",[t._v("远程主机：例如 "),n("code",[t._v("@study.mrcode.tsai")]),t._v(" ，当然需要对方主机要能支持接收才可以")]),t._v(" "),n("li",[n("code",[t._v("*")]),t._v("：目前在线的所有人，类似 wall 指令")])]),t._v(" "),n("h3",{attrs:{id:"服务、daemon-与函数名称"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务、daemon-与函数名称"}},[t._v("#")]),t._v(" 服务、daemon 与函数名称")]),t._v(" "),n("p",[t._v("syslog、rsyslogd、rsyslog.service 咋会有这么多名称，可以如下来看待")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("syslog")]),t._v(" "),n("p",[t._v("是 Linux 核心所提供的日志文件设计指引，所有的要求大概都写入到一个名为 syslog.h 的文件中。如果你想要开发与日志文件有关的软件，就需要遵循这个 syslog 函数的要求去设计才行，可以使用 man 3 syslog 查询相关数据")])]),t._v(" "),n("li",[n("p",[t._v("rsyslogd")]),t._v(" "),n("p",[t._v("为了要达成实际上进行信息的分类所开发的一套软件，这就是最基本的 daemon 程序")])]),t._v(" "),n("li",[n("p",[t._v("rsyslog.service")]),t._v(" "),n("p",[t._v("为了加入 systemd 的控制，rsyslogd 开发者设计的启动服务脚本")]),t._v(" "),n("p",[t._v("早期 CentOS 5.x 以前要完成 syslog 的功能由 syslogd 的 daemon 来完成，现在则是由 rsyslogd 的 daemon 来完成")])])]),t._v(" "),n("h3",{attrs:{id:"rsyslog-conf-语法练习"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rsyslog-conf-语法练习"}},[t._v("#")]),t._v(" rsyslog.conf 语法练习")]),t._v(" "),n("p",[t._v("例题：将 mail 相关数据给它写入 "),n("code",[t._v("/var/log/maillog")]),t._v(" 中")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("mail.info\t/var/log/maillog\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v("例题：将新闻组资料 news 以及定时任务 cron 的信息都写入到一个名为 "),n("code",[t._v("/var/log/cronnews")]),t._v(" 的文件中，但是他们的警告信息则额外记录在 "),n("code",[t._v("/var/log/cronnews.warn")]),t._v(" 中")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("news.*"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("cron.*\t\t\t/var/log/cronnews\nnews."),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("warn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("cron."),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("warn\t/var/log/cronnews.warn\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])]),n("p",[t._v("例题：message 文件需要记录所有的信息，但是不要记录 cron、mail、news 的信息")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("*.*"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("news,cron,mail.none\t\t\t\t\t\t/var/log/messages\n*.*"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("news.none"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("cron.none"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("mail.none\t\t\t/var/log/messages\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 两种方式，第一种用了逗号语法来完成重复的配置")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("h3",{attrs:{id:"centos-7-x-预设的-rsyslog-conf-内容"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#centos-7-x-预设的-rsyslog-conf-内容"}},[t._v("#")]),t._v(" CentOS 7.x 预设的 rsyslog.conf 内容")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  vim /etc/rsyslog.conf")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rsyslog configuration file")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n上面省略了很多配置，主要是下面的 RULES\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#### RULES ####")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Log all kernel messages to the console.")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Logging much else clutters up the screen.")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#kern.*                                                 /dev/console")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Log anything (except mail) of level info or higher.")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Don't log private authentication messages!")]),t._v("\n*.info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("mail.none"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("authpriv.none"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("cron.none                /var/log/messages\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The authpriv file has restricted access.")]),t._v("\nauthpriv.*                                              /var/log/secure\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Log all the mail messages in one place.")]),t._v("\nmail.*                                                  -/var/log/maillog\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Log cron stuff")]),t._v("\ncron.*                                                  /var/log/cron\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Everybody gets emergency messages")]),t._v("\n*.emerg                                                 :omusrmsg:*\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Save news errors of level crit and higher in a special file.")]),t._v("\nuucp,news.crit                                          /var/log/spooler\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Save boot messages also to boot.log")]),t._v("\nlocal7.*                                                /var/log/boot.log\n\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br")])]),n("ul",[n("li",[n("p",[n("code",[t._v("#kern.*")]),t._v("：")]),t._v(" "),n("p",[t._v("只要是核心产生的信息，都送到 console （终端机）去。console 通常是外部设备连接到系统的，比如，很多封闭的主机（无键盘无屏幕），可以通过连接 RS232 端口将信息输出到外部系统中")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("*.info;mail.none;authpriv.none;cron.none")])]),t._v(" "),n("p",[t._v("由于 mail、authpriv、cron 软件产线的信息太多，且已经分配配置到各个目录中，这里就不再写入 messages 中了")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("authpriv.*")]),t._v("：认证方面的信息都写入该文件")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("mail.*")]),t._v("：邮件方面的信息")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("cron.*")]),t._v("：定时任务方面的信息")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("*.emerg")]),t._v("：")]),t._v(" "),n("p",[t._v("当产生最严重的错误登记时，将该登记的信息以 wall 的方式广播给所有在系统登录的账户")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("uucp,news.crit")])]),t._v(" "),n("p",[t._v("uucp 是早期 Unix-like 系统进行数据传递的通信信息，后来常用在新闻组的用途中，当 news 出现严重错误时写入该文件")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("local7.*")]),t._v("：将本机开机时应该显示到屏幕的信息写到该文件夹中")])])]),t._v(" "),n("p",[n("code",[t._v("mail.* -/var/log/maillog")]),t._v("该项配置前有 "),n("code",[t._v("-")]),t._v(" 符号，该符号表示，使用缓存存储信息，当信息量达到一定大小时才写入硬盘中，这是由于 mail 的日志信息太多了，使用缓存信息减少磁盘交互")]),t._v(" "),n("p",[t._v("每个 distribution 的日志配置可能都不太一样，需要先行查看 "),n("code",[t._v("/etc/rsyslog.conf")]),t._v(" 文件，你才知道那些日志信息去哪里查看")]),t._v(" "),n("h3",{attrs:{id:"自定义增加日志文件功能"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自定义增加日志文件功能"}},[t._v("#")]),t._v(" 自定义增加日志文件功能")]),t._v(" "),n("p",[t._v("比如，你想让「所有的信息」额外写入到 "),n("code",[t._v("/var/log/admin.log")]),t._v(" 中，可以如下实现")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1. 先设置好所建立的文件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim /etc/rsyslog.conf")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Add by mrcode 2020/03/22\t\t# 添加自己修改的注释信息")]),t._v("\n*.info          /var/log/admin.log\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2. 重启 rsyslogd 服务")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl restart rsyslog.service ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ll /var/log/admin.log ")]),t._v("\n-rw-------. "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("771")]),t._v(" Mar "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(":24 /var/log/admin.log\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 就出现日志信息了")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br")])]),n("h2",{attrs:{id:"日志文件的安全性设置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#日志文件的安全性设置"}},[t._v("#")]),t._v(" 日志文件的安全性设置")]),t._v(" "),n("p",[t._v("在某些情况下你需要考虑文件的安全性，比如黑客入侵后，对你系统做了一些操作，由前面所学的知识知道，大部分的操作都会留下日志信息，那么黑客就需要清理掉这些日志信息。可以使用隐藏属性来配置它的安全性")]),t._v(" "),n("p",[t._v("注意：rsyslogd 的日志文件，只能写入，不能被修改的，当知己 vim 修改后，在保存，那么就无法继续记录了（笔者就有一个疑问了：这么大的 BUG，黑客只要先进来修改下日志文件不就可以了？）")]),t._v(" "),n("p",[t._v("在第 6 章中提到过 lsattr 和 chattr 指令，将一个文件以 chattr 设置 i 属性时，该文件连 root 都不能删掉，而且也不能新增数据。那么我们可以使用 a 属性设置，只能被新增数据，而不能被删除")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# chattr +a /var/log/admin.log")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# lsattr /var/log/admin.log ")]),t._v("\n-----a---------- /var/log/admin.log\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果想取消，使用 chattr -a 取消")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("p",[t._v("使用了 a 属性之后，解决了上面笔者的担忧，只能追加写入数据，而无法修改保存，也无法删除，除非 root 权限被攻破")]),t._v(" "),n("h2",{attrs:{id:"日志文件服务器设置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#日志文件服务器设置"}},[t._v("#")]),t._v(" 日志文件服务器设置")]),t._v(" "),n("p",[t._v("前面讲到，在 rsyslog.conf 中，可以将日志数据传送到打印机或则是远程主机上，那么利用这个功能，来看几个场景")]),t._v(" "),n("p",[t._v("你办公室有 10 台服务器，每一台负责一个网络服务，可以通过该功能把日志信息聚合到一台主机上面，你检查的时候就可以只登录这一台主机就可以了解到 10 台服务器的日志了")]),t._v(" "),n("p",[t._v("CentOS 7.x 预设 rsyslogd 本身就具有这个文件服务器的功能了，只是没有启动该功能而已。可以通过 man rsyslogd 查询下相关的选项。")]),t._v(" "),n("p",[t._v("这就涉及到：")]),t._v(" "),n("ul",[n("li",[t._v("服务端 Server：接受客户端的日志数据保存下来")]),t._v(" "),n("li",[t._v("客户端 Clinet：把日志转发到服务端")])]),t._v(" "),n("p",[t._v("服务端配置")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1. Server 端：修改 rsyslogd 的启动配置文件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim /etc/rsyslog.conf")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#### MODULES ####")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Provides UDP syslog reception")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#$ModLoad imudp")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#$UDPServerRun 514")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Provides TCP syslog reception")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ModLoad")]),t._v(" imtcp\n"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$InputTCPServerRun")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("514")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 提供 UDP 和 TCP 方式，如果你的网络很问题，就用 UDP")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 不过，想要数据稳定传输，那么还是建议使用 TCP，把 TCP 的配置打开")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2. 重启 rsyslog 服务")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl restart rsyslog.service  ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# netstat -ltnp | grep rsyslog")]),t._v("\ntcp        "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0:514             "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0:*               LISTEN      "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7107")]),t._v("/rsyslogd       \ntcp6       "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("      "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" :::514                  :::*                    LISTEN      "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7107")]),t._v("/rsyslogd  \n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br")])]),n("p",[t._v("客户端配置")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim /etc/rsyslog.conf")]),t._v("\n*.*\t\t@@192.168.1.100\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#*.*\t@192.168.1.100\t\t# 这个是 UDP 的配置方式")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重启服务")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@study ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# systemctl restart rsyslog.service  ")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);