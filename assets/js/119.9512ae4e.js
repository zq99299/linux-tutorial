(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{625:function(s,t,a){"use strict";a.r(t);var n=a(16),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"磁盘配额（quota）的应用于实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#磁盘配额（quota）的应用于实践"}},[s._v("#")]),s._v(" 磁盘配额（Quota）的应用于实践")]),s._v(" "),a("p",[s._v("Quota 字面意思是「限额」，对于磁盘来说就是限制容量的使用")]),s._v(" "),a("h2",{attrs:{id:"什么是-quota？"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是-quota？"}},[s._v("#")]),s._v(" 什么是 Quota？")]),s._v(" "),a("p",[s._v("就是限制用户对磁盘容量的使用，不至于让其中某一个用户使用了大量的硬盘容量，导致其他用户不够用的情况")]),s._v(" "),a("h3",{attrs:{id:"quota-的一般用途"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#quota-的一般用途"}},[s._v("#")]),s._v(" Quota 的一般用途")]),s._v(" "),a("p",[s._v("针对网络服务的设计，比较常用的情况是：")]),s._v(" "),a("ul",[a("li",[s._v("针对 www server，如：每个人的网页空间的容量限制")]),s._v(" "),a("li",[s._v("针对 mail server，如：每个人的邮件空间限制")]),s._v(" "),a("li",[s._v("针对 file server，如：每个人最大的可用网络磁盘空间（教学环境中最常见）")])]),s._v(" "),a("p",[s._v("针对 Linux 系统主机上面的使用者有如下常用情况：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("使用群组限制：限制某一群组所能使用的最大磁盘配额")])]),s._v(" "),a("li",[a("p",[s._v("使用用户限制：限制某一用户的最大磁盘配额")])]),s._v(" "),a("li",[a("p",[s._v("限制某一目录的最大磁盘配额")]),s._v(" "),a("p",[s._v("在 EXT 家族文件系统的磁盘配额主要是针对整个文件系统来处理，所以大多针对挂载点进行设计。")]),s._v(" "),a("p",[s._v("新的 xfs 可以使用 project 模式，可以针对个别的目录（非文件系统）来设计磁盘配额")])])]),s._v(" "),a("p",[s._v("基本上 qutoa 让管理员知道磁盘使用率以及管理磁盘使用情况的一个工具。比较特别的是 XFS 的 quota 是整合到文件系统内，并不是其他外挂程序来管理的。所以通过 quota 来直接回报磁盘使用率，要比 unix 工具快速。如 "),a("code",[s._v("du")]),s._v("会重新计算目录下的磁盘使用率，但 xfs 可以通过 xfs_quota 直接获得各个目录的使用率，速度要快很多")]),s._v(" "),a("h3",{attrs:{id:"quota-的使用限制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#quota-的使用限制"}},[s._v("#")]),s._v(" Quota 的使用限制")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("EXT 文件系统家族只能针对整个 filesystem，xfs 可以使用 project 模式来为不同目录磁盘配额")])]),s._v(" "),a("li",[a("p",[s._v("核心必须支持 quota")]),s._v(" "),a("p",[s._v("Linux 核心必须有支持 quota 功能，CentOS7.x 预设支持 quota 功能")])]),s._v(" "),a("li",[a("p",[s._v("只对一般身份使用者有效")]),s._v(" "),a("p",[s._v("root 不能设置 quota，因为整个服务器数据都是他的")])]),s._v(" "),a("li",[a("p",[s._v("若启用 SELinux，非所有目录均可设置 quota")]),s._v(" "),a("p",[s._v("新版 CentOS 预设启用 SELinux 功能，该功能加强了某些细部的权限控制，所以预设情况下，只能针对 "),a("code",[s._v("/home/")]),s._v("进行配置 quota")]),s._v(" "),a("p",[s._v("如果要针对其他目录配置 quota，后续章节会讲解怎么解开 SELinux 限制的方法")])])]),s._v(" "),a("p",[s._v("不同文件系统 quota 的处理不太一样，在 quota 前，先确认你的文件系统")]),s._v(" "),a("h3",{attrs:{id:"quota-的规范设置项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#quota-的规范设置项目"}},[s._v("#")]),s._v(" Quota 的规范设置项目")]),s._v(" "),a("p",[s._v("针对 XFS filesystem 的限制项目主要分为以下几部分：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("分别针对用户 user、群组 group、个别目录 project")]),s._v(" "),a("p",[s._v("quota 的限制中，主要针对以上项进行磁盘使用率的限制")])]),s._v(" "),a("li",[a("p",[s._v("容量限制 block 或文件数量 inode 限制")]),s._v(" "),a("p",[s._v("第 7 章中说到，文件系统主要规划为存放属性的 inode 与实际文件数据的 block 区块。")]),s._v(" "),a("ul",[a("li",[s._v("限制 inode 用量：限制可以建立的 文件数量")]),s._v(" "),a("li",[s._v("限制 block 用量：管理用户磁盘容量限制，较常见该方式")])])]),s._v(" "),a("li",[a("p",[s._v("柔性 soft 劝导与硬性 hard 规定")]),s._v(" "),a("p",[s._v("inode 和 block 限制值有两个：soft 与 hard，通常 hard 值比 soft 高。")]),s._v(" "),a("p",[s._v("如：限制项目为 block，可以限制 hard 为 500MBytes ，soft 为 400MBytes。")]),s._v(" "),a("ul",[a("li",[s._v("hard：表示使用者绝对不会超过该值。")]),s._v(" "),a("li",[s._v("soft：表示使用者在地狱 soft 限制时，可以正常使用磁盘，但若超过 soft 且低于 hard 值，每次用户登录系统时，系统会主动发出磁盘即将爆满的警告信息，且会给予一个宽限时间（grace time），如果在宽限时间内降低到了 soft 限制下，则宽限时间会停止")])])]),s._v(" "),a("li",[a("p",[s._v("会倒计时的宽限时间（grace time）")]),s._v(" "),a("p",[s._v("只有用户的磁盘用量介于 soft 到 hard 之间时，才会出现倒计时，由于达到 hard 值时，用户的磁盘使用权可能会被锁住。为了担心用户没有注意到磁盘配额问题，因此涉及了 soft，相当于预警机制，一般预设的宽限时间为 7 天，"),a("strong",[s._v("如果 7 天内你还不进行容量降低动作，那么 soft 限制会立刻取代 hard 值来做为 quota 的限制")])])])]),s._v(" "),a("h2",{attrs:{id:"一个-xfs-文件系统的-quota-实验"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一个-xfs-文件系统的-quota-实验"}},[s._v("#")]),s._v(" 一个 XFS 文件系统的 Quota 实验")]),s._v(" "),a("p",[s._v("一个场景来实践，如下是需求描述")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("目的与账户")]),s._v(" "),a("p",[s._v("让 5 个专题生为一组，账户是 myquota1、myquota2、myquota3、myquota4、myquota5 ，密码都是 123456，初始群组都是 myquotagrp。其他属性都为默认值")])]),s._v(" "),a("li",[a("p",[s._v("账户的磁盘容量限制")]),s._v(" "),a("p",[s._v("5 个用户都能使用 300MBytes 的磁盘使用量（hard），文件数量不限制。此外，只要容量使用超过 250MBytes，则警告（soft）")])]),s._v(" "),a("li",[a("p",[s._v("群组限额（option 1）")]),s._v(" "),a("p",[s._v("由于该系统还有其他用户存在，因此 myquotagrp 群组最多可用使用 1GBytes 的容量。也就是说 myquota1~3 都用了 280Mbytes，那么剩下两人最多只能使用 1000MB - 280x3 = 160MB 的磁盘容量。这就是使用者与群组同时设置时会产生的后果")])]),s._v(" "),a("li",[a("p",[s._v("共享目录限额（option 2）")]),s._v(" "),a("p",[s._v("另一种设置方式是：每个用户具有自己的独立容量上限，他们的专题共享目录在 "),a("code",[s._v("/home/myquota")]),s._v(" 该目录设置为其他人没有任何权限的共享空间，只有 myquotagrp 群组拥有全部的权限。且该目录最多只能使用 500MB 的磁盘容量。"),a("strong",[s._v("群组 group 的限制与目录 （directory/project）无法同时设置")])])]),s._v(" "),a("li",[a("p",[s._v("宽限时间限制：每个使用者在超过 soft 限制值之后，有 14 天的宽限时间")])])]),s._v(" "),a("p",[s._v("接下来一步一步实现以上需求")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 多账户创建，可以使用之前的批量账户创建脚本来实现，这里使用简化版的定制脚本来实现")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim addaccount2.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用脚本来创建 xfs 文件系统 Quota 实验的账户")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" myquotagrp\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("username")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" myquota1 myquota2 myquota3 myquota4 myquota5 \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" -g myquotagrp "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$username")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" --stdin "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$username")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /home/myquota\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chgrp")]),s._v(" myquotagrp /home/myquota\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 改变该目录的所属群")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2770")]),s._v(" /home/myquota\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拥有者和群组有权限，这里加了个 SGID=2 的特殊权限，笔者暂时不理解是为什么")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sh addaccount2.sh ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h2",{attrs:{id:"实验流程-1：文件系统的支持与观察"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实验流程-1：文件系统的支持与观察"}},[s._v("#")]),s._v(" 实验流程 1：文件系统的支持与观察")]),s._v(" "),a("p",[s._v("XFS 默认支持 Quota，Ext 则请自行百度。另外 "),a("strong",[s._v("不要在根目录下进行 quota，因为文件系统会变得太复杂")]),s._v("，下面以 "),a("code",[s._v("/home")]),s._v(" 这个 xfs 文件系统为例，如何启动 quota 功能")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看文件系统")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -h 格式化容量单位，-T 显示 type 字段")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -hT /home")]),s._v("\nFilesystem                    Type  Size  Used Avail Use% Mounted on\n/dev/mapper/centos_study-root xfs    35G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".4G   31G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v("% /\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到上面的挂载点是 / 根目录，这里是由于该指令不是在最初我们搭建分区的哪台学习机上操作的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 所以最好还是切换到我们的学习机上面去实验；目前由于在外面，暂时没有环境")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("在过去的版本中，管理员可以通过 "),a("code",[s._v("mount -o remount")]),s._v(" 机制来重新挂载启动 quota 的功能，不过当前的 XFS 文件系统在挂载之初就声明了，因此无法使用 remount 来重新启动 quota 功能，一定要写入 "),a("code",[s._v("/etc/fstab")]),s._v(" 中，或者是在初始挂载过程中加入这个项目，否则不会生效")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/fstab")]),s._v("\n/dev/mapper/centos_study-root   /    xfs     defaults,usrquota,grpquota        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第一字端对应 df -hT /home 中出现的第一字段。这里只增加了第 4 字段的这部分内容 ,usrquota,grpquota")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 卸载根目录，肯定会提示忙碌；这里只有重启让自动挂载了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# umount /       ")]),s._v("\numount: /: target is busy.\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("In some cases useful info about processes that use\n         the device is found by lsof"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or fuser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里尝试使用根目录来启用 quota 功能，配置，重启之后，也没有被开启，这里我放弃了")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("好了，回到了最开始学习分好区那台学习机上了，下面再来做这个实验")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" -hT /home\nFilesystem              Type  Size  Used Avail Use% Mounted on\n/dev/mapper/centos-home xfs   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".0G  128M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".9G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("% /home\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先看看该目录提供的服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" home\n/dev/mapper/centos-home on /home "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" xfs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw,relatime,seclabel,attr2,inode64,noquota"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 增加挂载时提供的服务 ,usrquota,grpquota ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/fstab")]),s._v("\n/dev/mapper/centos-home /home                   xfs     defaults,usrquota,grpquota        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 还是提示繁忙，这里只能用重启代替，下面的2个步骤")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 原因是有 home 下面的账户在登录，因此无法卸载掉")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# umount /home")]),s._v("\numount: /home: target is busy.\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("In some cases useful info about processes that use\n         the device is found by lsof"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or fuser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount -a\t# 挂载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仔细看下面的信息，证明已经启动了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" home\n/dev/mapper/centos-home on /home "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" xfs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw,relatime,seclabel,attr2,inode64,usrquota,grpquota"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("基本个，针对 quota 限制的项目主要有三项：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("uquota/usrquota/quota")]),s._v("：针对使用者账户的设置")]),s._v(" "),a("li",[a("code",[s._v("gquota/grpquota")]),s._v("：针对群组的设置")]),s._v(" "),a("li",[a("code",[s._v("pquota/prjquota")]),s._v("：针对单一目录的设置，不可与  grpquota 同时存在")])]),s._v(" "),a("p",[s._v("务必小心 修改"),a("code",[s._v("/etc/fstab")]),s._v("文件内容，发生错误的话，有可能导致无法开机")]),s._v(" "),a("h2",{attrs:{id:"实验流程-2：观察-quota-报告资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实验流程-2：观察-quota-报告资料"}},[s._v("#")]),s._v(" 实验流程 2：观察 Quota 报告资料")]),s._v(" "),a("p",[s._v("可以使用 xfs_quota 指令来查阅相关信息，该指令参数较多，先来了解简单查询的参数")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("xfs_quota -x -c "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"指令"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("挂载点"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n选项与参数：\n\t-x：专家模式，后续才能够加入 -c 的指令参数\n\t-c：后面接指令，本小节先讲解数据回报的指令\n指令：\n\tprint：单纯的列出目前主机内的文件系统参数等信息\n\tdf：与原本的  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" 功能一样，可以加上 -b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  -i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("inode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" -h（格式化单位）等\n\treport：列出目前的 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" 项目，有 -ugr（user/group/project） 和 -bi 等信息\n\tstate：列出目前支持 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" 的文件系统信息，有无启动相关项目等信息\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 1：列出目前系统的各个文件系统，以及文件系统的 quota 挂载参数支持")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ xfs_quota -x -c "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"print"')]),s._v("\nFilesystem          Pathname\n/                   /dev/mapper/centos-root\n/boot               /dev/sda2\n/home               /dev/mapper/centos-home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uquota, gquota"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里显示支持")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 2：列出目前 /home 支持 quota 的挂载点文件系统使用情况")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ xfs_quota -x -c "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"df -h"')]),s._v(" /home\nFilesystem     Size   Used  Avail Use% Pathname\n/dev/mapper/centos-home\n               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".0G "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127")]),s._v(".7M   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".9G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("% /home\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 和 df -h 类似，只是更准确了 ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 3： 列出目前 /home 的所有用户的  quota 限制值")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "report -ubih" /home')]),s._v("\nUser "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks                            Inodes              \nUser ID      Used   Soft   Hard Warn/Grace     Used   Soft   Hard Warn/Grace  \n---------- --------------------------------- --------------------------------- \nroot            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".4M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("260")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode1     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("87")]),s._v(".9M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota1      12K      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota2      12K      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota3      12K      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota4      12K      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota5      12K      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Blocks 是容量限制")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Inodes 是文件数量限制")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# soft/hard 为 0 则表示没有限制")]),s._v("\n\n默认情况下， report 会将支持的 user/group/prject 相关数据都列出来；上面加了 -u 参数，所以只列出了 user 的相关数据\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 4：列出目前支持的 quota 文件系统是否有启动了 quota 功能")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "state" ')]),s._v("\nUser "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Accounting: ON\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否启用计算功能； ON 是，OFF 否")]),s._v("\n  Enforcement: ON\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否有实际 quota 管制功能")]),s._v("\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1605 (2 blocks, 2 extents)")]),s._v("\nGroup "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Accounting: ON\n  Enforcement: ON\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1606 (2 blocks, 2 extents)")]),s._v("\nProject "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# project 并未开启")]),s._v("\n  Accounting: OFF\t\n  Enforcement: OFF\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1606 (2 blocks, 2 extents)")]),s._v("\nBlocks grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下面是 grace timec 的项目，宽限时间")]),s._v("\nInodes grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nRealtime Blocks grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h2",{attrs:{id:"实验流程-3：限制值设置方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实验流程-3：限制值设置方式"}},[s._v("#")]),s._v(" 实验流程 3：限制值设置方式")]),s._v(" "),a("p",[s._v("启动支持并能查询到相关状态，那么进行实验的限制操作：每个用户 250/300MB 容量限制、群组供 950M/1G 容量限制、宽限时间（grace time）14 天")]),s._v(" "),a("p",[s._v("语法如下：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("xfs_quota -x -c "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"limit [-ug] b[soft|hard]=N name"')]),s._v("\nxfs_quota -x -c "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timer [-ug] [bir] Ndays"')]),s._v("\n\n选项与参数：\nlimit： 实际限制的项目，可以针对 user/group 限制，项目有：\n\tbsoft/bhard：block 的 soft/hard 限制值，可以加单位\n\tisoft/ihard：inode 的 soft/hard 限制值\n\tname：用户/群组名称\n\t\ntimer：设置 grace "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" 项目，可以针对 user/group 以及 block/inode 设置\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 1：设置用户的 block 限制值（需求中没有说限制文件数量 inode）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "limit -u bsoft=250M bhard=300M myquota1" /home')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "limit -u bsoft=250M bhard=300M myquota2" /home')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "limit -u bsoft=250M bhard=300M myquota3" /home')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "limit -u bsoft=250M bhard=300M myquota4" /home')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "limit -u bsoft=250M bhard=300M myquota5" /home')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "report -ubih" /home')]),s._v("\nUser "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks                            Inodes              \nUser ID      Used   Soft   Hard Warn/Grace     Used   Soft   Hard Warn/Grace  \n---------- --------------------------------- --------------------------------- \nroot            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".4M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("260")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode1     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("87")]),s._v(".9M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota1      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota2      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota3      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota4      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota5      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到  5 个账户的设置以及生效了，在 Blocks 这边")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 2：设置 myqutarp 的 block 限制值")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "limit -g bsoft=950M bhard=1G myquotagrp" /home')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "report -gbih" /home')]),s._v("\nGroup "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks                            Inodes              \nGroup ID     Used   Soft   Hard Warn/Grace     Used   Soft   Hard Warn/Grace  \n---------- --------------------------------- --------------------------------- \nroot            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".4M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("260")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode1     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("87")]),s._v(".9M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquotagrp    60K   950M     1G  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("36")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 3： 设置 grace time 为 14 天")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "timer -u -b 14days" /home')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "timer -g -b 14days" /home')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "state" /home')]),s._v("\nUser "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Accounting: ON\n  Enforcement: ON\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1605 (2 blocks, 2 extents)")]),s._v("\nGroup "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Accounting: ON\n  Enforcement: ON\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1606 (2 blocks, 2 extents)")]),s._v("\nProject "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Accounting: OFF\n  Enforcement: OFF\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1606 (2 blocks, 2 extents)")]),s._v("\nBlocks grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里变成了 14 天")]),s._v("\nInodes grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nRealtime Blocks grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 4：以 myquota1 的用户测试 quota 是否真的有限制效果")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" -l myquotal\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myquota1@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/zero "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("of")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v(".img "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bs")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1M "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("count")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("310")]),s._v("\ndd: 写入"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123.img"')]),s._v(" 出错: 超出磁盘限额\n记录了300+0 的读入\n记录了299+0 的写出\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("313524224")]),s._v("字节"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("314")]),s._v(" MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("已复制，0.386459 秒，811 MB/秒\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 英文版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("myquota1@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/zero "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("of")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v(".img "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bs")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1M "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("count")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("310")]),s._v("\ndd: error writing "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123.img'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" Disk "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" exceeded\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),s._v("+0 records "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("299")]),s._v("+0 records out\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("313524224")]),s._v(" bytes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("314")]),s._v(" MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" copied, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.175228")]),s._v(" s, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.8")]),s._v(" GB/s\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看状态")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "report -ubih" /home')]),s._v("\nUser "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks                            Inodes              \nUser ID      Used   Soft   Hard Warn/Grace     Used   Soft   Hard Warn/Grace  \n---------- --------------------------------- --------------------------------- \nroot            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".4M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("260")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode1     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("87")]),s._v(".9M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota1   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("299")]),s._v(".0M   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota2      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota3      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota4      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota5      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 会发现 myquota1 使用量已经满了，并且宽限时间还有 13 天")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("h2",{attrs:{id:"实验流程-4：project-的限制（针对目录）-可选"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实验流程-4：project-的限制（针对目录）-可选"}},[s._v("#")]),s._v(" 实验流程 4：project 的限制（针对目录）- 可选")]),s._v(" "),a("p",[s._v("注意：这里是针对  /home/myquota 这个目录，而不是针对 myquotagrp 这个群组。上面配置过 myquotagrp 这个组的限制")]),s._v(" "),a("p",[s._v("另外：上述 myquota1 已经使用了 300M 的容量，他是在他自己家的目录做的 dd 指令，因此 "),a("code",[s._v("/home/myquota")]),s._v(" 这个目录目前还未使用，但是")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "report -h" /home')]),s._v("\nUser "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks              \nUser ID      Used   Soft   Hard Warn/Grace   \n---------- --------------------------------- \nroot            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".4M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode1     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("87")]),s._v(".9M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota1   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("299")]),s._v(".0M   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota2      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota3      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota4      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota5      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nGroup "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks              \nGroup ID     Used   Soft   Hard Warn/Grace   \n---------- --------------------------------- \nroot            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".4M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode1     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("87")]),s._v(".9M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquotagrp "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("299")]),s._v(".1M   950M     1G  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("会发现，myquotagrp 这个群组的容量已经用掉了 300M，对于目录的限制来说，就不会有效果了")]),s._v(" "),a("p",[s._v("还因为 project 不能与 group 同时设置，所以需要取消掉 group 的设置，并加入 project 才可以")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改 /etc/fstab 内的文件系统支持参数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把 grpquota 去掉，加入 prjquota")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/fstab ")]),s._v("\n\n/dev/mapper/centos-home /home                   xfs     defaults,usrquota,prjquota        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 卸载 /home, 并重新加载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里还是老问题，远程登录笔者用 mrcode 为入口的，所以 /home 目录卸载在使用（虽然使用 su 切换到了 root）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里还是使用重启机器来自动挂载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# umount /home/")]),s._v("\numount: /home: target is busy.\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("In some cases useful info about processes that use\n         the device is found by lsof"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or fuser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount -a")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "state"')]),s._v("\nUser "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Accounting: ON\n  Enforcement: ON\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1605 (2 blocks, 2 extents)")]),s._v("\nGroup "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Accounting: OFF\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 已经关闭了")]),s._v("\n  Enforcement: OFF\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1606 (2 blocks, 2 extents)")]),s._v("\nProject "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Accounting: ON\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 已经启动了")]),s._v("\n  Enforcement: ON\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1606 (2 blocks, 2 extents)")]),s._v("\nBlocks grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nInodes grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nRealtime Blocks grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里还没有配置任何项目的限制的哈。除了第一行哪个 #0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "report -h" /home')]),s._v("\nUser "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks              \nUser ID      Used   Soft   Hard Warn/Grace   \n---------- --------------------------------- \nroot            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".4M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmrcode1     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("87")]),s._v(".9M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota1   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("299")]),s._v(".0M   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota2      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota3      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota4      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmyquota5      12K   250M   300M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nProject "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks              \nProject ID   Used   Soft   Hard Warn/Grace   \n---------- --------------------------------- \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#0         394.3M      0      0  00 [------]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br")])]),a("p",[s._v("规范目录、项目名称和项目 ID")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定项目表伺服与目录的对应;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 语法可以看成是：别名:目录；这里别名设置的是数字 11")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "11:/home/myquota" >> /etc/projects')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 规范项目名称；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 语法是：项目名称:目录别名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"myquotaproject:11"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/projid\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个语法感觉很奇怪，需要先个目录取个别名，然后再取个别名取关联这个别名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不过笔者看目录名称：可以这样来理解：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# projects 目录给目标目录取了一个  别名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# projid 用自定义的 ID，关联了别名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个应该是解耦配置之类的考虑吧")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始化专案名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "project -s myquotaproject"')]),s._v("\nSetting up project myquotaproject "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path /home/myquota"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nProcessed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/etc/projects and cmdline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" paths "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" project myquotaproject with recursion depth infinite "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\nSetting up project myquotaproject "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path /home/myquota"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nProcessed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/etc/projects and cmdline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" paths "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" project myquotaproject with recursion depth infinite "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\nSetting up project myquotaproject "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path /home/myquota"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nProcessed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/etc/projects and cmdline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" paths "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" project myquotaproject with recursion depth infinite "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("-1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 就可以看到完整的文件系统各项支持，与 project 的目录对应")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "print " /home')]),s._v("\nFilesystem          Pathname\n/home               /dev/mapper/centos-home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uquota, pquota"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n/home/myquota       /dev/mapper/centos-home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("project "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(", myquotaproject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "report -pbih " /home')]),s._v("\nProject "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks                            Inodes              \nProject ID   Used   Soft   Hard Warn/Grace     Used   Soft   Hard Warn/Grace  \n---------- --------------------------------- --------------------------------- \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#0         394.3M      0      0  00 [------]    327      0      0  00 [------]")]),s._v("\nmyquotaproject      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第二行，是我们刚刚配置的项目 ID，各个使用都还是 0 ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("p",[s._v("测试与观察")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试与观察")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "limit -p bsoft=450M bhard=500M myquotaproject" /home')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "report -pbih " /home')]),s._v("\nProject "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks                            Inodes              \nProject ID   Used   Soft   Hard Warn/Grace     Used   Soft   Hard Warn/Grace  \n---------- --------------------------------- --------------------------------- \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#0         394.3M      0      0  00 [------]    327      0      0  00 [------]")]),s._v("\nmyquotaproject      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   450M   500M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到一件配置上 450 和 500 m 的限制了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/zero "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("of")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/myquota/123/img "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bs")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1M "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("count")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("510")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试是否有效")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/zero of=/home/myquota/123.img bs=1M count=510")]),s._v("\ndd: error writing "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/home/myquota/123.img'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" No space left on device\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("501")]),s._v("+0 records "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v("+0 records out\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("524288000")]),s._v(" bytes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("524")]),s._v(" MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" copied, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.491772")]),s._v(" s, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v(" GB/s\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 root 对该目录写入，超过限制也被提示了，这个才是完整的针对目录的规范")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("p",[s._v("小节：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("/etc/projects")]),s._v("：给具体的目录建立别名")]),s._v(" "),a("li",[a("code",[s._v("/etc/projid")]),s._v("：给目录别名建立 projid")])]),s._v(" "),a("p",[s._v("这样就可以针对目录来限制了。")]),s._v(" "),a("p",[s._v("有如下一个常见，就能满足使用限制目录的需求：在 www 服务中，要针对某些目录进行容量限制，但是因为容量之前仅针对用户进行限制，但是由于 www 服务都是一个名为 httpd 的账户管理的，因此该 www 服务所产生的文件数据都属于 httpd 账户，就无法针对某些特定的目录进行限制了，有了 project 之后，就可以针对不同的目录做容量限制，而不用管在里面建立文件的文件拥有者")]),s._v(" "),a("h2",{attrs:{id:"xfs-quota-的管理与额外指令对照表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xfs-quota-的管理与额外指令对照表"}},[s._v("#")]),s._v(" XFS quota 的管理与额外指令对照表")]),s._v(" "),a("p",[s._v("这里讲解稍微完讲解常用的 quota 维护指令")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("disable：暂时取消 quota 的限制，但其实同还是在计算 quota，只是暂时不对限制做任何操作")])]),s._v(" "),a("li",[a("p",[s._v("enable：恢复 quota 的限制")])]),s._v(" "),a("li",[a("p",[s._v("off：完全关闭 quota 的限制")]),s._v(" "),a("p",[s._v("该选项只能通过卸载重新挂载才能重新开启 quota 的限制哟")])]),s._v(" "),a("li",[a("p",[s._v("remov：必须要在 off 状态下才能执行该指令，移除 quota 的限制配置")]),s._v(" "),a("p",[s._v("比如要移除 project 的限制配置，只需要 "),a("code",[s._v("remove -p")]),s._v(" 就可以了，而不需要重新设置限制值为 0")])])]),s._v(" "),a("p",[s._v("实践练习")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 暂时关闭 XFS 文件系统的 quota 限制功能")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "disable -up" /home')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "state " /home')]),s._v("\nUser "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Accounting: ON\n  Enforcement: OFF\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 已经变成 OFF 了")]),s._v("\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1605 (2 blocks, 2 extents)")]),s._v("\nGroup "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Accounting: OFF\n  Enforcement: OFF\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1606 (2 blocks, 2 extents)")]),s._v("\nProject "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" state on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Accounting: ON\n  Enforcement: OFF\n  Inode: "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1606 (2 blocks, 2 extents)")]),s._v("\nBlocks grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nInodes grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nRealtime Blocks grace time: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" days"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试写入大于限制值的文件到 目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/zero of=/home/myquota/123.img bs=1M count=510")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("510")]),s._v("+0 records "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("510")]),s._v("+0 records out\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("534773760")]),s._v(" bytes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("535")]),s._v(" MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" copied, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.365973")]),s._v(" s, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.5")]),s._v(" GB/s\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发现没有限制了")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "report -pbih " /home')]),s._v("\nProject "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks                            Inodes              \nProject ID   Used   Soft   Hard Warn/Grace     Used   Soft   Hard Warn/Grace  \n---------- --------------------------------- --------------------------------- \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#0         394.3M      0      0  00 [------]    327      0      0  00 [------]")]),s._v("\nmyquotaproject   510M   450M   500M  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-none-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 会发现有统计，只是没有限制")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启限制")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "enable -up" /home')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再次写入，限制出现了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/zero of=/home/myquota/123.img bs=1M count=510")]),s._v("\ndd: error writing "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/home/myquota/123.img'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" No space left on device\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("501")]),s._v("+0 records "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v("+0 records out\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("524288000")]),s._v(" bytes "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("524")]),s._v(" MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" copied, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.400271")]),s._v(" s, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.3")]),s._v(" GB/s\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭了 quota 限制行为，再尝试开启，会发现不能开启")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "off -up" /home')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "enable -up" /home')]),s._v("\nXFS_QUOTAON: Function not implemented\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过 off 之后，需要重新卸载挂载  umount/mount 才可以重新开启")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 笔者这里还是使用重启来替代者两个命令")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("umount")]),s._v(" /home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" -a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 移除所有的限制")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#xfs_quota -x -c "off -up" /homee')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 移除项目的配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "remove -p" /home')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭后，不重新挂载，没有任何信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "state" /home')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "state"      ')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "report -pbh" /home')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新挂载后，查看，项目的限制配置就没有了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# xfs_quota -x -c "report -pbh" /home')]),s._v("\nProject "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" on /home "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/mapper/centos-home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        Blocks              \nProject ID   Used   Soft   Hard Warn/Grace   \n---------- --------------------------------- \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#0         394.3M      0      0  00 [------]")]),s._v("\nmyquotaproject   500M      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  00 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("------"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br")])]),a("p",[s._v("下面是 EXT 家族与 XFS 系统的相关命令，可以尝试使用以下命令来维护")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("设定流程项目")]),s._v(" "),a("th",[s._v("XFS 文件系统")]),s._v(" "),a("th",[s._v("EXT 家族")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("code",[s._v("/etc/fstab")]),s._v(" 参数设置")]),s._v(" "),a("td",[s._v("usrquota/grpquota/prjquota")]),s._v(" "),a("td",[s._v("usrquota/grpquota")])]),s._v(" "),a("tr",[a("td",[s._v("quota 配置文件")]),s._v(" "),a("td",[s._v("不需要")]),s._v(" "),a("td",[s._v("quotacheck")])]),s._v(" "),a("tr",[a("td",[s._v("设置用户/群组限制值")]),s._v(" "),a("td",[a("code",[s._v('xfs_quota -x -c "limit "')])]),s._v(" "),a("td",[s._v("edquota 或 setquota")])]),s._v(" "),a("tr",[a("td",[s._v("设置 grace time")]),s._v(" "),a("td",[a("code",[s._v('xfs_quota -x -c "timer "')])]),s._v(" "),a("td",[s._v("edquota")])]),s._v(" "),a("tr",[a("td",[s._v("设置目录限制值")]),s._v(" "),a("td",[a("code",[s._v('xfs_quota -x -c "limit "')])]),s._v(" "),a("td",[s._v("无")])]),s._v(" "),a("tr",[a("td",[s._v("观察报告")]),s._v(" "),a("td",[a("code",[s._v('xfs_quota -x -c "report "')])]),s._v(" "),a("td",[s._v("repquota 或 quota")])]),s._v(" "),a("tr",[a("td",[s._v("启动与关闭 quota 限制")]),s._v(" "),a("td",[a("code",[s._v('xfs_quota -x -c "[disable|enable] "')])]),s._v(" "),a("td",[s._v("quotaoff、quotaon")])]),s._v(" "),a("tr",[a("td",[s._v("发送警告给用户")]),s._v(" "),a("td",[s._v("目前版本尚未支持")]),s._v(" "),a("td",[s._v("warnquota")])])])]),s._v(" "),a("h2",{attrs:{id:"不修改现有系统的-quota"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不修改现有系统的-quota"}},[s._v("#")]),s._v(" 不修改现有系统的 quota")]),s._v(" "),a("p",[s._v("有这样一种情况：之前分区时，没有规划邮件信箱目录 "),a("code",[s._v("/var/spool/mail/")]),s._v(" 是一个独立的 partition，现在主机也没有办法新增或分区出任何新的分区槽了。")]),s._v(" "),a("p",[s._v("那么在这样的情况下，quota 的支持与文件系统有关，无法夸文件系统来设计 quota 的 project 功能")]),s._v(" "),a("p",[s._v("那么此时，那么想要使用的邮件信箱与家目录的总体磁盘使用量为固定，要怎么做？由于 "),a("code",[s._v("/home/")]),s._v("和 "),a("code",[s._v("/var/spool/mail")]),s._v(" 根本不可能是同一个 filesystem（除非是都不分区，使用根目录，才有肯可能整合在一起），所以这样的情况怎么进行 quota 的限制？")]),s._v(" "),a("p",[s._v("假设。你有 /home 这个独立的分区槽了，你只需要：")]),s._v(" "),a("ol",[a("li",[s._v("将 "),a("code",[s._v("/var/spool/mail")]),s._v("这个目录完整的移动到 "),a("code",[s._v("/home")]),s._v(" 下")]),s._v(" "),a("li",[s._v("利用 "),a("code",[s._v("ln -s /home/mail /var/spool/mail")]),s._v(" 来建立链接")]),s._v(" "),a("li",[s._v("将 "),a("code",[s._v("/home")]),s._v(" 进行 quota 的限制配置")])]),s._v(" "),a("p",[s._v("还可以依据不同的使用者与群组来设置 quota，让后以同样的方式来进行 link")])])}),[],!1,null,null,null);t.default=e.exports}}]);