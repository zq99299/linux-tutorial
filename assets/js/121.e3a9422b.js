(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{630:function(s,a,t){"use strict";t.r(a);var n=t(16),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"本章习题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#本章习题"}},[s._v("#")]),s._v(" 本章习题")]),s._v(" "),t("h2",{attrs:{id:"情景模拟题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#情景模拟题"}},[s._v("#")]),s._v(" 情景模拟题")]),s._v(" "),t("p",[s._v("LVM 可以弹性调整 filesystem 的大小，但是缺点是可能没有加速与硬件备份（与快照不同）的功能。而磁盘阵列则具有效率与备份功能，但是无法提供类似 LVM 的优点。此例中结合两者的优势，在 RAID 上使用 LVM 的功能")]),s._v(" "),t("ul",[t("li",[s._v("目标：测试在RAID 磁盘上面架构 LVM 系统")]),s._v(" "),t("li",[s._v("需求：需要具有磁盘管理的能力，包括 RAID 与 LVM")]),s._v(" "),t("li",[s._v("前提：会用到本章建立出来的 "),t("code",[s._v("/dev/vda{5,6,7}")])])]),s._v(" "),t("p",[s._v("本章不实际操作了，笔者暂时不需要深入了解这里的知识点")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分出 3 个区出来，分完之后，如下")]),s._v("\ngdisk -l /dev/vda\n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("67123200")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("69220351")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024.0")]),s._v(" MiB  FD00  Linux RAID\n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("69220352")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("71317503")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024.0")]),s._v(" MiB  FD00  Linux RAID\n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("71317504")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("73414655")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024.0")]),s._v(" MiB  FD00  Linux RAID\n \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建 RAID5 数组")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mdadm")]),s._v(" --create /dev/md0 --auto"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes --level"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" --raid-devices"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" /dev/vda"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5,6")]),s._v(",7"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\tUUID:xxx1234\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/mdadm.conf\n\tARRAY /dev/md0 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xxx1234\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 处理 LVM，这里使用默认参数")]),s._v("\npvcreate /dev/md0\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建 PV")]),s._v("\nvgcreate raidvg /dev/md0\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建立 VG")]),s._v("\nlvcreate -L "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".5G -n raidlv raidvg\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建立 LVM")]),s._v("\nlvscan\n\tACTIVE ‘/dev/raidvg/raidlv’ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.50")]),s._v(" GIB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" inherit\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件系统创建与挂载")]),s._v("\nmkfs.xfs /dev/raidvg/raidlv\nblkid /dev/raidvg/raidlv\n\t/dev/raidvg/raidlv:UUID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xxx456"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TYPE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xfs"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/fstab\n\t"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xxx456"')]),s._v(" /srv/raidlvm xfs\tdefaults "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /srv/raidlvm\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" -a\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" -Th /srv/raidlvm\n\tFilesystem\t\t\t\t  Type  Size\tUsed\tAvail\tUse%\tMounted on\t\n\t/dev/mapper/raidvg-raidlv  xfs  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".5G    33M      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".5G    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("%\t    /srv/raidlvm\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("p",[s._v("这个过程与前面的一致，只不过是先创建了 RAID，然后再改 RAID 上面创建 LVM。至于其他的基本管理方式也是和之前的那些维护指令一样，包括 RAID 热插拨机制、LVM 放大缩小机制等")]),s._v(" "),t("h2",{attrs:{id:"简答题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简答题"}},[s._v("#")]),s._v(" 简答题")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("在前一章大量新增账户范例中，如果要让每个用户具有 "),t("code",[s._v("soft/hard")]),s._v(" "),t("code",[s._v("40M/50M")]),s._v(" 的容量，如何修改这个 script？")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要先对 /home 启动 Quota 的环境后，使用如下脚本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim addaccount2.sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用脚本来创建 xfs 文件系统 Quota 实验的账户")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" myquotagrp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("username")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" myquota1 myquota2 myquota3 myquota4 myquota5 \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" -g myquotagrp "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$username")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" --stdin "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$username")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在这里增加")]),s._v("\n\txfs_quota -x -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"limit -u bsoft=40M bhard=50M '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v('"')]),s._v(" /home\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /home/myquota\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chgrp")]),s._v(" myquotagrp /home/myquota\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 改变该目录的所属群")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2770")]),s._v(" /home/myquota\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拥有者和群组有权限，这里加了个 SGID=2 的特殊权限，笔者暂时不理解是为什么")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("让 RAID 具有保护数据的功能，防止因为硬件损坏而导致数据的丢失，可以选的 RAID 等级有哪些？")]),s._v(" "),t("p",[s._v("具有备份数据的有：RAID-1、RAID-5、RAID-6")])]),s._v(" "),t("li",[t("p",[s._v("在预设的 LVM 设置中，LVM 能否具有 备份 功能？")]),s._v(" "),t("p",[s._v("可以通过快照（snopshot）功能进行数据的备份，注意需要对快照进行备份")])]),s._v(" "),t("li",[t("p",[s._v("如果你的主机提供 RAID0 功能，你将 3 块磁盘全部在 BIOS 阶段使用 RAID 芯片整合为一块大磁盘，则此磁盘在 Linux 系统中的文件名是什么？")]),s._v(" "),t("p",[s._v("因为磁盘阵列时再 BIOS 阶段完成的，因此 Linux 系统会捕捉到一块完整的 RAID 磁盘，文件名则是 "),t("code",[s._v("/dev/sda")]),s._v(" ，但如果是 intel 的芯片组，则还是可能是 "),t("code",[s._v("/dev/md127")]),s._v(" 类似的名称")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);