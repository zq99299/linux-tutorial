(window.webpackJsonp=window.webpackJsonp||[]).push([[125],{633:function(s,t,a){"use strict";a.r(t);var n=a(16),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"仅执行一次的工作排程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#仅执行一次的工作排程"}},[s._v("#")]),s._v(" 仅执行一次的工作排程")]),s._v(" "),a("h2",{attrs:{id:"atd-的启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#atd-的启动"}},[s._v("#")]),s._v(" atd 的启动")]),s._v(" "),a("p",[s._v("atd 并非所有的 distribution 都会预设打开，因此掌握他的启动和关闭等方式")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl restart atd\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新启动 atd 服务")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" atd\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开机自动启动")]),s._v("\nsystemctl status atd\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询 atd 状态")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status atd")]),s._v("\n● atd.service - Job spooling tools\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/atd.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since 五 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-06 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":31:07 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 25min ago\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1382")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("atd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    Tasks: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n   CGroup: /system.slice/atd.service\n           └─1382 /usr/sbin/atd -f\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("月 06 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":31:07 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started Job spooling tools.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面显示 enabled 和 actice(running) 标识开机启动，和正在运行中")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"at-的运行方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#at-的运行方式"}},[s._v("#")]),s._v(" at 的运行方式")]),s._v(" "),a("p",[s._v("使用 at 指令产生的工作，会以文本方式写入 "),a("code",[s._v("/var/spool/at/")]),s._v(" 目录内，该工作等待 atd 这个服务的取用与执行")]),s._v(" "),a("p",[s._v("另外为了安全，不要随意吧 at 指令执行权限下发，否则有黑客会使用定时任务来收集数据等情况")]),s._v(" "),a("p",[s._v("可以利用 "),a("code",[s._v("/etc/at.allow")]),s._v(" 和 "),a("code",[s._v("/etc/at.deny")]),s._v(" 文件来进行 at 的使用限制，加上这两个文件后，at 的工作情况如下：")]),s._v(" "),a("ol",[a("li",[s._v("先查找 "),a("code",[s._v("/etc/at.allow")]),s._v(" 文件，在该文件中的使用者才能使用 at")]),s._v(" "),a("li",[s._v("如果 "),a("code",[s._v("/etc/at.allow")]),s._v(" 不存在，就查找 "),a("code",[s._v("/etc/at.deny")]),s._v(" 文件，写在这个 "),a("code",[s._v("at.deny")]),s._v(" 中的使用者无法使用 at")]),s._v(" "),a("li",[s._v("如果两个文件都不存在，则只有 root 可以使用 at 指令")])]),s._v(" "),a("p",[s._v("那么两个文件的含义如下：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("at.allow")]),s._v("：严格限制，只有存在该文件中才能使用")]),s._v(" "),a("li",[a("code",[s._v("at.deny")]),s._v("：宽松限制，不存在该文件中则可以使用，也就是说，如果该文件是一个空文件，并且没有 at.allow 文件，那么就表示任何人都可以使用 at 指令")])]),s._v(" "),a("h2",{attrs:{id:"at-语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#at-语法"}},[s._v("#")]),s._v(" at 语法")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("at "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-mldv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" TIME\nat -c 工作号码\n\n选项与参数：\n\t-m：当 at 工作完成后，即使没有输出信息，也以 email 通知使用者该工作已完成\n\t-l：at -l 相当于 atq，列出目前系统上的所有该用户的 at 排程\n\t-d：at -d 相当于 atrm，可以取消一个再 at 排程中的工作\n\t-v：可以使用较明显的时间格式列出 at 排程中的任务栏表\n\t-c：可以列出后面接的该项工作的实际指令内容\n\t\n\tTIME：时间格式，定义什么时候要进行 at 工作的时间，格式有：\n\t\tHH:MM\t如 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(":00，在今日 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 点执行，若该时刻已过，则在明天的 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" 点执行\n\t\tHH:MM YYYY-MM-DD\t如 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(":00 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-06 ，就在该时间点执行\n\t\tHH:MM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("am"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("pm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Month"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t如：04:00pm July "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("，就在该时刻执行\n\t\tHH:MM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("am"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("pm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" + number "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("minutes"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("hours"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("days"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("weeks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\t\t\t如：now + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" minutes、04pm + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" days\n\t\t\t在某个时间点再 + 几个时间后才执行\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("可以看到，该指令的复杂的就是时间的指定了")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 1： 5 分钟后，将 /root/.bashrc 寄给 root 自己")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# at now + 5 minutes\t\t# 按回车后，输入要执行的指令")]),s._v("\nat"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /bin/mail -s "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"testing at job"')]),s._v(" root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /root/.bashrc\t\t\nat"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("EOT"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 需要使用 ctrl + d 结束输入")]),s._v("\njob "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" at Fri Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":22:00 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# at 工作已经创建，他的 ID 是 3， 会在 2020-03-06 14:22:00 执行")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上面使用 at 指令会进入 at shell 环境，让你下达多重指令的运行")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 2：将上述第 3 项工作内容查询出来")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# at -c 3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/sh\t\t\t# 可以看出来是通过 bash shell 执行的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# atrun uid=0 gid=0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mail mrcode 0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("umask")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n。。。。。\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Execution directory inaccessible'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&2")]),s._v("\n\t "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("SHELL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sh}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'marcinDELIMITER4065fff8'\n# 下面这一行就是我们要执行的指令了\n/bin/mail -s \"testing at job\" root < /root/.bashrc\n\nmarcinDELIMITER4065fff8")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("上面没有写出来的很多类容，大部分是设置了很多环境变量。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 3：由于机房预计 2020-03-08 停电，想要在 2020-03-07 23:00 关机")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# at 23:00 2020-03-07")]),s._v("\nat"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /bin/sync\nat"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /bin/sync\nat"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /sbin/shutdown -h now\nat"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("EOT"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\njob "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" at Sat Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":00:00 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("由于指令的下达与 PATH 变量有关，同时与当时的工作目录也有关联（如果涉及到文件），因此使用绝对路径来下达指令，比较不容易出问题，")]),s._v(" "),a("p",[s._v("举例说明：你在 /tmp 下达 "),a("code",[s._v("at now")]),s._v(" 然后输入 "),a("code",[s._v('mail -s "test" root < .bashrc')]),s._v(" ，那么该文件的指向则是 "),a("code",[s._v("/tmp/.bashrc")]),s._v("，"),a("strong",[s._v("因为 at 在运行时，会跑到当时下达 at 指令的那个工作目录")])]),s._v(" "),a("p",[s._v("还有一个需要注意的，at 的执行与终端机环境无关，而所有 standard output/standard error output 都会传送到执行者的 mailbox 去，所以在 at 中执行 "),a("code",[s._v('echo "Hello"')]),s._v(" ，并不会再终端机上看到该信息。有种方法可以达到显示在终端机上 "),a("code",[s._v('echo "hello" > /dev/tty1')]),s._v(" ，把输出信息定向给了具体的 tty 终端机，前提是你登录了该终端机")]),s._v(" "),a("p",[s._v("还记得 "),a("code",[s._v("-m")]),s._v(" 指令吗，如果 at 执行后，没有输出任何信息，则不会发送 email 给执行者的，使用 -m 指定之后，无论有没有输出信息，都会发送")]),s._v(" "),a("p",[s._v("还有 at 是在背景执行的，与 bash 的 nohup（第 16 章）类似，系统会将该项 at 工作独立出你的 bash 环境中，直接交给系统的 atd 程序来接管，因此下达了 at 的工作后，就可以脱机了（你断开登录的 tty 之后，不会让 at 执行工作也失效）。")]),s._v(" "),a("h2",{attrs:{id:"at-工作的管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#at-工作的管理"}},[s._v("#")]),s._v(" at 工作的管理")]),s._v(" "),a("p",[s._v("可以对 at 的查询和移除等工作")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("atq\natrm "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jobnumber"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 1：查询目前主机上有多少 at 工作排程")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# atq")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编号\t日期\t\t\t\t\t谁下达的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\tSat Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":00:00 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" a root\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里看不出来内容，还可以利用上面的  at -c 5 来确认")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# at -c 5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("SHELL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sh}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'marcinDELIMITER464e26fe'")]),s._v("\n/bin/sync\n/bin/sync\n/sbin/shutdown -h now\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里就能看到，是上面关机的任务")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 2： 删除上面的任务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# atrm 5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# atq")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 没有信息输出，标识没有任务了")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h2",{attrs:{id:"batch：系统空闲时才进行背景任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#batch：系统空闲时才进行背景任务"}},[s._v("#")]),s._v(" batch：系统空闲时才进行背景任务")]),s._v(" "),a("p",[s._v("batch 会再 CPU 的工作负载小于 0.8 的时候，才进行 at 中的任务；")]),s._v(" "),a("p",[s._v("工作负载：CPU 在单一时间点所负责的工作数量，不是 CPU 使用率。比如：有一个程序需要一直使用 CPU 运算功能，那么 CPU 的使用率可能达到 100%，但是 CPU 的工作负载则是趋近于 1，如果有两个这样的程序，那么 CPU 使用率还是 100%，但是工作负载就变成了 2，也就是可以看成为多线程，CPU 同时为几个线程提供服务")]),s._v(" "),a("p",[s._v("所以 CPU 工作负载越大，CPU 越忙碌")]),s._v(" "),a("p",[s._v("CentOS 下的 batch 已经不再支持时间参数了，因此 batch 可以拿来作为判断是否要立刻执行背景程序的依据，为了模拟 CPU 较高的工作负载，使用 12 章里面的计算 PI 的脚本，连续执行 4 次这样的程序。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "scale=100000; 4*a(1)" | bc -lq &')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4677")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "scale=100000; 4*a(1)" | bc -lq &')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4679")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "scale=100000; 4*a(1)" | bc -lq &')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4681")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "scale=100000; 4*a(1)" | bc -lq &')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4683")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uptime 查看负载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uptime")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":04:28 up  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(":33,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" user,  load average: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.47")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.11")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.08")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uptime")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":04:33 up  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(":33,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" user,  load average: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.75")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.18")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.10")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uptime")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":04:39 up  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(":34,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" user,  load average: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.33")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.32")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.15")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到，平均负载飙升到 1.33 了")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# batch")]),s._v("\nat"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/bin/updatedb\nat"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("EOT"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\njob "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" at Fri Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":05:00 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# date;atq")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("年 03月 06日 星期五 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":06:25 CST\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\tFri Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":05:00 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" b root\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到，时间已经过了，缺没有执行  at 任务")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# jobs")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   Running                 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scale=100000; 4*a(1)"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bc")]),s._v(" -lq "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   Running                 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scale=100000; 4*a(1)"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bc")]),s._v(" -lq "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("-  Running                 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scale=100000; 4*a(1)"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bc")]),s._v(" -lq "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("+  Running                 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scale=100000; 4*a(1)"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bc")]),s._v(" -lq "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 jobs 找出背景功能，再使用 kill 删除掉 4 个背景工作后，等待工作负载的下降")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kill -9 %1 %2 %3 %4")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 需要等待工作负载降低到 0.8 以下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uptime; atq")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":09:32 up  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(":38,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" user,  load average: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.29")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.30")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.10")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\tFri Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":05:00 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" b root\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uptime; atq")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":09:38 up  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(":39,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" user,  load average: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.10")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.27")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.09")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\tFri Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":05:00 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" b root\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uptime; atq")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":11:20 up  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(":40,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" user,  load average: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.52")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.63")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.99")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\tFri Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":05:00 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" root\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uptime; atq")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":11:21 up  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(":40,  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" user,  load average: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.52")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.63")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.99")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里降低到 0.52 还能看到还没有执行，多等待下，就会发现不执行了，")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个是因为指令的执行完成也需要一定时间的")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br")])]),a("p",[s._v("平均工作负载：是统计的 1 分钟内的平均值，当小于 0.8之后的「整分钟时间」，atd 会执行 batch 的工作")]),s._v(" "),a("p",[s._v("整分钟时间：无论 at 还是 crontab，他们最小的时间单位是分钟，所以基本上，他们工作是 "),a("strong",[s._v("每分钟检查一次")]),s._v(" ，就是整分（秒为 9 的时候）。另外 batch 也是使用 atq/atrm 来管理的")])])}),[],!1,null,null,null);t.default=e.exports}}]);