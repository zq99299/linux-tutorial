(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{570:function(s,a,t){"use strict";t.r(a);var n=t(16),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"内存交换空间（swap）之建置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#内存交换空间（swap）之建置"}},[s._v("#")]),s._v(" 内存交换空间（swap）之建置")]),s._v(" "),t("p",[s._v("早期年代因为内存不足，因此可以暂时将内存的程序拿到硬盘中暂放的内存置换空间（swap）就显得非常重要，所以之前老见到说安装 linux 一定需要两个 partition，一个是根目录，另一个就是 swap 了")]),s._v(" "),t("p",[s._v("一般来说，如果硬件资源配置足够的话，swap 应该不会被系统使用到。会被用到的时候，通常就是物理内存不足的情况了。在用到 swap 时，你的主机磁盘灯就会开始闪个不停")]),s._v(" "),t("p",[s._v("但是你不能预估不会存在物理内存不够用的情况，所以预留 swap 是有必要的，特别是在服务器上，不知道什么时候会有大量的网络请求。")]),s._v(" "),t("p",[s._v("假如现在有这样一种情况：系统已经建立起来了，但是却发现没有建立 swap，那么可以通过如下的方式来做")]),s._v(" "),t("ul",[t("li",[s._v("设置一个 swap partition")]),s._v(" "),t("li",[s._v("建立一个虚拟内存的文件")])]),s._v(" "),t("h2",{attrs:{id:"使用实体分区槽建立-swap"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用实体分区槽建立-swap"}},[s._v("#")]),s._v(" 使用实体分区槽建立 swap")]),s._v(" "),t("p",[s._v("步骤如下")]),s._v(" "),t("ol",[t("li",[s._v("分区：使用 gdisk 在磁盘中分区出一个分区槽给系统作为 swap。")]),s._v(" "),t("li",[s._v("格式化：利用建立 swap 格式的 「mkswap 装置文件名」就能够格式化该分区槽成为 swap 格式")]),s._v(" "),t("li",[s._v("使用：最后将该 swap 装置启动，方法为「swapon 装置文件名」")]),s._v(" "),t("li",[s._v("观察：通过 free 与 swapon -s 指令来观察内存的用量")])]),s._v(" "),t("h3",{attrs:{id:"_1-分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-分区"}},[s._v("#")]),s._v(" 1. 分区")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gdisk /dev/sda")]),s._v("\nGPT "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("fdisk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("gdisk"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.8")]),s._v(".10\n\nPartition table scan:\n  MBR: protective\n  BSD: not present\n  APM: not present\n  GPT: present\n\nFound valid GPT with protective MBR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" using GPT.\n\nCommand "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("? "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": n\nPartition number "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("-128, default "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": \nFirst sector "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v("-85491678, default "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("69220352")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("+-"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("size"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("KMGTP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(": \nLast sector "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("69220352")]),s._v("-85491678, default "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("85491678")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("+-"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("size"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("KMGTP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(": +512M\nCurrent "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" is "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Linux filesystem'")]),s._v("\nHex code or GUID "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("L to show codes, Enter "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8300")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8200")]),s._v("\n\nCommand "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("? "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": p\nDisk /dev/sda: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("85491712")]),s._v(" sectors, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("40.8")]),s._v(" GiB\nLogical sector size: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nDisk identifier "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GUID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 67038DBF-B66A-4D0F-92B2-BFBF0744CD1D\nPartition table holds up to "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v(" entries\nFirst usable sector is "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v(", last usable sector is "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("85491678")]),s._v("\nPartitions will be aligned on "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("-sector boundaries\nTotal "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" space is "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15224765")]),s._v(" sectors "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.3")]),s._v(" GiB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nNumber  Start "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    End "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  Size       Code  Name\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6143")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v(" MiB     EF02  \n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6144")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2103295")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024.0")]),s._v(" MiB  0700  \n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2103296")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65026047")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30.0")]),s._v(" GiB    8E00  \n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65026048")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("67123199")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024.0")]),s._v(" MiB  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8300")]),s._v("  Linux filesystem\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("67123200")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("69220351")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024.0")]),s._v(" MiB  0700  Microsoft basic data\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("69220352")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("70268927")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("512.0")]),s._v(" MiB   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8200")]),s._v("  Linux swap\n\nCommand "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("? "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": w\n\nFinal checks complete. About to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v(" GPT data. THIS WILL OVERWRITE EXISTING\nPARTITIONS"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\nDo you want to proceed? "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Y/N"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": y\nOK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" writing new GUID partition table "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GPT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to /dev/sda.\nWarning: The kernel is still using the old partition table.\nThe new table will be used at the next reboot.\nThe operation has completed successfully.\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 刷新分区")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsblk")]),s._v("\nNAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT\nsda               "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(":0    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v(".8G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk \n├─sda1            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(":1    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    2M  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part \n├─sda2            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(":2    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    1G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part /boot\n├─sda3            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(":3    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   30G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part \n│ ├─centos-root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":0    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   10G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm  /\n│ ├─centos-swap "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":1    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    1G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SWAP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n│ └─centos-home "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v(":2    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    5G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" lvm  /home\n├─sda4            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(":4    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    1G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part /data/xfs\n├─sda5            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(":5    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    1G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part \n└─sda6            "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(":6    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  512M  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part   \t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 出现了")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br")])]),t("h3",{attrs:{id:"_2-建立-swap-格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-建立-swap-格式"}},[s._v("#")]),s._v(" 2. 建立 swap 格式")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkswap /dev/sda6")]),s._v("\n正在设置交换空间版本 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("，大小 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("524284")]),s._v(" KiB\n无标签，UUID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("89727d5b-a222-4878-be50-19bbb61cabb0\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 确实可以抓到该装置了")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# blkid /dev/sda6")]),s._v("\n/dev/sda6: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"89727d5b-a222-4878-be50-19bbb61cabb0"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TYPE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"swap"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PARTLABEL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Linux swap"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PARTUUID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5fff6d01-b73a-45c2-be69-8fc4a67e0788"')]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"_3-开始观察看看"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-开始观察看看"}},[s._v("#")]),s._v(" 3. 开始观察看看")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# free")]),s._v("\n              total        used        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("      shared  buff/cache   available\nMem:        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1190952")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("389504")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("83364")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10916")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("718084")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("640164")]),s._v("\nSwap:       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048572")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048572")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# free -h")]),s._v("\n              total        used        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("      shared  buff/cache   available\nMem:           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".1G        380M         81M         10M        701M        625M\nSwap:          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".0G          0B        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".0G\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出目前使用的 swap 装置有哪些")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# swapon -s")]),s._v("\n文件名                          类型            大小    已用    权限\n/dev/dm-1                               partition       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048572")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       -2\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 swapon 指令挂载 swap 分区槽")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# swapon /dev/sda6")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# free")]),s._v("\n              total        used        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("      shared  buff/cache   available\nMem:        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1190952")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("389848")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("82492")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10916")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("718612")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("639820")]),s._v("\nSwap:       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1572856")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1572856")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# swapon -s")]),s._v("\n文件名                          类型            大小    已用    权限\n/dev/dm-1                               partition       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048572")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       -2\n/dev/sda6                               partition       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("524284")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       -3\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到这里 sda6 被用上了")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建立永久挂载")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" /etc/fstab\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里是文件系统，所以没有挂载点，第二个字段写 swap")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"89727d5b-a222-4878-be50-19bbb61cabb0"')]),s._v(" swap swap defaults "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("h2",{attrs:{id:"使用文件建立-swap"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用文件建立-swap"}},[s._v("#")]),s._v(" 使用文件建立 swap")]),s._v(" "),t("p",[s._v("如果是在四题分区槽无法支持的环境下，可以使用上一小节中提到的 loop 装置来建立")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dd if=/dev/zero of=/tmp/swap bs=1M count=128")]),s._v("\n记录了128+0 的读入\n记录了128+0 的写出\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("134217728")]),s._v("字节"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("134")]),s._v(" MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("已复制，0.0852543 秒，1.6 GB/秒\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll -h /tmp/swap ")]),s._v("\n-rw-r--r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root 128M "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("月 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":22 /tmp/swap\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 格式化的时候一定要特别注意，路径不要错，否则有可能搞垮你的文件系统")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkswap /tmp/swap ")]),s._v("\n正在设置交换空间版本 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("，大小 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("131068")]),s._v(" KiB\n无标签，UUID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("977e598a-ff20-4be9-bc28-7792c19bfe32\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# swapon /tmp/swap")]),s._v("\nswapon: /tmp/swap：不安全的权限 0644，建议使用 0600。\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# swapon -s")]),s._v("\n文件名                          类型            大小    已用    权限\n/dev/dm-1                               partition       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048572")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       -2\n/dev/sda6                               partition       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("524284")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       -3\n/tmp/swap                               "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("131068")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       -4\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 swapoff 指令关掉刚才手动挂载的两个挂载点，并配置自动挂载")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建立永久挂载")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" /etc/fstab\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 增加配置")]),s._v("\n/tmp/swap swap swap defaults "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭手动挂载的挂载点")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# swapoff /dev/sda6 /tmp/swap")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# swapon -s")]),s._v("\n文件名                          类型            大小    已用    权限\n/dev/dm-1                               partition       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048572")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       -2\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 手动挂载所有，再查看下，配置正确")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# swapon -a")]),s._v("\nswapon: /tmp/swap：不安全的权限 0644，建议使用 0600。\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# swapon -s")]),s._v("\n文件名                          类型            大小    已用    权限\n/dev/dm-1                               partition       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048572")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       -2\n/dev/sda6                               partition       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("524284")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       -3\n/tmp/swap                               "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("131068")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       -4\n\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br")])]),t("p",[s._v("swap 主要功能是当物理内存不够时，则某些在内存中所占的程序会暂时被移动到 swap 中，让物理内存可以被需要的程序来使用。另外，如果主机支持电源管理模式，也就是说使用「休眠」功能的话，运行中的程序状态则会被记录到 swap 中去，以作为「唤醒」主机的状态依据。另外某些程序会利用 swap 的特性来存放一些数据，所以 swap 需要建立，只是不需要太大")])])}),[],!1,null,null,null);a.default=e.exports}}]);