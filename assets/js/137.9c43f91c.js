(window.webpackJsonp=window.webpackJsonp||[]).push([[137],{649:function(s,t,a){"use strict";a.r(t);var n=a(16),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"通过-systemctl-管理服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过-systemctl-管理服务"}},[s._v("#")]),s._v(" 通过 systemctl 管理服务")]),s._v(" "),a("p",[s._v("基本那个，systemd 启动服务的机制，主要是通过 systemctl 指令来处理。")]),s._v(" "),a("p",[s._v("而以前的 systemV 需要 service、chkconfig、setup、init 等指令来完成。")]),s._v(" "),a("h2",{attrs:{id:"管理单一服务-service-unit-的启动、开机启动与观察状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#管理单一服务-service-unit-的启动、开机启动与观察状态"}},[s._v("#")]),s._v(" 管理单一服务 service unit 的启动、开机启动与观察状态")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\ncommond 主要有：\n\tstart： 立刻启动后面的 unit\n\tstop：立刻关闭后面的 unit\n\trestart：立刻关闭后启动后面的 unit\n\treload：不关闭后面的 unit 的情况下，重载配置文件，让设置生效\n\tenable：设置开机启动\n\tdisable：取消开机启动\n\tstatus：列出 unit 有没有正在执行、开机预设执行、登录等信息\n\tis-active：目前是否在运行\n\tis-enable：是否开机启动\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 1：看看目前 atd 这个服务的状态")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status atd.service ")]),s._v("\n* atd.service - Job spooling tools\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/atd.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Tue "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-17 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:55 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" day 5h ago\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1398")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("atd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    Tasks: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n   CGroup: /system.slice/atd.service\n           `-1398 /usr/sbin/atd -f\n\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:55 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started Job spooling tools.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重点在第 2、3 行数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Loaded：开机是否启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Active：是否正在运行中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最后一行：该服务的启动信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 登录文件格式为：时间、信息发送主机、哪一个服务的信息、实际信息内容")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 2：正常关闭 atd 服务，非 kill -9")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop atd.service ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status atd.service ")]),s._v("\n* atd.service - Job spooling tools\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/atd.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: inactive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dead"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Wed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-18 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":40:06 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 13s ago\n  Process: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1398")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/sbin/atd -f "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OPTS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("exited, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/SUCCESS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1398")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("exited, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/SUCCESS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:55 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started Job spooling tools.\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":40:06 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Stopping Job spooling tools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":40:06 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Stopped Job spooling tools.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这下就明白了。后面两行信息是执行 stop 后发生的事件日志信息")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("不要使用 kill 的方式来关掉一个正常的服务，否则 systemctl 无法监控该服务。上面信息的 Active 状态有如下几个常见的状态：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("active（running）：有一个或多个程序正在运行")])]),s._v(" "),a("li",[a("p",[s._v("active（exited）：仅执行一次就正常结束的服务，目前并没有任何程序在系统中执行。")]),s._v(" "),a("p",[s._v("比如：开机或是挂载时才会进行一次的 quotaon 功能，就是这种模式，quotaon 不需要一直执行，只需要执行一次之后，就交给文件系统自行处理了。通常用 bash shell 写的小型服务，大多属于此种类型（无需常驻内存）")])]),s._v(" "),a("li",[a("p",[s._v("active（waiting）：正在执行中中，不过在在等待其他的事件才能继续处理")])]),s._v(" "),a("li",[a("p",[s._v("inactive：这个服务目前没有运行")])])]),s._v(" "),a("p",[s._v("开机预设状态有以下：")]),s._v(" "),a("ul",[a("li",[s._v("enabled：开机执行")]),s._v(" "),a("li",[s._v("disabled：开机不执行")]),s._v(" "),a("li",[s._v("static：不可以自己启动。不过可能会被其他的 enabled 的服务来唤醒（依赖服务）")]),s._v(" "),a("li",[s._v("mask：无法被启动，因为已经被强制注销（非删除）。可通过 systemctl unmask 方式改回原本的状态")])]),s._v(" "),a("h3",{attrs:{id:"服务启动、关闭与观察联系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务启动、关闭与观察联系"}},[s._v("#")]),s._v(" 服务启动、关闭与观察联系")]),s._v(" "),a("p",[s._v("习题 1：找到系统中名为 chronyd 的服务，观察此服务状态，并将服务设置为：")]),s._v(" "),a("ol",[a("li",[s._v("开机不会启动")]),s._v(" "),a("li",[s._v("现在状态是关闭的情况")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status chronyd.service ")]),s._v("\n* chronyd.service - NTP client/server\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开机启动")]),s._v("\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/chronyd.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 正在运行中")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Tue "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-17 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:42 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" day 6h ago\n     Docs: man:chronyd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n           man:chrony.conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    Tasks: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n   CGroup: /system.slice/chronyd.service\n           `-933 /usr/sbin/chronyd\n\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:39 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Starting NTP client/server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:39 study.centos.mrcode chronyd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("933")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": chronyd version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.4")]),s._v(" starting "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("+CMDMON +NTP +REFCLOCK +RTC +PRIVDROP +SCFILTER +SIGND +ASYNCDNS +SECHASH +IPV6 +DEBUG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:39 study.centos.mrcode chronyd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("933")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Frequency "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000")]),s._v(" +/- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000000.000")]),s._v(" ppm "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" from /var/lib/chrony/drift\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:42 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Permission denied "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" opening PID "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" or unsafe symlink chain: /var/run/chrony/chronyd.pid\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:42 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started NTP client/server.\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消开机启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl disable chronyd.service ")]),s._v("\nRemoved symlink /etc/systemd/system/multi-user.target.wants/chronyd.service.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消开机启动，这里其实就是移除了 /etc/systemd/system 该目录下的一个链接文件")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止该服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop chronyd.service ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status chronyd.service ")]),s._v("\n* chronyd.service - NTP client/server\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/chronyd.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: inactive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dead"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     Docs: man:chronyd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n           man:chrony.conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:39 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Starting NTP client/server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:39 study.centos.mrcode chronyd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("933")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": chronyd version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.4")]),s._v(" starting "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("+CMDMON +NTP +REFCLOCK +RTC +PRIVDROP +SCFILTER +SIGND +ASYNCDNS +SECHASH +IPV6 +DEBUG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:39 study.centos.mrcode chronyd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("933")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Frequency "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.000")]),s._v(" +/- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000000.000")]),s._v(" ppm "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" from /var/lib/chrony/drift\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:42 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Permission denied "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" opening PID "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" or unsafe symlink chain: /var/run/chrony/chronyd.pid\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:42 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started NTP client/server.\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":53:11 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Stopping NTP client/server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":53:11 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Stopped NTP client/server.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br")])]),a("p",[s._v("习题 2：将 cups 服务整个关闭（因为没有打印机安装在服务器上，也没有网络打印机）")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status cups.service ")]),s._v("\n* cups.service - CUPS Printing Service\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/cups.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 书上这里状态是 inactive(dead) 没有运行状态，笔者这里确实在运行状态")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Tue "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-17 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:55 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" day 6h ago\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1374")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cupsd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   CGroup: /system.slice/cups.service\n           "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("-1374 /usr/sbin/cupsd -f\n\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:55 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started CUPS Printing Service.\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop cups.service ")]),s._v("\nWarning: Stopping cups.service, but it can still be activated by:\n  cups.path\n  cups.socket\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消开机启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl disable cups.service ")]),s._v("\nRemoved symlink /etc/systemd/system/multi-user.target.wants/cups.path.\nRemoved symlink /etc/systemd/system/multi-user.target.wants/cups.service.\nRemoved symlink /etc/systemd/system/sockets.target.wants/cups.socket.\nRemoved symlink /etc/systemd/system/printer.target.wants/cups.service.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里一共移除了 4 个连结文件，说明这几个文件可能是相依赖性")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -tlunp | grep cups")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cups 服务没有被启动，所以没有端口产生")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 尝试启动 cups.socket 监听客户端的需求")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start cups.socket")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status cups.service cups.socket cups.path ")]),s._v("\n* cups.service - CUPS Printing Service\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/cups.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: inactive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dead"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Wed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-18 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":57:19 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 4min 8s ago\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1374")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("exited, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/SUCCESS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:55 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started CUPS Printing Service.\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":57:19 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Stopping CUPS Printing Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":57:19 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Stopped CUPS Printing Service.\n\n* cups.socket - CUPS Printing Service Sockets\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/cups.socket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("listening"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Tue "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-17 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:38 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" day 6h ago\n   Listen: /var/run/cups/cups.sock "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Stream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:38 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Listening on CUPS Printing Service Sockets.\n\n* cups.path - CUPS Printer Service Spool\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/cups.path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("waiting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Tue "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-17 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:38 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" day 6h ago\n\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":49:38 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started CUPS Printer Service Spool.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 笔者这里和书上又不一样，书上 cups.path 是 inactive(dead) 状态，我这里则是等待状态")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 尝试使用 lp 指令打印")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "testing" | lp')]),s._v("\nlp: Error - no default destination available.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 实际上没有打印机，出现错误也正常")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status cups.service                       ")]),s._v("\n* cups.service - CUPS Printing Service\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/cups.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 被启动了")]),s._v("\n   Active: active "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("running"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Wed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-18 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":03:17 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 41s ago\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23325")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cupsd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    Tasks: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n   CGroup: /system.slice/cups.service\n           "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("-23325 /usr/sbin/cupsd -f\n\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":03:17 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started CUPS Printing Service.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -tlunp | grep cups")]),s._v("\ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:631           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23325")]),s._v("/cupsd         \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ::1:631                 :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23325")]),s._v("/cupsd \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里竟然被自动启动了，我们刚刚操作命名是 stop 了这个服务")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br")])]),a("p",[s._v("上面例子充分演示了很多服务之间是有相依性的，cups 是一种打印服务，会启用 631 port 来提供网络打印机的打印功能。但是我们无需一直启动 631 的端口，因此，多了一个 cups.socket 的服务，这个服务可以在「用户有需要打印时，才会主动唤醒 cups.service」，由于有了这个特性，所以就算事先吧 3 个 cups 的服务都 stop 掉，当用户向其他两个 cups.path、cups.socket 提出要求时， cups.service 就会被唤醒")]),s._v(" "),a("h3",{attrs:{id:"强迫服务注销-mask-的练习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#强迫服务注销-mask-的练习"}},[s._v("#")]),s._v(" 强迫服务注销 mask 的练习")]),s._v(" "),a("p",[s._v("比较正常的做法是：要关闭 cups.service 时，连同其他两个会唤醒 service 的 cups.socket 与 cups.path 都关闭，那就没有事情了。")]),s._v(" "),a("p",[s._v("不正常的做法是：强迫 cups.service 注销，通过 mask 方式")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop cups.service ")]),s._v("\nWarning: Stopping cups.service, but it can still be activated by:\n  cups.socket\n  cups.path\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl mask cups.service ")]),s._v("\nCreated symlink from /etc/systemd/system/cups.service to /dev/null.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status cups.service ")]),s._v("\n* cups.service\n   Loaded: masked "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/dev/null"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" bad"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: inactive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dead"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Wed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-18 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":11:29 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 32s ago\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23325")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("exited, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/SUCCESS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":03:17 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started CUPS Printing Service.\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":11:29 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Stopping CUPS Printing Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":11:29 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Stopped CUPS Printing Service.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start cups.service ")]),s._v("\nFailed to start cups.service: Unit is masked.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("通过 mask 之后，他的连结文件被连结到了 "),a("code",[s._v("/dev/null")]),s._v("，所以就无法启动了")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消注销")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl unmask cups.service ")]),s._v("\nRemoved symlink /etc/systemd/system/cups.service.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status cups.service ")]),s._v("\n* cups.service - CUPS Printing Service\n   Loaded: loaded "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/usr/lib/systemd/system/cups.service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" disabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" vendor preset: enabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   Active: inactive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dead"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Wed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-18 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":11:29 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 2min 30s ago\n Main PID: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23325")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("exited, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/SUCCESS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":03:17 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Started CUPS Printing Service.\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":11:29 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Stopping CUPS Printing Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":11:29 study.centos.mrcode systemd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Stopped CUPS Printing Service.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 恢复正常了")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h2",{attrs:{id:"观察系统上所有的服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#观察系统上所有的服务"}},[s._v("#")]),s._v(" 观察系统上所有的服务")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("TYPE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--all"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\ncommand：\n\tlist-units：按 unit 列出目前有启动的 unit。若加上 --all 才会列出没有启动的\n\tlist-unit-files：按 "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("/usr/lib/systemd/system"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" 内的文件，将所有文件列表说明\n--type：之前提到过的 unit type，主要有 service、socket、target 等\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("范例 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("：列出系统上有启动的 unit\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl")]),s._v("\nUNIT                                                                                     LOAD   ACTIVE SUB       DESCRIPTION\nproc-sys-fs-binfmt_misc.automount                                                        loaded active waiting   Arbitrary Executable File Formats File System Automount Point\nsys-devices-pci0000:00-0000:00:03.0-net-enp0s3.device                                    loaded active plugged   82540EM Gigabit Ethernet Controller "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PRO/1000 MT Desktop Adapter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsys-devices-pci0000:00-0000:00:05.0-sound-card0.device                                   loaded active plugged   82801AA AC"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'97 Audio Controller\nsys-devices-pci0000:00-0000:00:0d.0-ata3-host2-target2:0:0-2:0:0:0-block-sda-sda1.device loaded active plugged   VBOX_HARDDISK 1\n...\nvsftpd.service  loaded active running   Vsftpd ftp daemon\n\nLOAD   = Reflects whether the unit definition was properly loaded.\nACTIVE = The high-level unit activation state, i.e. generalization of SUB.\nSUB    = The low-level unit activation state, values depend on unit type.\n\n152 loaded units listed. Pass --all to see loaded but inactive units, too.\nTo show all installed unit files use '")]),s._v("systemctl list-unit-files'.\nlines "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("106")]),s._v("-160/160 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("END"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务太多了，个别字段含义如下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# UNIT：项目名称，包括各个 unit 的类型（看扩展名）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LOAD：开机时是否会被加载，默认 systemctl 显示的是有加载的项目")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ACTIVE：目前的状态，续与后续的 SUB 搭配，就是用 systemctl status 观察时，active 项目")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# DESCRIPTION：详细描述")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 另外，systemctl 不加参数，预设是 list-units ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 2：列出所有已经安装的 unit 有哪些")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl list-unit-files ")]),s._v("\nUNIT FILE                                     STATE   \nproc-sys-fs-binfmt_misc.automount             static  \ndev-hugepages.mount                           static  \ndev-mqueue.mount                              static  \nproc-fs-nfsd.mount                            static  \nproc-sys-fs-binfmt_misc.mount                 static  \nsys-fs-fuse-connections.mount                 static  \nsys-kernel-config.mount                       static  \nsys-kernel-debug.mount                        static  \ntmp.mount                                     disabled\nvar-lib-nfs-rpc_pipefs.mount                  static  \nbrandbot.path                                 disabled\ncups.path                                     disabled\nsystemd-ask-password-console.path             static  \nsystemd-ask-password-plymouth.path            static  \nsystemd-ask-password-wall.path                static  \nsession-2.scope                               static  \nsession-92.scope                              static  \nsession-c1.scope                              static  \nabrt-ccpp.service                             enabled \nabrt-oops.service                             enabled \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 会将系统上所有的服务都列出来，STATE 则是前面讲到过的")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 3：只列出某种类型的 unit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这样就只会显示 .service 类型的服务了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl list-units --type=service --all")]),s._v("\n  UNIT                                                  LOAD      ACTIVE   SUB     DESCRIPTION\n  abrt-ccpp.service                                     loaded    active   exited  Install ABRT coredump hook\n  abrt-oops.service                                     loaded    active   running ABRT kernel log watcher\n  abrt-vmcore.service                                   loaded    inactive dead    Harvest vmcores "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" ABRT\n  abrt-xorg.service                                     loaded    active   running ABRT Xorg log watcher\n  abrtd.service                                         loaded    active   running ABRT Automated Bug Reporting Tool\n  accounts-daemon.service                               loaded    active   running Accounts Service\n  alsa-restore.service                                  loaded    inactive dead    Save/Restore Sound Card State\n  alsa-state.service                                    loaded    active   running Manage Sound Card State "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("restore and store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n* apparmor.service                                      not-found inactive dead    apparmor.service\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查找是否有 cpu 为名的服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl list-units --type=service --all | grep cpu")]),s._v("\n  cpupower.service                                      loaded    inactive dead    Configure CPU power related settings\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CPU 电源管理机制的服务 ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h2",{attrs:{id:"管理不同的操作环境（target-unit）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#管理不同的操作环境（target-unit）"}},[s._v("#")]),s._v(" 管理不同的操作环境（target unit）")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl list-units --type=target --all            ")]),s._v("\n  UNIT                   LOAD      ACTIVE   SUB    DESCRIPTION\n  basic.target           loaded    active   active Basic System\n  cryptsetup.target      loaded    active   active Local Encrypted Volumes\n* dbus.target            not-found inactive dead   dbus.target\n  emergency.target       loaded    inactive dead   Emergency Mode\n  final.target           loaded    inactive dead   Final Step\n  getty-pre.target       loaded    active   active Login Prompts "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Pre"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  getty.target           loaded    active   active Login Prompts\n  graphical.target       loaded    active   active Graphical Interface\n  local-fs-pre.target    loaded    active   active Local File Systems "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Pre"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  local-fs.target        loaded    active   active Local File Systems\n  multi-user.target      loaded    active   active Multi-User System\n  network-online.target  loaded    active   active Network is Online\n  network-pre.target     loaded    active   active Network "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Pre"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  network.target         loaded    active   active Network\n  nfs-client.target      loaded    active   active NFS client services\n  nss-lookup.target      loaded    inactive dead   Host and Network Name Lookups\n  nss-user-lookup.target loaded    active   active User and Group Name Lookups\n  paths.target           loaded    active   active Paths\n  remote-fs-pre.target   loaded    active   active Remote File Systems "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Pre"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  remote-fs.target       loaded    active   active Remote File Systems\n  rescue.target          loaded    inactive dead   Rescue Mode\n  rpc_pipefs.target      loaded    active   active rpc_pipefs.target\n  rpcbind.target         loaded    active   active RPC Port Mapper\n  shutdown.target        loaded    inactive dead   Shutdown\n  slices.target          loaded    active   active Slices\n  sockets.target         loaded    active   active Sockets\n  sound.target           loaded    active   active Sound Card\n  swap.target            loaded    active   active Swap\n  sysinit.target         loaded    active   active System Initialization\n* syslog.target          not-found inactive dead   syslog.target\n  time-sync.target       loaded    inactive dead   System Time Synchronized\n  timers.target          loaded    active   active Timers\n  umount.target          loaded    inactive dead   Unmount All Filesystems\n\nLOAD   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Reflects whether the unit definition was properly loaded.\nACTIVE "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" The high-level unit activation state, i.e. generalization of SUB.\nSUB    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" The low-level unit activation state, values depend on unit type.\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v(" loaded "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("units")]),s._v(" listed.\nTo show all installed unit files use "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'systemctl list-unit-files'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br")])]),a("p",[s._v("笔者这里与书上也不太一样（可能还是因为系统版本的原因，我的比较新一点），有 33 个 target unit，与操作界面相关性较高的 target 主要有下面几个")]),s._v(" "),a("ul",[a("li",[s._v("graphical.target：文字 + 图形界面，该项目已包含了下面的 multi-user.target 项目")]),s._v(" "),a("li",[s._v("multi-user.target：纯文本模式")]),s._v(" "),a("li",[s._v("rescue.target：在无法使用 root 登录的情况下，systemd 在开机时会多加一个额外的暂时系统，与你原本的系统无关。这时就可以取得 root 的权限来维护你的系统。由于是额外的系统，可能需要使用 chroot 方式来取得原有的系统（后续会讲解）")]),s._v(" "),a("li",[s._v("emergency.target：紧急处理系统的错误，需要使用 root 登录的情况，在无法使用 rescue.target 时，可以尝试使用该模式")]),s._v(" "),a("li",[s._v("shutdown.target：关机流程")]),s._v(" "),a("li",[s._v("getty.target：可以设置你需要几个 tty 之类的，如果想要降低 tty 的项目，可以修改该配置文件")])]),s._v(" "),a("p",[s._v("按功能分类如下：")]),s._v(" "),a("ul",[a("li",[s._v("正常模式：graphical.target、multi-user.target")]),s._v(" "),a("li",[s._v("救援模式：rescue.target、emergency.target")])]),s._v(" "),a("p",[s._v("如何获取当前的模式与修改")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unit.target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\ncommand：\n\tget-default：取得目前的 target\n\tset-default：将 target 设置为默认的操作模式\n\tisolate：切换到后面指定的操作模式\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 1：我们的测试机器默认是图形界面，先观察是否是图形模式，再将默认模式设置为文字模式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl get-default ")]),s._v("\ngraphical.target\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 果真是")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl set-default multi-user.target ")]),s._v("\nRemoved symlink /etc/systemd/system/default.target.\nCreated symlink from /etc/systemd/system/default.target to /usr/lib/systemd/system/multi-user.target.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl get-default ")]),s._v("\nmulti-user.target\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 已切换到文字模式为默认模式了")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 2：在不重新启动的情况下，将目前的操作环境改为纯文本模式，关掉图形界面")]),s._v("\nsystemctl isolate multi-user.target\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 3：切换到图形界面")]),s._v("\nsystemctl isolate graphical.target\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("注意：在 service 部分用 start、stop、restart ，在 target 中使用 上述提到的指令，isolate 切换；还提供了几个简单直观的指令使用")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl poweroff\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 系统关机")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("reboot")]),s._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新启动")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("suspend")]),s._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入暂停模式")]),s._v("\nsystemctl hibernate\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入休眠模式")]),s._v("\nsystemctl rescue\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制进入救援模式")]),s._v("\nsystemctl emergency\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制进入紧急救援模式")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("suspend：暂停模式")]),s._v(" "),a("p",[s._v("该模式会将系统的状态数据保存在内存中，然后关闭掉大部分的系统硬件，当用户按下唤醒机器的按钮，系统数据会从内存中恢复，然后重新驱动被大部分关闭的硬件，唤醒速度很快；")])]),s._v(" "),a("li",[a("p",[s._v("hibernate：休眠模式")]),s._v(" "),a("p",[s._v("将系统状态保存到硬盘中，保存完成后，计算机关闭。当用户尝试唤醒系统时，会开始正常工作，然后将保存在硬盘中的系统状态恢复回来。由于数据从硬盘读取，所以唤醒效率与硬盘速度有关")])])]),s._v(" "),a("h2",{attrs:{id:"分析个服务之间的相依性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分析个服务之间的相依性"}},[s._v("#")]),s._v(" 分析个服务之间的相依性")]),s._v(" "),a("p",[s._v("本章开始讲到过 systemd 相依性的问题客服，那么，如何追踪某一个 unit 的相依性呢？比如怎么知道 "),a("code",[s._v("graphical.target")]),s._v(" 会用到 "),a("code",[s._v("multi-user.target")]),s._v(" ？")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl list-dependencies "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--reverse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n-- reverse：反向追踪谁使用这个 unit\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 1：列出目前的 target 环境下，用到什么特别的 unit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl get-default ")]),s._v("\nmulti-user.target\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl list-dependencies ")]),s._v("\ndefault.target\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-abrt-ccpp.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-abrt-oops.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-abrt-vmcore.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-abrt-xorg.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-abrtd.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-atd.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-getty.target\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("-getty@tty1.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-nfs-client.target\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-auth-rpcgss-module.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-rpc-statd-notify.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("-remote-fs-pre.target\n* "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("-remote-fs.target\n*   "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("-nfs-client.target\n*     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-auth-rpcgss-module.service\n*     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-rpc-statd-notify.service\n*     `-remote-fs-pre.target\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("这里不加 unit 则是使用默认的 target，可以看到一颗依赖树，非常直观")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 反向追踪")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl list-dependencies --reverse ")]),s._v("\ndefault.target\n* "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("-graphical.target\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 graphical.target 使用了多少服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl list-dependencies graphical.target")]),s._v("\ngraphical.target\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-accounts-daemon.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-gdm.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-initial-setup-reconfiguration.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-network.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-rtkit-daemon.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-systemd-update-utmp-runlevel.service\n* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-udisks2.service\n* "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("-multi-user.target\n*   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-abrt-ccpp.service\n*   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-abrt-oops.service\n*   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-abrt-vmcore.service\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h2",{attrs:{id:"与-systemd-的-deaemon-运行过程相关目录简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#与-systemd-的-deaemon-运行过程相关目录简介"}},[s._v("#")]),s._v(" 与 systemd 的 deaemon 运行过程相关目录简介")]),s._v(" "),a("p",[s._v("比较重要的 systemd 启动脚本配置文件在 "),a("code",[s._v("/usr/lib/systemd/system/")]),s._v("、"),a("code",[s._v("/etc/systemd/system/")]),s._v(" 目录下，还有以下目录与系统的 daemon 运行有关：")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("/usr/lib/systemd/system/")]),s._v("：")]),s._v(" "),a("p",[s._v("使用 CentOS 官方提供的软件安装后，默认的启动脚本配置文件都放在这里，这里的数据尽量不要修改，要修改时，可以到 "),a("code",[s._v("/etc/systemd/system/")]),s._v(" 下修改")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("/run/systemd/system/")]),s._v("：")]),s._v(" "),a("p",[s._v("系统执行过程中所产生的服务脚本，这些脚本的优先顺序比 "),a("code",[s._v("/usr/lib/systemd/system/")]),s._v(" 高")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("/etc/systemd/system/")]),s._v("：")]),s._v(" "),a("p",[s._v("管理员根据需求建立的执行脚本，执行优先顺序比 "),a("code",[s._v("/run/systemd/system/")]),s._v(" 高")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("/etc/sysconfig/*")]),s._v("：")]),s._v(" "),a("p",[s._v("几乎所有的服务都会将初始化的一些选项设置写入到这个目录下。")]),s._v(" "),a("p",[s._v("比如 mandb 要更新的 man page 索引中，需要加入的参数就写入到此目录下的 man-db 中。而网络的设置写在 "),a("code",[s._v("/etc/sysconfig/network-scripts/")]),s._v(" ；所以该目录也很重要")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("/var/lib/")]),s._v("：")]),s._v(" "),a("p",[s._v("一些会产生数据的服务都会讲它的数据写入到该目录中。")]),s._v(" "),a("p",[s._v("比如：数据库管理系统 Mariadb 的数据库默认写入到 "),a("code",[s._v("/var/lib/mysql/")]),s._v(" 目录下的")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("/run/")]),s._v("：存放了很多 daemon 的暂存文件，包括 lock file 以及 PID file 等")])])]),s._v(" "),a("p",[s._v("我们知道 systemd 有很多本机会用到的 socket 服务，会产生很多的 socket file，可以通过以下方式知道这些 socket file 的存放位置")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl list-sockets ")]),s._v("\nLISTEN                          UNIT                         ACTIVATES\n/dev/log                        systemd-journald.socket      systemd-journald.service\n/run/dbus/system_bus_socket     dbus.socket                  dbus.service\n/run/dmeventd-client            dm-event.socket              dm-event.service\n/run/dmeventd-server            dm-event.socket              dm-event.service\n/run/lvm/lvmetad.socket         lvm2-lvmetad.socket          lvm2-lvmetad.service\n/run/lvm/lvmpolld.socket        lvm2-lvmpolld.socket         lvm2-lvmpolld.service\n/run/systemd/initctl/fifo       systemd-initctl.socket       systemd-initctl.service\n/run/systemd/journal/socket     systemd-journald.socket      systemd-journald.service\n/run/systemd/journal/stdout     systemd-journald.socket      systemd-journald.service\n/run/systemd/shutdownd          systemd-shutdownd.socket     systemd-shutdownd.service\n/run/udev/control               systemd-udevd-control.socket systemd-udevd.service\n/var/run/avahi-daemon/socket    avahi-daemon.socket          avahi-daemon.service\n/var/run/cups/cups.sock         cups.socket                  cups.service\n/var/run/libvirt/virtlockd-sock virtlockd.socket             virtlockd.service\n/var/run/libvirt/virtlogd-sock  virtlogd.socket              virtlogd.service\n/var/run/rpcbind.sock           rpcbind.socket               rpcbind.service\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:111                     rpcbind.socket               rpcbind.service\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:111                     rpcbind.socket               rpcbind.service\n@ISCSIADM_ABSTRACT_NAMESPACE    iscsid.socket                iscsid.service\n@ISCSID_UIP_ABSTRACT_NAMESPACE  iscsiuio.socket              iscsiuio.service\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("::"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":111                        rpcbind.socket               rpcbind.service\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("::"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":111                        rpcbind.socket               rpcbind.service\nkobject-uevent "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                systemd-udevd-kernel.socket  systemd-udevd.service\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" sockets listed.\nPass --all to see loaded but inactive sockets, too.\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("p",[s._v("上面列出了正在监听本地服务需求的 socket file 所在的文件名位置")]),s._v(" "),a("h2",{attrs:{id:"网络服务于端口对应简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络服务于端口对应简介"}},[s._v("#")]),s._v(" 网络服务于端口对应简介")]),s._v(" "),a("p",[s._v("IP 与 PORT 是英特网联机的最重要机制之一，还有各种的通信协议，如 http、ftp；在 "),a("code",[s._v("/etc/services")]),s._v(" 里面对应了协议与端口号的映射关系")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/services")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# daemon name\tport/封包协议\t服务说明")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ftp")]),s._v("             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("/tcp\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ftp")]),s._v("             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("/udp          fsp fspd\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v("             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp                          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The Secure Shell (SSH) Protocol")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v("             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/udp                          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The Secure Shell (SSH) Protocol")]),s._v("\nhttp            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp          www www-http    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# WorldWideWeb HTTP")]),s._v("\nhttp            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/udp          www www-http    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# HyperText Transfer Protocol")]),s._v("\nhttp            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/sctp                         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# HyperText Transfer Protocol")]),s._v("\nhttps           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/tcp                         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http protocol over TLS/SSL")]),s._v("\nhttps           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/udp                         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http protocol over TLS/SSL")]),s._v("\nhttps           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/sctp                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http protocol over TLS/SSL")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 该文件下有大量的数据")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("不建议修改这些端口，除非你想吧这些隐藏起来，不让外部访问到")]),s._v(" "),a("h2",{attrs:{id:"关闭网络服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭网络服务"}},[s._v("#")]),s._v(" 关闭网络服务")]),s._v(" "),a("p",[s._v("当你第一次使用 systemctl 观察本地服务器启动的服务时，会发现有很多 daemon，这是因为 systemd 将许多原本不被列为 daemon 的程序也纳入管理检测范围内，但是那些大部分都属于 Linux 系统基础运行所需的环境，你不清楚的情况下，最好不要去修改他们")]),s._v(" "),a("p",[s._v("除了本地服务之外，要观察网络服务，虽然网络服务默认有 SELinux 管理，不过，还是建议非必要的网络服务就关闭它。基本上会产生一个网络监听端口的程序，就可以称它为网络服务了，可通过如下方式观察网络端口")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -tlunp")]),s._v("\nActive Internet connections "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("only servers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:25            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1578")]),s._v("/master         \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6010          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2350")]),s._v("/sshd: mrcode@p \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6011          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10579")]),s._v("/sshd: root@pt \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:111             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/systemd           \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".122.1:53        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1975")]),s._v("/dnsmasq        \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:22              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1378")]),s._v("/sshd           \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ::1:25                  :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1578")]),s._v("/master         \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ::1:6010                :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2350")]),s._v("/sshd: mrcode@p \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ::1:6011                :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10579")]),s._v("/sshd: root@pt \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::555                  :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11573")]),s._v("/vsftpd        \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::111                  :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/systemd           \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::22                   :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1378")]),s._v("/sshd           \nudp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".122.1:53        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1975")]),s._v("/dnsmasq        \nudp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:67              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1975")]),s._v("/dnsmasq        \nudp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:111             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/systemd           \nudp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:33017           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("920")]),s._v("/avahi-daemon: r \nudp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:669             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("925")]),s._v("/rpcbind         \nudp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:5353            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("920")]),s._v("/avahi-daemon: r \nudp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::111                  :::*                                "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/systemd           \nudp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::669                  :::*                                "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("925")]),s._v("/rpcbind \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("比如上面显示 "),a("code",[s._v("avahi-daemon")]),s._v(" 服务监听了 5353 和 33017 端口，可以通过 systemctl 查找是否真的有 avahi-daemon 服务")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl list-units --all | grep avahi-daemon")]),s._v("\n  avahi-daemon.service                                                                                           loaded    active   running   Avahi mDNS/DNS-SD Stack\n  avahi-daemon.socket                                                                                            loaded    active   running   Avahi mDNS/DNS-SD Stack Activation Socket\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("avahi-daemon 的目的是在局域网进行类似网芳的搜索，因此这个服务可以协助你在区网内随时了解即插即用的设备。包括笔记本电脑等，只要你连上区网，你就能知道谁进来了。问题是，你可能不需要这个协议，关闭它")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭两个服务，并且取消开机启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop avahi-daemon.service ")]),s._v("\nWarning: Stopping avahi-daemon.service, but it can still be activated by:\n  avahi-daemon.socket\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop avahi-daemon.socket  ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl disable avahi-daemon.service avahi-daemon.socket ")]),s._v("\nRemoved symlink /etc/systemd/system/multi-user.target.wants/avahi-daemon.service.\nRemoved symlink /etc/systemd/system/sockets.target.wants/avahi-daemon.socket.\nRemoved symlink /etc/systemd/system/dbus-org.freedesktop.Avahi.service.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -tlunp")]),s._v("\nActive Internet connections "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("only servers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:25            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1578")]),s._v("/master         \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6010          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2350")]),s._v("/sshd: mrcode@p \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6011          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10579")]),s._v("/sshd: root@pt \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:111             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/systemd           \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".122.1:53        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1975")]),s._v("/dnsmasq        \ntcp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:22              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*               LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1378")]),s._v("/sshd           \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ::1:25                  :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1578")]),s._v("/master         \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ::1:6010                :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2350")]),s._v("/sshd: mrcode@p \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ::1:6011                :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10579")]),s._v("/sshd: root@pt \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::555                  :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11573")]),s._v("/vsftpd        \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::111                  :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/systemd           \ntcp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::22                   :::*                    LISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1378")]),s._v("/sshd           \nudp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".122.1:53        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1975")]),s._v("/dnsmasq        \nudp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:67              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1975")]),s._v("/dnsmasq        \nudp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:111             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/systemd           \nudp        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:669             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:*                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("925")]),s._v("/rpcbind         \nudp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::111                  :::*                                "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/systemd           \nudp6       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" :::669                  :::*                                "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("925")]),s._v("/rpcbind  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("p",[s._v("一般来说，你本地服务器至少需要 25 端口，而 22 端口最好加上防火墙来管理远程联机登录比较妥当。555 端口是我们前面练习测试修改的。这样的系统能够被黑的机会已经少很多了。")])])}),[],!1,null,null,null);t.default=e.exports}}]);