(window.webpackJsonp=window.webpackJsonp||[]).push([[114],{620:function(s,a,t){"use strict";t.r(a);var n=t(16),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"centos-7-环境下大量建立账户的方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos-7-环境下大量建立账户的方法"}},[s._v("#")]),s._v(" CentOS 7 环境下大量建立账户的方法")]),s._v(" "),t("p",[s._v("系统上如果有一堆账户，怎么判定某些账户是否存在一些问题？如何创建或删除大量账户？")]),s._v(" "),t("p",[s._v("这个肯定是需要用到 shell script 脚本的，下面一一介绍")]),s._v(" "),t("h2",{attrs:{id:"一些账户相关的检查工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一些账户相关的检查工具"}},[s._v("#")]),s._v(" 一些账户相关的检查工具")]),s._v(" "),t("h3",{attrs:{id:"pwck"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pwck"}},[s._v("#")]),s._v(" pwck")]),s._v(" "),t("p",[s._v("该指令会检查 "),t("code",[s._v("/etc/passwd")]),s._v(" 账户配置文件内的信息，与实际的家目录是否存在，等信息、还可以比对 "),t("code",[s._v("/etc/passwd")]),s._v(" 与 "),t("code",[s._v("/etc/shadow")]),s._v(" 的信息是否一致、如果 "),t("code",[s._v("/etc/passwd")]),s._v(" 内的数据字段错误时，会提示使用者。")]),s._v(" "),t("p",[s._v("一般来说，作者只是利用这个指令来检查输入是否正确")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pwck")]),s._v("\nuser "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ftp'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" directory "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/var/ftp'")]),s._v(" does not exist\nuser "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'saslauth'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" directory "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/run/saslauthd'")]),s._v(" does not exist\nuser "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gluster'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" directory "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/run/gluster'")]),s._v(" does not exist\nuser "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pulse'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" directory "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/var/run/pulse'")]),s._v(" does not exist\nuser "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gnome-initial-setup'")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" directory "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/run/gnome-initial-setup/'")]),s._v(" does not exist\npwck: no changes\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("上面告知了这些账户没有家目录；仔细看由于大部分都是系统账户（的确不需要家目录）")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对应的群组检查")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# grpck")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"pwconv"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pwconv"}},[s._v("#")]),s._v(" pwconv")]),s._v(" "),t("p",[s._v("该指令主要目的是将 "),t("code",[s._v("/etc/passwd")]),s._v(" 账户与密码移动到 "),t("code",[s._v("/etc/shadow")]),s._v(" 中。（早起的 Unix 中没有 shadow 文件，在 passwd 的第 2 字段）")]),s._v(" "),t("p",[s._v("使用 pwdconv 后：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("比对 "),t("code",[s._v("/etc/passwd")]),s._v(" 和 "),t("code",[s._v("/etc/shadow")])]),s._v(" "),t("p",[s._v("若 passwd 存在的账户并没有对应的 shadow 密码时，则 pwconv 会去 "),t("code",[s._v("/etc/login.defs")]),s._v(" 获取相关的密码数据，并建立该账户的 shadow 数据")])]),s._v(" "),t("li",[t("p",[s._v("若 "),t("code",[s._v("/etc/passwd")]),s._v(" 内存在加密后的密码数据时，则 pwconv 会将该密码栏移动到 "),t("code",[s._v("/etc/shadow")]),s._v(" 中，并将原来的密码栏内容变更为 x")])])]),s._v(" "),t("p",[s._v("所以该工具只是为了迁移早期的数据而存在的，对于现在几乎上没有啥用处了")]),s._v(" "),t("h3",{attrs:{id:"pwunconv"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pwunconv"}},[s._v("#")]),s._v(" pwunconv")]),s._v(" "),t("p",[s._v("该指令是将 "),t("code",[s._v("/etc/shadow")]),s._v(" 内的密码栏数据写回 "),t("code",[s._v("/etc/passwd")]),s._v(" 中，并且删除 "),t("code",[s._v("/etc/shadow")]),s._v(" 文件")]),s._v(" "),t("h3",{attrs:{id:"chpasswd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#chpasswd"}},[s._v("#")]),s._v(" chpasswd")]),s._v(" "),t("p",[s._v("读取未加密前的密码，加密并将加密后的密码写入 "),t("code",[s._v("/etc/shadow")])]),s._v(" "),t("p",[s._v("该指令可以用在大量建立账户的场景中，可以由  Standard input 读入数据，数据格式为 "),t("code",[s._v("username:password")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 比如：更新 mrcode3 账户的密码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "mrcode3:123" | chpasswd')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# grep mrcode3 /etc/shadow")]),s._v("\nmrcode3:"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$6")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$v4wtD")]),s._v("/HDxmMD.F"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$tkpuAZ3Onx14Oa2YYqpD3CfZrexV0D18nolGGfl7cIcXG")]),s._v("/57r2S2S2oQzHjuiN4efmFYCOpHS.cK/.cVDk6zi/:18318::::::\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "mrcode3:123abv" | chpasswd')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# grep mrcode3 /etc/shadow")]),s._v("\nmrcode3:"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$6")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$kqggs")]),s._v("/OgGqR0ftc"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$zHF9FbcJqd0fWHNx4hGwWXcQgrjPosDcpDed7iH7")]),s._v("/LYb0tAOBerMvUzodNrX.K4UW5AUYs9S/DGaetJBD3xu6.:18318::::::\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 观察下密码栏的加密字符串，发现的确是被更新过了")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("它预设使用 "),t("code",[s._v("SHA512")]),s._v(" 进行加密，想要更改就需要使用 "),t("code",[s._v("-c 和 -e")]),s._v(" 选项来指定。不过从 CentOS 5.x 之后，passwd 指令已经添加了 "),t("code",[s._v("--stdin")]),s._v(" 选项，可以说是替代了这里的功能")]),s._v(" "),t("h2",{attrs:{id:"大量建立账户模板（适用-passwd-stdin-选项）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#大量建立账户模板（适用-passwd-stdin-选项）"}},[s._v("#")]),s._v(" 大量建立账户模板（适用 passwd --stdin 选项）")]),s._v(" "),t("p",[s._v("下面是一个新站用户功能的脚本")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" accountadd.sh\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This shell script will create amount of linux login accounts for you.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 1. check the "accountadd.txt" file exist？ you must create that file manually')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#\tone account name one line in the "accountadd.txt" file')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. use openssl to create users password")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. User must change his password in his first login")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此命令行命令脚本将为您创建大量 Linux 登录。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 1.检查 "accountadd.txt" 文件是否存在？您必须手动创建该文件，一个账户一行')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.使用 openssl 创建用户密码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.用户必须在首次登录时更改密码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/bin:/sbin:/usr/bin:/usr/sbin\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0. userinput")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("usergroup")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果你的账户需要次要组，在这里定义")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("pwmech")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"openssl"')]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果是 openssl(生成随机数) 则使用 openssl 指令生成 base64 的 6 位数随机密码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("homeperm")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no"')]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果修改为 yes，则将该账户家目录权限修改为 711")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 检查 accountadd.txt 文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("action")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${1}")]),s._v('"')]),s._v("\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# create 使用 useradd 指令、delete 使用 userdel 指令")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" -f accountadd.txt "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"accountadd.txt 文件不存在！"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果有群组，则建立系统群组")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${usergroup}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" -r "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${usergroup}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f outputpw.txt\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("usernames")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" accountadd.txt"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("username")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${usernames}")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${action}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"create"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 存在组则拼接选项 -G 是为该用户添加次要群组")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${usergroup}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("usegrp")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" -G '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${usergroup}")]),s._v(' "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("usegrp")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${usegrp}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增账户")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果没有值则使用用户名作为密码")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${pwmech}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"openssl"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("usepw")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("openssl rand -base64 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("usepw")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${usepw}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" --stdin "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建密码")]),s._v("\n\t\t\tchage -d "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置首次登陆必须修改密码")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${homeperm}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("711")]),s._v(" /home/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",password="),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${usepw}")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" outputpw.txt\n\t\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delete"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"删除用户 '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v('"')]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("userdel")]),s._v(" -r "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v("\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -r 将用户家目录也删除")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"请使用：'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v(' [create|dellete]"')]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("esac")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br")])]),t("p",[s._v("脚本写好了，接下来进行测试")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" accountadd.txt\n\nstd01\nstd02\nstd03\nstd04\nstd05\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" accountadd.sh create\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sh accountadd.sh create")]),s._v("\n更改用户 std01 的密码 。\npasswd：所有的身份验证令牌已经成功更新。\n更改用户 std02 的密码 。\npasswd：所有的身份验证令牌已经成功更新。\n更改用户 std03 的密码 。\npasswd：所有的身份验证令牌已经成功更新。\n更改用户 std04 的密码 。\npasswd：所有的身份验证令牌已经成功更新。\n更改用户 std05 的密码 。\npasswd：所有的身份验证令牌已经成功更新。\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat outputpw.txt ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("std01,password"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("s4j4jdwr\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("std02,password"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("G4iW/O6M\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("std03,password"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("HGO0rvI8\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("std04,password"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("17NAhvgS\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("std05,password"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Q2CftODm\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到输出的账户和密码信息，你可以打印出来，一行一条裁剪，然后发给使用者")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);