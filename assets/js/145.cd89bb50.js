(window.webpackJsonp=window.webpackJsonp||[]).push([[145],{658:function(s,t,a){"use strict";a.r(t);var n=a(16),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"systemd-journald-service-简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#systemd-journald-service-简介"}},[s._v("#")]),s._v(" systemd-journald.service 简介")]),s._v(" "),a("p",[s._v("以前只有 rsyslogd 的时候，由于 rsyslogd 必须要开机完成且执行了 rsyslogd daemon 后，日志文件才会开始记录。所以，核心还需要自己产生一个 klogd 的服务，才能将系统在开机过程、启动服务的过程中的信息记录下来，然后等 rsyslogd 启动后传送给它处理")]),s._v(" "),a("p",[s._v("有了 systemd 后，由于它是核心唤醒的，又是第一个执行的软件，它可以主动调用 systemd-journald 来协助记录日志文件，因此在开机过程中的所有信息，包括启动服务于服务若启动失败的情况等，都可以直接被记录到 systemd-journald s里")]),s._v(" "),a("p",[s._v("systemd-journald 记录到内存中，再给 rsyslogd 记录到硬盘中")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("linux 的内存在文件系统中也有对应的文件形态在 /run/log/ 下，只是人眼看不懂就是了，重启后，该数据就没有了")])]),s._v(" "),a("h2",{attrs:{id:"使用-journalctl-观察日志信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-journalctl-观察日志信息"}},[s._v("#")]),s._v(" 使用 journalctl 观察日志信息")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("journalct "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-nrpf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--since TIME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--until TIME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" _optional\n\n选项与参数：\n\t预设会显示全部的 log 内容，从旧的输出到最新的信息\n\t-n：显示最近 n 行的信息，找最新信息时有用\n\t-r：反向输出，从最新的输出到最旧的输出\n\t-p：显示后面接的信息重要性排序，前一章讲解的日志级别\n\t-f：类似 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -f 功能，持续显示 journal 日志内容\n\t--since --unitl：设置开始与结束时间，只显示某段时间范围内的数据\n\t"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("_SYSTEMD_UNIT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unit.service：只输出某个服务的信息\n\t"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("_COMM")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bash：只输出与 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" 有关的信息\n\t"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("_PID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("pid：只输出某个 PID 的信息\n\t"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("_UID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("uid：只输出某个 uid 的信息\n\t"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SYSLOG_FACILITY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("-23"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("：使用 syslog.h 规范的服务相对应的序号来显示指定数据\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 1： 显示目前系统中所有的  journal 日志数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# journalctl ")]),s._v("\n-- Logs begin at Sun "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-15 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:33 CST, end at Mon "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-16 00:50:01 CST. --\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:33 study.centos.mrcode systemd-journal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Runtime journal is using "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".2M "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("max allowed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("58")]),s._v(".1M, trying to leave "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("87")]),s._v(".\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:33 study.centos.mrcode kernel: Initializing cgroup subsys cpuset\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:33 study.centos.mrcode kernel: Initializing cgroup subsys cpu\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:33 study.centos.mrcode kernel: Initializing cgroup subsys cpuacct\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:33 study.centos.mrcode kernel: Linux version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),s._v(".0-1062.el7.x86_64 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mockbuild@kbuilder.bsys.centos.org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("gcc ver\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:33 study.centos.mrcode kernel: Command line: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BOOT_IMAGE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/vmlinuz-3.10.0-1062.el7.x86_64 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("root")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/mapper/centos-r\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:33 study.centos.mrcode kernel: e820: BIOS-provided physical RAM map:\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从当次开机以来的所有数据都会显示出来，通过 less 一页页显示，数据流很大")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 2：仅显示 2020/03/22 整天、昨天 的数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# journalctl --since "2020-03-16 00:00:00" --until "2020-03-16 23:59:59"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# journalctl --since today\t\t# 今天")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# journalctl --since yesterday --unitl today\t\t# 昨天到今天")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 3：只招数 crond.service 的数据， 同时只列出最新的 10 行信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# journalctl _SYSTEMD_UNIT=crond.service -n 10")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 4：找出 su、login 执行的的日志，同时只列出最新的 10 行数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# journalctl _COMM=su _COMM=login -n 10")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 5：找出信息严重等级为 error 的信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# journalctl -p err")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 6：找出与登录服务 auth、authpriv 有关的日志文件信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# journalctl SYSLOG_FACILITY=4 SYSLOG_FACILITY=10")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关于  SYSLOG_FACILITY 的对应，参考前面的章节")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("p",[s._v("使用它的 "),a("code",[s._v("-f")]),s._v(" 实时显示功能")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第一个终端机")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# journalctl -f")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". 下面的信息是，2 号终端机执行指令后显示的信息\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:15:25 study.centos.mrcode postfix/pickup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14953")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": 827B31075: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("from")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mrcode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:15:25 study.centos.mrcode postfix/cleanup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20434")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": 827B31075: message-id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20200315171525")]),s._v(".827B31075@study.centos.mrcode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:15:25 study.centos.mrcode postfix/qmgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1618")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": 827B31075: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("from")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mrcode@study.centos.mrcode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("449")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("nrcpt")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("queue active"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:15:25 study.centos.mrcode postfix/local"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20436")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": 827B31075: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("to")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("dmtsai@study.centos.mrcode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("orig_to")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("dmtsai"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("relay")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("local, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.02")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("delays")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.02")]),s._v("/0/0/0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dsn")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.1")]),s._v(".1, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bounced "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("unknown user: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dmtsai"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:15:25 study.centos.mrcode postfix/cleanup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20434")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": 87ED81076: message-id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20200315171525")]),s._v(".87ED81076@study.centos.mrcode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:15:25 study.centos.mrcode postfix/bounce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20437")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": 827B31075: sender non-delivery notification: 87ED81076\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:15:25 study.centos.mrcode postfix/qmgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1618")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": 827B31075: removed\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:15:25 study.centos.mrcode postfix/qmgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1618")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": 87ED81076: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("from")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<>")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2291")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("nrcpt")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("queue active"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:15:25 study.centos.mrcode postfix/local"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20436")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": 87ED81076: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("to")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mrcode@study.centos.mrcode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("relay")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("local, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("delays")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/0/0/0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dsn")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v(".0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sent "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delivered to mailbox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:15:25 study.centos.mrcode postfix/qmgr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1618")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": 87ED81076: removed\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第二个终端机")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mrcode@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mail -s "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test'")]),s._v(" dmtsai\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h2",{attrs:{id:"logger-指令的应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#logger-指令的应用"}},[s._v("#")]),s._v(" logger 指令的应用")]),s._v(" "),a("p",[s._v("journalctl 指令是查阅信息，可以通过 logger 把你的数据存储到文件中，下面介绍最简单的本机信息传递，更多的方法请自行查阅 man logger")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("logger "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-p 服务名称.等级"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"信息"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 范例 1： 让 dmtsai 使用 logger 来传送数据到日志文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ logger -p user.info "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"I will check logger command"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# journalctl SYSLOG_FACILITY=1 -n 3")]),s._v("\n-- Logs begin at Sun "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-15 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:33 CST, end at Mon "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-16 01:20:43 CST. --\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:50 study.centos.mrcode spice-vdagent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1860")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Cannot access vdagent virtio channel /dev/virtio-ports/com.redhat.spi\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:50 study.centos.mrcode spice-streaming-agent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1867")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": Failed to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(' the streaming device "/dev/virtio-ports/org.sp\nMar '),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:20:43 study.centos.mrcode mrcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13699")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": I will check logger "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以看到这里已经传输到了")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("之前写的 backup.service 服务中，如果使用手动方式来备份，即手动执行 "),a("code",[s._v("/backups/backup.sh log")]),s._v(" 来备份时，通过 logger 记录备份开始时间和结束时间")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /backups/backup.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${1}")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'log'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n\tlogger -p syslog.info "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"backup.sh is starting"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("source")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc /home /root /var/lib /var/spool/{cron,at,mail}"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("target")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/backups/backup-system-'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%Y-%m-%d"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('.tar.gz"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" -d /backups "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /backups\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zcvf "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${target}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${source}")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /backups/backup.log\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${1}")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'log'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n\tlogger -p syslog.info "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"backup.sh is finished"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /backups/backup.sh log")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# journalctl SYSLOG_FACILITY=5 -n 3")]),s._v("\n-- Logs begin at Sun "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-15 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":13:33 CST, end at Mon "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-16 01:28:54 CST. --\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 00:42:45 study.centos.mrcode rsyslogd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7107")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("origin "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("software")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rsyslogd"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("swVersion")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8.24.0-38.el7"')]),s._v(" x-pid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7107"')]),s._v(" x-info\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:28:27 study.centos.mrcode mrcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17659")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": backup.sh is starting\nMar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:28:54 study.centos.mrcode mrcode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19555")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": backup.sh is finished\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("p",[s._v("也就是说，该指令是类似一个日志服务接口，我们可以通过它把日志信息记录下来")]),s._v(" "),a("h2",{attrs:{id:"保存-journal-的方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#保存-journal-的方式"}},[s._v("#")]),s._v(" 保存 journal 的方式")]),s._v(" "),a("p",[s._v("systemd-journald.service 的信息在内存中，而持久化到硬盘的数据是通过 rsyslogd 来做的，如果你想要保存下 journald 处理的数据，可以通过如下的方式")]),s._v(" "),a("p",[s._v("基本上 systemd-journald.service 的配置文件主要参考 "),a("code",[s._v("/etc/systemd/journald.conf")]),s._v(" 的内容，默认配置基本上满足需求，如有定制信息，请通过 man 5 journald.conf 查阅")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 处理所需要的目录与相关权限设置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir /var/log/journal")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown root:systemd-journal /var/log/journal/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod 2775 /var/log/journal/")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 重新启动 systemd-journald 并观察备份的日志数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart systemd-journald.service ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@study ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /var/log/journal/")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndrwxr-sr-x. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root systemd-journal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" 01:35 f228ab37c368416c84c6b27971ba45a9\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置预设的目录后，服务重启后，会自动复制一份到该目录下")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("作者建议；有 rsyslog.service 以及 logrotate 的存在，所以这里产生的信息可以不用存档")])])}),[],!1,null,null,null);t.default=e.exports}}]);